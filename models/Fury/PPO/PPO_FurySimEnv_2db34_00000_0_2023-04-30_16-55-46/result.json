{"custom_metrics": {"dps_mean": 9508.95495115733, "dps_min": 8153.743688748409, "dps_max": 10311.706054588483}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8457285620432388, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.883060906523017, "policy_loss": -0.028429922203142798, "vf_loss": 9.908850167387275, "vf_explained_var": -0.009226065810008715, "kl": 0.013203427630458313, "entropy": 2.183944899292402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 1237.4047265506172, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1141.0745941388795, "episode_len_mean": 295.1818181818182, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 9508.95495115733, "dps_min": 8153.743688748409, "dps_max": 10311.706054588483}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23461229873969824, "mean_inference_ms": 0.9401416414115815, "mean_action_processing_ms": 0.08588184195875269, "mean_env_wait_ms": 0.47583630132855925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1237.4047265506172, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1141.0745941388795, "episode_len_mean": 295.1818181818182, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23461229873969824, "mean_inference_ms": 0.9401416414115815, "mean_action_processing_ms": 0.08588184195875269, "mean_env_wait_ms": 0.47583630132855925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 7019.496, "sample_time_ms": 651.824, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 6356.315, "learn_throughput": 629.295, "synch_weights_time_ms": 11.357}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 11, "training_iteration": 1, "trial_id": "2db34_00000", "date": "2023-04-30_16-56-10", "timestamp": 1682848570, "time_this_iter_s": 7.025003910064697, "time_total_s": 7.025003910064697, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 7.025003910064697, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 9.7, "ram_util_percent": 65.6}}
{"custom_metrics": {"dps_mean": 9551.395706403055, "dps_min": 8153.743688748409, "dps_max": 10941.24877399642}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8601936092620255, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.913655062644713, "policy_loss": -0.033761820275717044, "vf_loss": 9.9441681872132, "vf_explained_var": -0.0076157580780726606, "kl": 0.016243394259797046, "entropy": 2.1642170749684815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 1312.9498528795702, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1146.1674847683664, "episode_len_mean": 294.45454545454544, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 9551.395706403055, "dps_min": 8153.743688748409, "dps_max": 10941.24877399642}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094, 1052.3097460482725, 1260.4724981149027, 1206.986422907258, 995.0224347404933, 1216.921217353215, 1096.8702104094082, 1252.1128717207055, 1100.3525221658067, 1312.9498528795702, 1144.114238916379, 1025.7521141203774], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313, 269, 304, 354, 265, 312, 278, 297, 288, 331, 272, 261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23643211024262414, "mean_inference_ms": 0.954331223417515, "mean_action_processing_ms": 0.0865266883178772, "mean_env_wait_ms": 0.4749687362857029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1312.9498528795702, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1146.1674847683664, "episode_len_mean": 294.45454545454544, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094, 1052.3097460482725, 1260.4724981149027, 1206.986422907258, 995.0224347404933, 1216.921217353215, 1096.8702104094082, 1252.1128717207055, 1100.3525221658067, 1312.9498528795702, 1144.114238916379, 1025.7521141203774], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313, 269, 304, 354, 265, 312, 278, 297, 288, 331, 272, 261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23643211024262414, "mean_inference_ms": 0.954331223417515, "mean_action_processing_ms": 0.0865266883178772, "mean_env_wait_ms": 0.4749687362857029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 6949.522, "sample_time_ms": 667.788, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 6270.296, "learn_throughput": 637.928, "synch_weights_time_ms": 11.438}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 22, "training_iteration": 2, "trial_id": "2db34_00000", "date": "2023-04-30_16-56-17", "timestamp": 1682848577, "time_this_iter_s": 6.885059118270874, "time_total_s": 13.910063028335571, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 13.910063028335571, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 8.29, "ram_util_percent": 65.62}}
{"custom_metrics": {"dps_mean": 9810.982517728546, "dps_min": 8153.743688748409, "dps_max": 11700.227702105742}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9059501805132435, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.895211003416328, "policy_loss": -0.037364949500288375, "vf_loss": 9.928872151528635, "vf_explained_var": -0.0018378329533402637, "kl": 0.018519073990712384, "entropy": 2.128040450362749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 1404.0273242526894, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1177.3179021274257, "episode_len_mean": 292.1470588235294, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 9810.982517728546, "dps_min": 8153.743688748409, "dps_max": 11700.227702105742}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094, 1052.3097460482725, 1260.4724981149027, 1206.986422907258, 995.0224347404933, 1216.921217353215, 1096.8702104094082, 1252.1128717207055, 1100.3525221658067, 1312.9498528795702, 1144.114238916379, 1025.7521141203774, 1331.6356767251918, 1231.6510504880962, 1089.438324644616, 1288.7371983918738, 1219.7172792720944, 1326.5952352408726, 1147.3547160605779, 1404.0273242526894, 1224.8430422118208, 1173.834112180336, 1199.1799237161947, 1176.1101242440448], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313, 269, 304, 354, 265, 312, 278, 297, 288, 331, 272, 261, 339, 302, 244, 322, 286, 300, 215, 300, 298, 300, 270, 279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2358974016131037, "mean_inference_ms": 0.9522938331944201, "mean_action_processing_ms": 0.08699565703484095, "mean_env_wait_ms": 0.47243298129007605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1404.0273242526894, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1177.3179021274257, "episode_len_mean": 292.1470588235294, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094, 1052.3097460482725, 1260.4724981149027, 1206.986422907258, 995.0224347404933, 1216.921217353215, 1096.8702104094082, 1252.1128717207055, 1100.3525221658067, 1312.9498528795702, 1144.114238916379, 1025.7521141203774, 1331.6356767251918, 1231.6510504880962, 1089.438324644616, 1288.7371983918738, 1219.7172792720944, 1326.5952352408726, 1147.3547160605779, 1404.0273242526894, 1224.8430422118208, 1173.834112180336, 1199.1799237161947, 1176.1101242440448], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313, 269, 304, 354, 265, 312, 278, 297, 288, 331, 272, 261, 339, 302, 244, 322, 286, 300, 215, 300, 298, 300, 270, 279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2358974016131037, "mean_inference_ms": 0.9522938331944201, "mean_action_processing_ms": 0.08699565703484095, "mean_env_wait_ms": 0.47243298129007605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 6897.262, "sample_time_ms": 655.231, "load_time_ms": 0.333, "load_throughput": 12018063.037, "learn_time_ms": 6230.044, "learn_throughput": 642.05, "synch_weights_time_ms": 11.654}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 34, "training_iteration": 3, "trial_id": "2db34_00000", "date": "2023-04-30_16-56-23", "timestamp": 1682848583, "time_this_iter_s": 6.798910140991211, "time_total_s": 20.708973169326782, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 20.708973169326782, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 7.489999999999999, "ram_util_percent": 65.67000000000002}}
{"custom_metrics": {"dps_mean": 9980.846120493858, "dps_min": 8153.743688748409, "dps_max": 11700.227702105742}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9718169953233452, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.869684651077435, "policy_loss": -0.035296736912982116, "vf_loss": 9.901942909404795, "vf_explained_var": 0.003668941733657673, "kl": 0.015192352053312364, "entropy": 2.0940496908721102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 1404.0273242526894, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1197.7015344592633, "episode_len_mean": 286.21153846153845, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 9980.846120493858, "dps_min": 8153.743688748409, "dps_max": 11700.227702105742}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094, 1052.3097460482725, 1260.4724981149027, 1206.986422907258, 995.0224347404933, 1216.921217353215, 1096.8702104094082, 1252.1128717207055, 1100.3525221658067, 1312.9498528795702, 1144.114238916379, 1025.7521141203774, 1331.6356767251918, 1231.6510504880962, 1089.438324644616, 1288.7371983918738, 1219.7172792720944, 1326.5952352408726, 1147.3547160605779, 1404.0273242526894, 1224.8430422118208, 1173.834112180336, 1199.1799237161947, 1176.1101242440448, 1200.829752652214, 1310.3271876488284, 1313.5847981394331, 1270.6790041380073, 1263.659271174183, 1150.5548442970671, 1166.1155884294515, 1312.771019426333, 1175.5862001618175, 1275.0562509296096, 1133.9287301620666, 1179.58514837214, 1233.093202204532, 1237.1338428653626, 1289.8484108575226, 1222.9504638203732, 1285.5308233622816, 1230.4365809079877], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313, 269, 304, 354, 265, 312, 278, 297, 288, 331, 272, 261, 339, 302, 244, 322, 286, 300, 215, 300, 298, 300, 270, 279, 283, 315, 305, 305, 275, 286, 249, 253, 277, 253, 250, 289, 239, 250, 310, 226, 316, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.236719482150646, "mean_inference_ms": 0.945754401599575, "mean_action_processing_ms": 0.08659317163023447, "mean_env_wait_ms": 0.471515298515812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1404.0273242526894, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1197.7015344592633, "episode_len_mean": 286.21153846153845, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094, 1052.3097460482725, 1260.4724981149027, 1206.986422907258, 995.0224347404933, 1216.921217353215, 1096.8702104094082, 1252.1128717207055, 1100.3525221658067, 1312.9498528795702, 1144.114238916379, 1025.7521141203774, 1331.6356767251918, 1231.6510504880962, 1089.438324644616, 1288.7371983918738, 1219.7172792720944, 1326.5952352408726, 1147.3547160605779, 1404.0273242526894, 1224.8430422118208, 1173.834112180336, 1199.1799237161947, 1176.1101242440448, 1200.829752652214, 1310.3271876488284, 1313.5847981394331, 1270.6790041380073, 1263.659271174183, 1150.5548442970671, 1166.1155884294515, 1312.771019426333, 1175.5862001618175, 1275.0562509296096, 1133.9287301620666, 1179.58514837214, 1233.093202204532, 1237.1338428653626, 1289.8484108575226, 1222.9504638203732, 1285.5308233622816, 1230.4365809079877], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313, 269, 304, 354, 265, 312, 278, 297, 288, 331, 272, 261, 339, 302, 244, 322, 286, 300, 215, 300, 298, 300, 270, 279, 283, 315, 305, 305, 275, 286, 249, 253, 277, 253, 250, 289, 239, 250, 310, 226, 316, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.236719482150646, "mean_inference_ms": 0.945754401599575, "mean_action_processing_ms": 0.08659317163023447, "mean_env_wait_ms": 0.471515298515812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 6853.051, "sample_time_ms": 651.02, "load_time_ms": 0.383, "load_throughput": 10453094.081, "learn_time_ms": 6190.031, "learn_throughput": 646.2, "synch_weights_time_ms": 11.618}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 52, "training_iteration": 4, "trial_id": "2db34_00000", "date": "2023-04-30_16-56-30", "timestamp": 1682848590, "time_this_iter_s": 6.726524591445923, "time_total_s": 27.435497760772705, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 27.435497760772705, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 7.566666666666666, "ram_util_percent": 65.7}}
{"custom_metrics": {"dps_mean": 10108.664606754786, "dps_min": 8153.743688748409, "dps_max": 11700.227702105742}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1455913929849542, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.844515967625444, "policy_loss": -0.0340247616632491, "vf_loss": 9.875087434502058, "vf_explained_var": -0.0011343397119993805, "kl": 0.01726658668000154, "entropy": 2.040909135341644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 1404.0273242526894, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1213.0397528105746, "episode_len_mean": 279.6268656716418, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10108.664606754786, "dps_min": 8153.743688748409, "dps_max": 11700.227702105742}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094, 1052.3097460482725, 1260.4724981149027, 1206.986422907258, 995.0224347404933, 1216.921217353215, 1096.8702104094082, 1252.1128717207055, 1100.3525221658067, 1312.9498528795702, 1144.114238916379, 1025.7521141203774, 1331.6356767251918, 1231.6510504880962, 1089.438324644616, 1288.7371983918738, 1219.7172792720944, 1326.5952352408726, 1147.3547160605779, 1404.0273242526894, 1224.8430422118208, 1173.834112180336, 1199.1799237161947, 1176.1101242440448, 1200.829752652214, 1310.3271876488284, 1313.5847981394331, 1270.6790041380073, 1263.659271174183, 1150.5548442970671, 1166.1155884294515, 1312.771019426333, 1175.5862001618175, 1275.0562509296096, 1133.9287301620666, 1179.58514837214, 1233.093202204532, 1237.1338428653626, 1289.8484108575226, 1222.9504638203732, 1285.5308233622816, 1230.4365809079877, 1252.2762829700412, 1188.4446268280217, 1243.7612439843615, 1294.523728330535, 1373.9394890785534, 1290.1333015298578, 1318.1374214238613, 1377.5442024615795, 1203.4372421127057, 1208.4242338416477, 1133.8450232729278, 1254.930498636796, 1354.6257508648284, 1169.3402689575114, 1329.820332133576], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313, 269, 304, 354, 265, 312, 278, 297, 288, 331, 272, 261, 339, 302, 244, 322, 286, 300, 215, 300, 298, 300, 270, 279, 283, 315, 305, 305, 275, 286, 249, 253, 277, 253, 250, 289, 239, 250, 310, 226, 316, 269, 278, 198, 247, 232, 283, 292, 267, 262, 299, 237, 230, 267, 270, 223, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23617592141607238, "mean_inference_ms": 0.9413760351846516, "mean_action_processing_ms": 0.08631068822717441, "mean_env_wait_ms": 0.46965390656239303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1404.0273242526894, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1213.0397528105746, "episode_len_mean": 279.6268656716418, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094, 1052.3097460482725, 1260.4724981149027, 1206.986422907258, 995.0224347404933, 1216.921217353215, 1096.8702104094082, 1252.1128717207055, 1100.3525221658067, 1312.9498528795702, 1144.114238916379, 1025.7521141203774, 1331.6356767251918, 1231.6510504880962, 1089.438324644616, 1288.7371983918738, 1219.7172792720944, 1326.5952352408726, 1147.3547160605779, 1404.0273242526894, 1224.8430422118208, 1173.834112180336, 1199.1799237161947, 1176.1101242440448, 1200.829752652214, 1310.3271876488284, 1313.5847981394331, 1270.6790041380073, 1263.659271174183, 1150.5548442970671, 1166.1155884294515, 1312.771019426333, 1175.5862001618175, 1275.0562509296096, 1133.9287301620666, 1179.58514837214, 1233.093202204532, 1237.1338428653626, 1289.8484108575226, 1222.9504638203732, 1285.5308233622816, 1230.4365809079877, 1252.2762829700412, 1188.4446268280217, 1243.7612439843615, 1294.523728330535, 1373.9394890785534, 1290.1333015298578, 1318.1374214238613, 1377.5442024615795, 1203.4372421127057, 1208.4242338416477, 1133.8450232729278, 1254.930498636796, 1354.6257508648284, 1169.3402689575114, 1329.820332133576], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313, 269, 304, 354, 265, 312, 278, 297, 288, 331, 272, 261, 339, 302, 244, 322, 286, 300, 215, 300, 298, 300, 270, 279, 283, 315, 305, 305, 275, 286, 249, 253, 277, 253, 250, 289, 239, 250, 310, 226, 316, 269, 278, 198, 247, 232, 283, 292, 267, 262, 299, 237, 230, 267, 270, 223, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23617592141607238, "mean_inference_ms": 0.9413760351846516, "mean_action_processing_ms": 0.08631068822717441, "mean_env_wait_ms": 0.46965390656239303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 6829.244, "sample_time_ms": 645.809, "load_time_ms": 0.306, "load_throughput": 13066367.601, "learn_time_ms": 6171.131, "learn_throughput": 648.179, "synch_weights_time_ms": 11.798}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 67, "training_iteration": 5, "trial_id": "2db34_00000", "date": "2023-04-30_16-56-37", "timestamp": 1682848597, "time_this_iter_s": 6.739031076431274, "time_total_s": 34.17452883720398, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 34.17452883720398, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 7.7555555555555555, "ram_util_percent": 65.7}}
{"custom_metrics": {"dps_mean": 10086.290523721425, "dps_min": 8153.743688748409, "dps_max": 11700.227702105742}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3961930800189255, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.87720448176066, "policy_loss": -0.03348790979092961, "vf_loss": 9.907332070668538, "vf_explained_var": 0.0007456221247232088, "kl": 0.01680161801640032, "entropy": 2.0456323713384648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 1404.0273242526894, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1210.3548628465712, "episode_len_mean": 272.9390243902439, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10086.290523721425, "dps_min": 8153.743688748409, "dps_max": 11700.227702105742}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094, 1052.3097460482725, 1260.4724981149027, 1206.986422907258, 995.0224347404933, 1216.921217353215, 1096.8702104094082, 1252.1128717207055, 1100.3525221658067, 1312.9498528795702, 1144.114238916379, 1025.7521141203774, 1331.6356767251918, 1231.6510504880962, 1089.438324644616, 1288.7371983918738, 1219.7172792720944, 1326.5952352408726, 1147.3547160605779, 1404.0273242526894, 1224.8430422118208, 1173.834112180336, 1199.1799237161947, 1176.1101242440448, 1200.829752652214, 1310.3271876488284, 1313.5847981394331, 1270.6790041380073, 1263.659271174183, 1150.5548442970671, 1166.1155884294515, 1312.771019426333, 1175.5862001618175, 1275.0562509296096, 1133.9287301620666, 1179.58514837214, 1233.093202204532, 1237.1338428653626, 1289.8484108575226, 1222.9504638203732, 1285.5308233622816, 1230.4365809079877, 1252.2762829700412, 1188.4446268280217, 1243.7612439843615, 1294.523728330535, 1373.9394890785534, 1290.1333015298578, 1318.1374214238613, 1377.5442024615795, 1203.4372421127057, 1208.4242338416477, 1133.8450232729278, 1254.930498636796, 1354.6257508648284, 1169.3402689575114, 1329.820332133576, 1090.1255523677764, 1182.5104411941245, 1179.5904313642359, 1195.400780556537, 1284.9911423700821, 1112.5149710401768, 1131.8952477393998, 1301.256979127312, 1324.173478556675, 1243.1508400923856, 1243.90529221821, 1208.1266110895576, 1129.9860933360164, 1254.8812520372064, 1092.9262020206513], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313, 269, 304, 354, 265, 312, 278, 297, 288, 331, 272, 261, 339, 302, 244, 322, 286, 300, 215, 300, 298, 300, 270, 279, 283, 315, 305, 305, 275, 286, 249, 253, 277, 253, 250, 289, 239, 250, 310, 226, 316, 269, 278, 198, 247, 232, 283, 292, 267, 262, 299, 237, 230, 267, 270, 223, 267, 237, 229, 229, 244, 276, 243, 238, 238, 272, 248, 234, 235, 225, 242, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23541813003653894, "mean_inference_ms": 0.938420311631869, "mean_action_processing_ms": 0.08586637245023583, "mean_env_wait_ms": 0.46893741007470074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1404.0273242526894, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1210.3548628465712, "episode_len_mean": 272.9390243902439, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094, 1052.3097460482725, 1260.4724981149027, 1206.986422907258, 995.0224347404933, 1216.921217353215, 1096.8702104094082, 1252.1128717207055, 1100.3525221658067, 1312.9498528795702, 1144.114238916379, 1025.7521141203774, 1331.6356767251918, 1231.6510504880962, 1089.438324644616, 1288.7371983918738, 1219.7172792720944, 1326.5952352408726, 1147.3547160605779, 1404.0273242526894, 1224.8430422118208, 1173.834112180336, 1199.1799237161947, 1176.1101242440448, 1200.829752652214, 1310.3271876488284, 1313.5847981394331, 1270.6790041380073, 1263.659271174183, 1150.5548442970671, 1166.1155884294515, 1312.771019426333, 1175.5862001618175, 1275.0562509296096, 1133.9287301620666, 1179.58514837214, 1233.093202204532, 1237.1338428653626, 1289.8484108575226, 1222.9504638203732, 1285.5308233622816, 1230.4365809079877, 1252.2762829700412, 1188.4446268280217, 1243.7612439843615, 1294.523728330535, 1373.9394890785534, 1290.1333015298578, 1318.1374214238613, 1377.5442024615795, 1203.4372421127057, 1208.4242338416477, 1133.8450232729278, 1254.930498636796, 1354.6257508648284, 1169.3402689575114, 1329.820332133576, 1090.1255523677764, 1182.5104411941245, 1179.5904313642359, 1195.400780556537, 1284.9911423700821, 1112.5149710401768, 1131.8952477393998, 1301.256979127312, 1324.173478556675, 1243.1508400923856, 1243.90529221821, 1208.1266110895576, 1129.9860933360164, 1254.8812520372064, 1092.9262020206513], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313, 269, 304, 354, 265, 312, 278, 297, 288, 331, 272, 261, 339, 302, 244, 322, 286, 300, 215, 300, 298, 300, 270, 279, 283, 315, 305, 305, 275, 286, 249, 253, 277, 253, 250, 289, 239, 250, 310, 226, 316, 269, 278, 198, 247, 232, 283, 292, 267, 262, 299, 237, 230, 267, 270, 223, 267, 237, 229, 229, 244, 276, 243, 238, 238, 272, 248, 234, 235, 225, 242, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23541813003653894, "mean_inference_ms": 0.938420311631869, "mean_action_processing_ms": 0.08586637245023583, "mean_env_wait_ms": 0.46893741007470074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 6828.99, "sample_time_ms": 644.759, "load_time_ms": 0.255, "load_throughput": 15679641.121, "learn_time_ms": 6171.801, "learn_throughput": 648.109, "synch_weights_time_ms": 11.918}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 82, "training_iteration": 6, "trial_id": "2db34_00000", "date": "2023-04-30_16-56-44", "timestamp": 1682848604, "time_this_iter_s": 6.8332250118255615, "time_total_s": 41.00775384902954, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 41.00775384902954, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 8.58, "ram_util_percent": 65.75999999999999}}
{"custom_metrics": {"dps_mean": 10130.307054892293, "dps_min": 8153.743688748409, "dps_max": 11753.806722212583}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.586119980324981, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.863929746484244, "policy_loss": -0.0344469007365005, "vf_loss": 9.895334744197067, "vf_explained_var": 0.0040045163964712496, "kl": 0.015209508150995133, "entropy": 1.9544847660167244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 1410.4568066655097, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1215.6368465870753, "episode_len_mean": 264.83, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10130.307054892293, "dps_min": 8153.743688748409, "dps_max": 11753.806722212583}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094, 1052.3097460482725, 1260.4724981149027, 1206.986422907258, 995.0224347404933, 1216.921217353215, 1096.8702104094082, 1252.1128717207055, 1100.3525221658067, 1312.9498528795702, 1144.114238916379, 1025.7521141203774, 1331.6356767251918, 1231.6510504880962, 1089.438324644616, 1288.7371983918738, 1219.7172792720944, 1326.5952352408726, 1147.3547160605779, 1404.0273242526894, 1224.8430422118208, 1173.834112180336, 1199.1799237161947, 1176.1101242440448, 1200.829752652214, 1310.3271876488284, 1313.5847981394331, 1270.6790041380073, 1263.659271174183, 1150.5548442970671, 1166.1155884294515, 1312.771019426333, 1175.5862001618175, 1275.0562509296096, 1133.9287301620666, 1179.58514837214, 1233.093202204532, 1237.1338428653626, 1289.8484108575226, 1222.9504638203732, 1285.5308233622816, 1230.4365809079877, 1252.2762829700412, 1188.4446268280217, 1243.7612439843615, 1294.523728330535, 1373.9394890785534, 1290.1333015298578, 1318.1374214238613, 1377.5442024615795, 1203.4372421127057, 1208.4242338416477, 1133.8450232729278, 1254.930498636796, 1354.6257508648284, 1169.3402689575114, 1329.820332133576, 1090.1255523677764, 1182.5104411941245, 1179.5904313642359, 1195.400780556537, 1284.9911423700821, 1112.5149710401768, 1131.8952477393998, 1301.256979127312, 1324.173478556675, 1243.1508400923856, 1243.90529221821, 1208.1266110895576, 1129.9860933360164, 1254.8812520372064, 1092.9262020206513, 1178.6861851489482, 1244.9122331446804, 1251.6744534727866, 1276.7348396446882, 1214.317391017965, 1238.228304450956, 1269.8206797656696, 1158.1049535001732, 1217.8264711149568, 1410.4568066655097, 1352.6070846865134, 1354.4833556880592, 1210.1180802348058, 1223.358870496876, 1214.8216472906904, 1212.758125742191, 1150.8654640463008, 1134.8109591769307], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313, 269, 304, 354, 265, 312, 278, 297, 288, 331, 272, 261, 339, 302, 244, 322, 286, 300, 215, 300, 298, 300, 270, 279, 283, 315, 305, 305, 275, 286, 249, 253, 277, 253, 250, 289, 239, 250, 310, 226, 316, 269, 278, 198, 247, 232, 283, 292, 267, 262, 299, 237, 230, 267, 270, 223, 267, 237, 229, 229, 244, 276, 243, 238, 238, 272, 248, 234, 235, 225, 242, 256, 223, 260, 199, 204, 203, 256, 232, 247, 215, 258, 249, 207, 270, 209, 210, 205, 266, 189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2358972733829998, "mean_inference_ms": 0.941226250167468, "mean_action_processing_ms": 0.08601666815671581, "mean_env_wait_ms": 0.47052939911267416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1410.4568066655097, "episode_reward_min": 978.4492426498094, "episode_reward_mean": 1215.6368465870753, "episode_len_mean": 264.83, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1044.9126937625817, 1218.819947636334, 1123.448116897351, 1186.5752649616136, 1109.7839422146083, 1149.4987357442303, 1199.4058118738426, 1237.4047265506172, 1185.1555525449076, 1118.3665006917809, 978.4492426498094, 1052.3097460482725, 1260.4724981149027, 1206.986422907258, 995.0224347404933, 1216.921217353215, 1096.8702104094082, 1252.1128717207055, 1100.3525221658067, 1312.9498528795702, 1144.114238916379, 1025.7521141203774, 1331.6356767251918, 1231.6510504880962, 1089.438324644616, 1288.7371983918738, 1219.7172792720944, 1326.5952352408726, 1147.3547160605779, 1404.0273242526894, 1224.8430422118208, 1173.834112180336, 1199.1799237161947, 1176.1101242440448, 1200.829752652214, 1310.3271876488284, 1313.5847981394331, 1270.6790041380073, 1263.659271174183, 1150.5548442970671, 1166.1155884294515, 1312.771019426333, 1175.5862001618175, 1275.0562509296096, 1133.9287301620666, 1179.58514837214, 1233.093202204532, 1237.1338428653626, 1289.8484108575226, 1222.9504638203732, 1285.5308233622816, 1230.4365809079877, 1252.2762829700412, 1188.4446268280217, 1243.7612439843615, 1294.523728330535, 1373.9394890785534, 1290.1333015298578, 1318.1374214238613, 1377.5442024615795, 1203.4372421127057, 1208.4242338416477, 1133.8450232729278, 1254.930498636796, 1354.6257508648284, 1169.3402689575114, 1329.820332133576, 1090.1255523677764, 1182.5104411941245, 1179.5904313642359, 1195.400780556537, 1284.9911423700821, 1112.5149710401768, 1131.8952477393998, 1301.256979127312, 1324.173478556675, 1243.1508400923856, 1243.90529221821, 1208.1266110895576, 1129.9860933360164, 1254.8812520372064, 1092.9262020206513, 1178.6861851489482, 1244.9122331446804, 1251.6744534727866, 1276.7348396446882, 1214.317391017965, 1238.228304450956, 1269.8206797656696, 1158.1049535001732, 1217.8264711149568, 1410.4568066655097, 1352.6070846865134, 1354.4833556880592, 1210.1180802348058, 1223.358870496876, 1214.8216472906904, 1212.758125742191, 1150.8654640463008, 1134.8109591769307], "episode_lengths": [297, 311, 311, 277, 322, 267, 289, 313, 306, 241, 313, 269, 304, 354, 265, 312, 278, 297, 288, 331, 272, 261, 339, 302, 244, 322, 286, 300, 215, 300, 298, 300, 270, 279, 283, 315, 305, 305, 275, 286, 249, 253, 277, 253, 250, 289, 239, 250, 310, 226, 316, 269, 278, 198, 247, 232, 283, 292, 267, 262, 299, 237, 230, 267, 270, 223, 267, 237, 229, 229, 244, 276, 243, 238, 238, 272, 248, 234, 235, 225, 242, 256, 223, 260, 199, 204, 203, 256, 232, 247, 215, 258, 249, 207, 270, 209, 210, 205, 266, 189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2358972733829998, "mean_inference_ms": 0.941226250167468, "mean_action_processing_ms": 0.08601666815671581, "mean_env_wait_ms": 0.47052939911267416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 6864.695, "sample_time_ms": 666.073, "load_time_ms": 0.362, "load_throughput": 11049065.011, "learn_time_ms": 6186.232, "learn_throughput": 646.597, "synch_weights_time_ms": 11.807}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 100, "training_iteration": 7, "trial_id": "2db34_00000", "date": "2023-04-30_16-56-51", "timestamp": 1682848611, "time_this_iter_s": 7.085437536239624, "time_total_s": 48.093191385269165, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 48.093191385269165, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 10.860000000000001, "ram_util_percent": 65.64000000000001}}
{"custom_metrics": {"dps_mean": 10374.562026710935, "dps_min": 8547.934284336481, "dps_max": 11821.62486662139}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8965315059308083, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.86456288676108, "policy_loss": -0.035832898695051914, "vf_loss": 9.896531881311889, "vf_explained_var": 0.010944250963067496, "kl": 0.01931951342151502, "entropy": 1.9313633834162065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 1418.5949839945679, "episode_reward_min": 1025.7521141203774, "episode_reward_mean": 1244.947443205312, "episode_len_mean": 252.33, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10374.562026710935, "dps_min": 8547.934284336481, "dps_max": 11821.62486662139}, "hist_stats": {"episode_reward": [1312.9498528795702, 1144.114238916379, 1025.7521141203774, 1331.6356767251918, 1231.6510504880962, 1089.438324644616, 1288.7371983918738, 1219.7172792720944, 1326.5952352408726, 1147.3547160605779, 1404.0273242526894, 1224.8430422118208, 1173.834112180336, 1199.1799237161947, 1176.1101242440448, 1200.829752652214, 1310.3271876488284, 1313.5847981394331, 1270.6790041380073, 1263.659271174183, 1150.5548442970671, 1166.1155884294515, 1312.771019426333, 1175.5862001618175, 1275.0562509296096, 1133.9287301620666, 1179.58514837214, 1233.093202204532, 1237.1338428653626, 1289.8484108575226, 1222.9504638203732, 1285.5308233622816, 1230.4365809079877, 1252.2762829700412, 1188.4446268280217, 1243.7612439843615, 1294.523728330535, 1373.9394890785534, 1290.1333015298578, 1318.1374214238613, 1377.5442024615795, 1203.4372421127057, 1208.4242338416477, 1133.8450232729278, 1254.930498636796, 1354.6257508648284, 1169.3402689575114, 1329.820332133576, 1090.1255523677764, 1182.5104411941245, 1179.5904313642359, 1195.400780556537, 1284.9911423700821, 1112.5149710401768, 1131.8952477393998, 1301.256979127312, 1324.173478556675, 1243.1508400923856, 1243.90529221821, 1208.1266110895576, 1129.9860933360164, 1254.8812520372064, 1092.9262020206513, 1178.6861851489482, 1244.9122331446804, 1251.6744534727866, 1276.7348396446882, 1214.317391017965, 1238.228304450956, 1269.8206797656696, 1158.1049535001732, 1217.8264711149568, 1410.4568066655097, 1352.6070846865134, 1354.4833556880592, 1210.1180802348058, 1223.358870496876, 1214.8216472906904, 1212.758125742191, 1150.8654640463008, 1134.8109591769307, 1347.9022642845803, 1262.8408042842389, 1371.6264827844018, 1393.8049658566263, 1409.0603003030367, 1296.7531703250256, 1286.1986879373799, 1178.7851744804343, 1258.3588078051152, 1263.832727091234, 1418.5949839945679, 1199.093058463812, 1373.8756365016097, 1246.2859330474669, 1234.9824591018662, 1393.931644951865, 1220.0945835246553, 1242.0718010863538, 1265.8346349871401], "episode_lengths": [331, 272, 261, 339, 302, 244, 322, 286, 300, 215, 300, 298, 300, 270, 279, 283, 315, 305, 305, 275, 286, 249, 253, 277, 253, 250, 289, 239, 250, 310, 226, 316, 269, 278, 198, 247, 232, 283, 292, 267, 262, 299, 237, 230, 267, 270, 223, 267, 237, 229, 229, 244, 276, 243, 238, 238, 272, 248, 234, 235, 225, 242, 256, 223, 260, 199, 204, 203, 256, 232, 247, 215, 258, 249, 207, 270, 209, 210, 205, 266, 189, 230, 222, 244, 240, 245, 240, 175, 213, 198, 230, 257, 235, 241, 230, 204, 310, 232, 216, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2363037275017363, "mean_inference_ms": 0.9431113967852444, "mean_action_processing_ms": 0.08619017450168162, "mean_env_wait_ms": 0.4717743624598084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1418.5949839945679, "episode_reward_min": 1025.7521141203774, "episode_reward_mean": 1244.947443205312, "episode_len_mean": 252.33, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1312.9498528795702, 1144.114238916379, 1025.7521141203774, 1331.6356767251918, 1231.6510504880962, 1089.438324644616, 1288.7371983918738, 1219.7172792720944, 1326.5952352408726, 1147.3547160605779, 1404.0273242526894, 1224.8430422118208, 1173.834112180336, 1199.1799237161947, 1176.1101242440448, 1200.829752652214, 1310.3271876488284, 1313.5847981394331, 1270.6790041380073, 1263.659271174183, 1150.5548442970671, 1166.1155884294515, 1312.771019426333, 1175.5862001618175, 1275.0562509296096, 1133.9287301620666, 1179.58514837214, 1233.093202204532, 1237.1338428653626, 1289.8484108575226, 1222.9504638203732, 1285.5308233622816, 1230.4365809079877, 1252.2762829700412, 1188.4446268280217, 1243.7612439843615, 1294.523728330535, 1373.9394890785534, 1290.1333015298578, 1318.1374214238613, 1377.5442024615795, 1203.4372421127057, 1208.4242338416477, 1133.8450232729278, 1254.930498636796, 1354.6257508648284, 1169.3402689575114, 1329.820332133576, 1090.1255523677764, 1182.5104411941245, 1179.5904313642359, 1195.400780556537, 1284.9911423700821, 1112.5149710401768, 1131.8952477393998, 1301.256979127312, 1324.173478556675, 1243.1508400923856, 1243.90529221821, 1208.1266110895576, 1129.9860933360164, 1254.8812520372064, 1092.9262020206513, 1178.6861851489482, 1244.9122331446804, 1251.6744534727866, 1276.7348396446882, 1214.317391017965, 1238.228304450956, 1269.8206797656696, 1158.1049535001732, 1217.8264711149568, 1410.4568066655097, 1352.6070846865134, 1354.4833556880592, 1210.1180802348058, 1223.358870496876, 1214.8216472906904, 1212.758125742191, 1150.8654640463008, 1134.8109591769307, 1347.9022642845803, 1262.8408042842389, 1371.6264827844018, 1393.8049658566263, 1409.0603003030367, 1296.7531703250256, 1286.1986879373799, 1178.7851744804343, 1258.3588078051152, 1263.832727091234, 1418.5949839945679, 1199.093058463812, 1373.8756365016097, 1246.2859330474669, 1234.9824591018662, 1393.931644951865, 1220.0945835246553, 1242.0718010863538, 1265.8346349871401], "episode_lengths": [331, 272, 261, 339, 302, 244, 322, 286, 300, 215, 300, 298, 300, 270, 279, 283, 315, 305, 305, 275, 286, 249, 253, 277, 253, 250, 289, 239, 250, 310, 226, 316, 269, 278, 198, 247, 232, 283, 292, 267, 262, 299, 237, 230, 267, 270, 223, 267, 237, 229, 229, 244, 276, 243, 238, 238, 272, 248, 234, 235, 225, 242, 256, 223, 260, 199, 204, 203, 256, 232, 247, 215, 258, 249, 207, 270, 209, 210, 205, 266, 189, 230, 222, 244, 240, 245, 240, 175, 213, 198, 230, 257, 235, 241, 230, 204, 310, 232, 216, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2363037275017363, "mean_inference_ms": 0.9431113967852444, "mean_action_processing_ms": 0.08619017450168162, "mean_env_wait_ms": 0.4717743624598084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 6860.499, "sample_time_ms": 670.341, "load_time_ms": 0.384, "load_throughput": 10425487.65, "learn_time_ms": 6177.691, "learn_throughput": 647.491, "synch_weights_time_ms": 11.89}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 119, "training_iteration": 8, "trial_id": "2db34_00000", "date": "2023-04-30_16-56-58", "timestamp": 1682848618, "time_this_iter_s": 6.837127208709717, "time_total_s": 54.93031859397888, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 54.93031859397888, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 8.629999999999999, "ram_util_percent": 65.59}}
{"custom_metrics": {"dps_mean": 10444.587565352693, "dps_min": 9084.379603064805, "dps_max": 11821.62486662139}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8287852253965151, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.878245002992692, "policy_loss": -0.036336125131015494, "vf_loss": 9.911123796688614, "vf_explained_var": 0.009708498947082027, "kl": 0.01728639453935102, "entropy": 1.8745982113704887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 1418.5949839945679, "episode_reward_min": 1090.1255523677764, "episode_reward_mean": 1253.350507842323, "episode_len_mean": 241.14, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10444.587565352693, "dps_min": 9084.379603064805, "dps_max": 11821.62486662139}, "hist_stats": {"episode_reward": [1310.3271876488284, 1313.5847981394331, 1270.6790041380073, 1263.659271174183, 1150.5548442970671, 1166.1155884294515, 1312.771019426333, 1175.5862001618175, 1275.0562509296096, 1133.9287301620666, 1179.58514837214, 1233.093202204532, 1237.1338428653626, 1289.8484108575226, 1222.9504638203732, 1285.5308233622816, 1230.4365809079877, 1252.2762829700412, 1188.4446268280217, 1243.7612439843615, 1294.523728330535, 1373.9394890785534, 1290.1333015298578, 1318.1374214238613, 1377.5442024615795, 1203.4372421127057, 1208.4242338416477, 1133.8450232729278, 1254.930498636796, 1354.6257508648284, 1169.3402689575114, 1329.820332133576, 1090.1255523677764, 1182.5104411941245, 1179.5904313642359, 1195.400780556537, 1284.9911423700821, 1112.5149710401768, 1131.8952477393998, 1301.256979127312, 1324.173478556675, 1243.1508400923856, 1243.90529221821, 1208.1266110895576, 1129.9860933360164, 1254.8812520372064, 1092.9262020206513, 1178.6861851489482, 1244.9122331446804, 1251.6744534727866, 1276.7348396446882, 1214.317391017965, 1238.228304450956, 1269.8206797656696, 1158.1049535001732, 1217.8264711149568, 1410.4568066655097, 1352.6070846865134, 1354.4833556880592, 1210.1180802348058, 1223.358870496876, 1214.8216472906904, 1212.758125742191, 1150.8654640463008, 1134.8109591769307, 1347.9022642845803, 1262.8408042842389, 1371.6264827844018, 1393.8049658566263, 1409.0603003030367, 1296.7531703250256, 1286.1986879373799, 1178.7851744804343, 1258.3588078051152, 1263.832727091234, 1418.5949839945679, 1199.093058463812, 1373.8756365016097, 1246.2859330474669, 1234.9824591018662, 1393.931644951865, 1220.0945835246553, 1242.0718010863538, 1265.8346349871401, 1276.3328074185458, 1333.5230965714327, 1283.3461396465734, 1373.7527049572845, 1327.9194682771563, 1268.550835527652, 1129.404832570991, 1301.3063599826166, 1219.1667479456837, 1145.3553292795295, 1361.7423237113708, 1221.334918690654, 1262.8334355038387, 1211.5799543000212, 1408.5631416141252, 1212.3643337005674], "episode_lengths": [315, 305, 305, 275, 286, 249, 253, 277, 253, 250, 289, 239, 250, 310, 226, 316, 269, 278, 198, 247, 232, 283, 292, 267, 262, 299, 237, 230, 267, 270, 223, 267, 237, 229, 229, 244, 276, 243, 238, 238, 272, 248, 234, 235, 225, 242, 256, 223, 260, 199, 204, 203, 256, 232, 247, 215, 258, 249, 207, 270, 209, 210, 205, 266, 189, 230, 222, 244, 240, 245, 240, 175, 213, 198, 230, 257, 235, 241, 230, 204, 310, 232, 216, 202, 240, 203, 186, 261, 260, 207, 182, 212, 243, 180, 260, 198, 182, 213, 239, 217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23680871730326017, "mean_inference_ms": 0.9442223601060751, "mean_action_processing_ms": 0.08599855426656271, "mean_env_wait_ms": 0.47343154394305453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1418.5949839945679, "episode_reward_min": 1090.1255523677764, "episode_reward_mean": 1253.350507842323, "episode_len_mean": 241.14, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1310.3271876488284, 1313.5847981394331, 1270.6790041380073, 1263.659271174183, 1150.5548442970671, 1166.1155884294515, 1312.771019426333, 1175.5862001618175, 1275.0562509296096, 1133.9287301620666, 1179.58514837214, 1233.093202204532, 1237.1338428653626, 1289.8484108575226, 1222.9504638203732, 1285.5308233622816, 1230.4365809079877, 1252.2762829700412, 1188.4446268280217, 1243.7612439843615, 1294.523728330535, 1373.9394890785534, 1290.1333015298578, 1318.1374214238613, 1377.5442024615795, 1203.4372421127057, 1208.4242338416477, 1133.8450232729278, 1254.930498636796, 1354.6257508648284, 1169.3402689575114, 1329.820332133576, 1090.1255523677764, 1182.5104411941245, 1179.5904313642359, 1195.400780556537, 1284.9911423700821, 1112.5149710401768, 1131.8952477393998, 1301.256979127312, 1324.173478556675, 1243.1508400923856, 1243.90529221821, 1208.1266110895576, 1129.9860933360164, 1254.8812520372064, 1092.9262020206513, 1178.6861851489482, 1244.9122331446804, 1251.6744534727866, 1276.7348396446882, 1214.317391017965, 1238.228304450956, 1269.8206797656696, 1158.1049535001732, 1217.8264711149568, 1410.4568066655097, 1352.6070846865134, 1354.4833556880592, 1210.1180802348058, 1223.358870496876, 1214.8216472906904, 1212.758125742191, 1150.8654640463008, 1134.8109591769307, 1347.9022642845803, 1262.8408042842389, 1371.6264827844018, 1393.8049658566263, 1409.0603003030367, 1296.7531703250256, 1286.1986879373799, 1178.7851744804343, 1258.3588078051152, 1263.832727091234, 1418.5949839945679, 1199.093058463812, 1373.8756365016097, 1246.2859330474669, 1234.9824591018662, 1393.931644951865, 1220.0945835246553, 1242.0718010863538, 1265.8346349871401, 1276.3328074185458, 1333.5230965714327, 1283.3461396465734, 1373.7527049572845, 1327.9194682771563, 1268.550835527652, 1129.404832570991, 1301.3063599826166, 1219.1667479456837, 1145.3553292795295, 1361.7423237113708, 1221.334918690654, 1262.8334355038387, 1211.5799543000212, 1408.5631416141252, 1212.3643337005674], "episode_lengths": [315, 305, 305, 275, 286, 249, 253, 277, 253, 250, 289, 239, 250, 310, 226, 316, 269, 278, 198, 247, 232, 283, 292, 267, 262, 299, 237, 230, 267, 270, 223, 267, 237, 229, 229, 244, 276, 243, 238, 238, 272, 248, 234, 235, 225, 242, 256, 223, 260, 199, 204, 203, 256, 232, 247, 215, 258, 249, 207, 270, 209, 210, 205, 266, 189, 230, 222, 244, 240, 245, 240, 175, 213, 198, 230, 257, 235, 241, 230, 204, 310, 232, 216, 202, 240, 203, 186, 261, 260, 207, 182, 212, 243, 180, 260, 198, 182, 213, 239, 217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23680871730326017, "mean_inference_ms": 0.9442223601060751, "mean_action_processing_ms": 0.08599855426656271, "mean_env_wait_ms": 0.47343154394305453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 6854.32, "sample_time_ms": 667.513, "load_time_ms": 0.452, "load_throughput": 8848224.084, "learn_time_ms": 6174.269, "learn_throughput": 647.85, "synch_weights_time_ms": 11.914}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 135, "training_iteration": 9, "trial_id": "2db34_00000", "date": "2023-04-30_16-57-05", "timestamp": 1682848625, "time_this_iter_s": 6.810113430023193, "time_total_s": 61.740432024002075, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 61.740432024002075, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 8.755555555555555, "ram_util_percent": 65.58888888888889}}
{"custom_metrics": {"dps_mean": 10558.083885699241, "dps_min": 9084.379603064805, "dps_max": 12314.993150903121}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7805700891440917, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.835711041317191, "policy_loss": -0.03927893174952397, "vf_loss": 9.871541593408072, "vf_explained_var": 0.006154042931013209, "kl": 0.017241857727504223, "entropy": 1.8079126258050242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 1477.7991781083742, "episode_reward_min": 1090.1255523677764, "episode_reward_mean": 1266.970066283909, "episode_len_mean": 229.23, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10558.083885699241, "dps_min": 9084.379603064805, "dps_max": 12314.993150903121}, "hist_stats": {"episode_reward": [1290.1333015298578, 1318.1374214238613, 1377.5442024615795, 1203.4372421127057, 1208.4242338416477, 1133.8450232729278, 1254.930498636796, 1354.6257508648284, 1169.3402689575114, 1329.820332133576, 1090.1255523677764, 1182.5104411941245, 1179.5904313642359, 1195.400780556537, 1284.9911423700821, 1112.5149710401768, 1131.8952477393998, 1301.256979127312, 1324.173478556675, 1243.1508400923856, 1243.90529221821, 1208.1266110895576, 1129.9860933360164, 1254.8812520372064, 1092.9262020206513, 1178.6861851489482, 1244.9122331446804, 1251.6744534727866, 1276.7348396446882, 1214.317391017965, 1238.228304450956, 1269.8206797656696, 1158.1049535001732, 1217.8264711149568, 1410.4568066655097, 1352.6070846865134, 1354.4833556880592, 1210.1180802348058, 1223.358870496876, 1214.8216472906904, 1212.758125742191, 1150.8654640463008, 1134.8109591769307, 1347.9022642845803, 1262.8408042842389, 1371.6264827844018, 1393.8049658566263, 1409.0603003030367, 1296.7531703250256, 1286.1986879373799, 1178.7851744804343, 1258.3588078051152, 1263.832727091234, 1418.5949839945679, 1199.093058463812, 1373.8756365016097, 1246.2859330474669, 1234.9824591018662, 1393.931644951865, 1220.0945835246553, 1242.0718010863538, 1265.8346349871401, 1276.3328074185458, 1333.5230965714327, 1283.3461396465734, 1373.7527049572845, 1327.9194682771563, 1268.550835527652, 1129.404832570991, 1301.3063599826166, 1219.1667479456837, 1145.3553292795295, 1361.7423237113708, 1221.334918690654, 1262.8334355038387, 1211.5799543000212, 1408.5631416141252, 1212.3643337005674, 1122.410788474358, 1281.214948570083, 1296.4971900914322, 1343.0765869186953, 1284.1091538120543, 1310.2211636207314, 1347.655683176703, 1282.3879879109434, 1277.2712713569615, 1191.6069065061452, 1256.189361173435, 1350.4113800933217, 1323.5874634475672, 1202.203004333896, 1385.2486190773795, 1396.9773459042126, 1477.7991781083742, 1251.3319784880084, 1447.1726485441964, 1292.1465505590097, 1259.9824595493142, 1386.2409125302902], "episode_lengths": [292, 267, 262, 299, 237, 230, 267, 270, 223, 267, 237, 229, 229, 244, 276, 243, 238, 238, 272, 248, 234, 235, 225, 242, 256, 223, 260, 199, 204, 203, 256, 232, 247, 215, 258, 249, 207, 270, 209, 210, 205, 266, 189, 230, 222, 244, 240, 245, 240, 175, 213, 198, 230, 257, 235, 241, 230, 204, 310, 232, 216, 202, 240, 203, 186, 261, 260, 207, 182, 212, 243, 180, 260, 198, 182, 213, 239, 217, 168, 198, 218, 231, 202, 217, 245, 163, 199, 185, 203, 219, 218, 175, 238, 224, 276, 193, 234, 242, 235, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2371432223543021, "mean_inference_ms": 0.9498178603649617, "mean_action_processing_ms": 0.08605846412911845, "mean_env_wait_ms": 0.47625502320063906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1477.7991781083742, "episode_reward_min": 1090.1255523677764, "episode_reward_mean": 1266.970066283909, "episode_len_mean": 229.23, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1290.1333015298578, 1318.1374214238613, 1377.5442024615795, 1203.4372421127057, 1208.4242338416477, 1133.8450232729278, 1254.930498636796, 1354.6257508648284, 1169.3402689575114, 1329.820332133576, 1090.1255523677764, 1182.5104411941245, 1179.5904313642359, 1195.400780556537, 1284.9911423700821, 1112.5149710401768, 1131.8952477393998, 1301.256979127312, 1324.173478556675, 1243.1508400923856, 1243.90529221821, 1208.1266110895576, 1129.9860933360164, 1254.8812520372064, 1092.9262020206513, 1178.6861851489482, 1244.9122331446804, 1251.6744534727866, 1276.7348396446882, 1214.317391017965, 1238.228304450956, 1269.8206797656696, 1158.1049535001732, 1217.8264711149568, 1410.4568066655097, 1352.6070846865134, 1354.4833556880592, 1210.1180802348058, 1223.358870496876, 1214.8216472906904, 1212.758125742191, 1150.8654640463008, 1134.8109591769307, 1347.9022642845803, 1262.8408042842389, 1371.6264827844018, 1393.8049658566263, 1409.0603003030367, 1296.7531703250256, 1286.1986879373799, 1178.7851744804343, 1258.3588078051152, 1263.832727091234, 1418.5949839945679, 1199.093058463812, 1373.8756365016097, 1246.2859330474669, 1234.9824591018662, 1393.931644951865, 1220.0945835246553, 1242.0718010863538, 1265.8346349871401, 1276.3328074185458, 1333.5230965714327, 1283.3461396465734, 1373.7527049572845, 1327.9194682771563, 1268.550835527652, 1129.404832570991, 1301.3063599826166, 1219.1667479456837, 1145.3553292795295, 1361.7423237113708, 1221.334918690654, 1262.8334355038387, 1211.5799543000212, 1408.5631416141252, 1212.3643337005674, 1122.410788474358, 1281.214948570083, 1296.4971900914322, 1343.0765869186953, 1284.1091538120543, 1310.2211636207314, 1347.655683176703, 1282.3879879109434, 1277.2712713569615, 1191.6069065061452, 1256.189361173435, 1350.4113800933217, 1323.5874634475672, 1202.203004333896, 1385.2486190773795, 1396.9773459042126, 1477.7991781083742, 1251.3319784880084, 1447.1726485441964, 1292.1465505590097, 1259.9824595493142, 1386.2409125302902], "episode_lengths": [292, 267, 262, 299, 237, 230, 267, 270, 223, 267, 237, 229, 229, 244, 276, 243, 238, 238, 272, 248, 234, 235, 225, 242, 256, 223, 260, 199, 204, 203, 256, 232, 247, 215, 258, 249, 207, 270, 209, 210, 205, 266, 189, 230, 222, 244, 240, 245, 240, 175, 213, 198, 230, 257, 235, 241, 230, 204, 310, 232, 216, 202, 240, 203, 186, 261, 260, 207, 182, 212, 243, 180, 260, 198, 182, 213, 239, 217, 168, 198, 218, 231, 202, 217, 245, 163, 199, 185, 203, 219, 218, 175, 238, 224, 276, 193, 234, 242, 235, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2371432223543021, "mean_inference_ms": 0.9498178603649617, "mean_action_processing_ms": 0.08605846412911845, "mean_env_wait_ms": 0.47625502320063906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 6868.171, "sample_time_ms": 666.545, "load_time_ms": 0.508, "load_throughput": 7876257.453, "learn_time_ms": 6188.902, "learn_throughput": 646.318, "synch_weights_time_ms": 11.962}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 157, "training_iteration": 10, "trial_id": "2db34_00000", "date": "2023-04-30_16-57-12", "timestamp": 1682848632, "time_this_iter_s": 6.998987197875977, "time_total_s": 68.73941922187805, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 68.73941922187805, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 8.3, "ram_util_percent": 65.62999999999998}}
{"custom_metrics": {"dps_mean": 10588.025786964057, "dps_min": 8696.265361640702, "dps_max": 12314.993150903121}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.013153480586185, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.849340871585312, "policy_loss": -0.036743640161109384, "vf_loss": 9.882601893845425, "vf_explained_var": 0.014732319757502567, "kl": 0.01741301952173175, "entropy": 1.7854207883598985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 1477.7991781083742, "episode_reward_min": 1043.5518433968837, "episode_reward_mean": 1270.5630944356867, "episode_len_mean": 220.08, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10588.025786964057, "dps_min": 8696.265361640702, "dps_max": 12314.993150903121}, "hist_stats": {"episode_reward": [1243.1508400923856, 1243.90529221821, 1208.1266110895576, 1129.9860933360164, 1254.8812520372064, 1092.9262020206513, 1178.6861851489482, 1244.9122331446804, 1251.6744534727866, 1276.7348396446882, 1214.317391017965, 1238.228304450956, 1269.8206797656696, 1158.1049535001732, 1217.8264711149568, 1410.4568066655097, 1352.6070846865134, 1354.4833556880592, 1210.1180802348058, 1223.358870496876, 1214.8216472906904, 1212.758125742191, 1150.8654640463008, 1134.8109591769307, 1347.9022642845803, 1262.8408042842389, 1371.6264827844018, 1393.8049658566263, 1409.0603003030367, 1296.7531703250256, 1286.1986879373799, 1178.7851744804343, 1258.3588078051152, 1263.832727091234, 1418.5949839945679, 1199.093058463812, 1373.8756365016097, 1246.2859330474669, 1234.9824591018662, 1393.931644951865, 1220.0945835246553, 1242.0718010863538, 1265.8346349871401, 1276.3328074185458, 1333.5230965714327, 1283.3461396465734, 1373.7527049572845, 1327.9194682771563, 1268.550835527652, 1129.404832570991, 1301.3063599826166, 1219.1667479456837, 1145.3553292795295, 1361.7423237113708, 1221.334918690654, 1262.8334355038387, 1211.5799543000212, 1408.5631416141252, 1212.3643337005674, 1122.410788474358, 1281.214948570083, 1296.4971900914322, 1343.0765869186953, 1284.1091538120543, 1310.2211636207314, 1347.655683176703, 1282.3879879109434, 1277.2712713569615, 1191.6069065061452, 1256.189361173435, 1350.4113800933217, 1323.5874634475672, 1202.203004333896, 1385.2486190773795, 1396.9773459042126, 1477.7991781083742, 1251.3319784880084, 1447.1726485441964, 1292.1465505590097, 1259.9824595493142, 1386.2409125302902, 1169.2921059652901, 1331.773347125516, 1265.955344869733, 1184.4970655108211, 1176.6338553714716, 1319.1326874487572, 1353.0106380916664, 1288.3409391079924, 1043.5518433968837, 1467.2829870907997, 1066.652491858401, 1350.7581941024328, 1198.0093339706523, 1393.6810684036966, 1147.8120112549932, 1394.0373385005546, 1187.7714991744538, 1185.1275088930538, 1278.6798545922156], "episode_lengths": [248, 234, 235, 225, 242, 256, 223, 260, 199, 204, 203, 256, 232, 247, 215, 258, 249, 207, 270, 209, 210, 205, 266, 189, 230, 222, 244, 240, 245, 240, 175, 213, 198, 230, 257, 235, 241, 230, 204, 310, 232, 216, 202, 240, 203, 186, 261, 260, 207, 182, 212, 243, 180, 260, 198, 182, 213, 239, 217, 168, 198, 218, 231, 202, 217, 245, 163, 199, 185, 203, 219, 218, 175, 238, 224, 276, 193, 234, 242, 235, 231, 208, 217, 214, 179, 182, 178, 194, 184, 197, 235, 223, 251, 181, 247, 178, 232, 173, 194, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23885541001095092, "mean_inference_ms": 0.9576492150435101, "mean_action_processing_ms": 0.08662183314752804, "mean_env_wait_ms": 0.48046054506286723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1477.7991781083742, "episode_reward_min": 1043.5518433968837, "episode_reward_mean": 1270.5630944356867, "episode_len_mean": 220.08, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1243.1508400923856, 1243.90529221821, 1208.1266110895576, 1129.9860933360164, 1254.8812520372064, 1092.9262020206513, 1178.6861851489482, 1244.9122331446804, 1251.6744534727866, 1276.7348396446882, 1214.317391017965, 1238.228304450956, 1269.8206797656696, 1158.1049535001732, 1217.8264711149568, 1410.4568066655097, 1352.6070846865134, 1354.4833556880592, 1210.1180802348058, 1223.358870496876, 1214.8216472906904, 1212.758125742191, 1150.8654640463008, 1134.8109591769307, 1347.9022642845803, 1262.8408042842389, 1371.6264827844018, 1393.8049658566263, 1409.0603003030367, 1296.7531703250256, 1286.1986879373799, 1178.7851744804343, 1258.3588078051152, 1263.832727091234, 1418.5949839945679, 1199.093058463812, 1373.8756365016097, 1246.2859330474669, 1234.9824591018662, 1393.931644951865, 1220.0945835246553, 1242.0718010863538, 1265.8346349871401, 1276.3328074185458, 1333.5230965714327, 1283.3461396465734, 1373.7527049572845, 1327.9194682771563, 1268.550835527652, 1129.404832570991, 1301.3063599826166, 1219.1667479456837, 1145.3553292795295, 1361.7423237113708, 1221.334918690654, 1262.8334355038387, 1211.5799543000212, 1408.5631416141252, 1212.3643337005674, 1122.410788474358, 1281.214948570083, 1296.4971900914322, 1343.0765869186953, 1284.1091538120543, 1310.2211636207314, 1347.655683176703, 1282.3879879109434, 1277.2712713569615, 1191.6069065061452, 1256.189361173435, 1350.4113800933217, 1323.5874634475672, 1202.203004333896, 1385.2486190773795, 1396.9773459042126, 1477.7991781083742, 1251.3319784880084, 1447.1726485441964, 1292.1465505590097, 1259.9824595493142, 1386.2409125302902, 1169.2921059652901, 1331.773347125516, 1265.955344869733, 1184.4970655108211, 1176.6338553714716, 1319.1326874487572, 1353.0106380916664, 1288.3409391079924, 1043.5518433968837, 1467.2829870907997, 1066.652491858401, 1350.7581941024328, 1198.0093339706523, 1393.6810684036966, 1147.8120112549932, 1394.0373385005546, 1187.7714991744538, 1185.1275088930538, 1278.6798545922156], "episode_lengths": [248, 234, 235, 225, 242, 256, 223, 260, 199, 204, 203, 256, 232, 247, 215, 258, 249, 207, 270, 209, 210, 205, 266, 189, 230, 222, 244, 240, 245, 240, 175, 213, 198, 230, 257, 235, 241, 230, 204, 310, 232, 216, 202, 240, 203, 186, 261, 260, 207, 182, 212, 243, 180, 260, 198, 182, 213, 239, 217, 168, 198, 218, 231, 202, 217, 245, 163, 199, 185, 203, 219, 218, 175, 238, 224, 276, 193, 234, 242, 235, 231, 208, 217, 214, 179, 182, 178, 194, 184, 197, 235, 223, 251, 181, 247, 178, 232, 173, 194, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23885541001095092, "mean_inference_ms": 0.9576492150435101, "mean_action_processing_ms": 0.08662183314752804, "mean_env_wait_ms": 0.48046054506286723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 6868.249, "sample_time_ms": 676.367, "load_time_ms": 0.558, "load_throughput": 7163321.805, "learn_time_ms": 6179.04, "learn_throughput": 647.35, "synch_weights_time_ms": 12.028}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 176, "training_iteration": 11, "trial_id": "2db34_00000", "date": "2023-04-30_16-57-19", "timestamp": 1682848639, "time_this_iter_s": 7.02628493309021, "time_total_s": 75.76570415496826, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 75.76570415496826, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 10.739999999999998, "ram_util_percent": 65.6}}
{"custom_metrics": {"dps_mean": 10706.138979316647, "dps_min": 8696.265361640702, "dps_max": 12314.993150903121}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.07304119954827, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.85497687657674, "policy_loss": -0.041705893101771516, "vf_loss": 9.890864199976768, "vf_explained_var": 0.010543464909317672, "kl": 0.029092813155298356, "entropy": 1.7477802025374545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 1477.7991781083742, "episode_reward_min": 1043.5518433968837, "episode_reward_mean": 1284.736677517998, "episode_len_mean": 211.53, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10706.138979316647, "dps_min": 8696.265361640702, "dps_max": 12314.993150903121}, "hist_stats": {"episode_reward": [1150.8654640463008, 1134.8109591769307, 1347.9022642845803, 1262.8408042842389, 1371.6264827844018, 1393.8049658566263, 1409.0603003030367, 1296.7531703250256, 1286.1986879373799, 1178.7851744804343, 1258.3588078051152, 1263.832727091234, 1418.5949839945679, 1199.093058463812, 1373.8756365016097, 1246.2859330474669, 1234.9824591018662, 1393.931644951865, 1220.0945835246553, 1242.0718010863538, 1265.8346349871401, 1276.3328074185458, 1333.5230965714327, 1283.3461396465734, 1373.7527049572845, 1327.9194682771563, 1268.550835527652, 1129.404832570991, 1301.3063599826166, 1219.1667479456837, 1145.3553292795295, 1361.7423237113708, 1221.334918690654, 1262.8334355038387, 1211.5799543000212, 1408.5631416141252, 1212.3643337005674, 1122.410788474358, 1281.214948570083, 1296.4971900914322, 1343.0765869186953, 1284.1091538120543, 1310.2211636207314, 1347.655683176703, 1282.3879879109434, 1277.2712713569615, 1191.6069065061452, 1256.189361173435, 1350.4113800933217, 1323.5874634475672, 1202.203004333896, 1385.2486190773795, 1396.9773459042126, 1477.7991781083742, 1251.3319784880084, 1447.1726485441964, 1292.1465505590097, 1259.9824595493142, 1386.2409125302902, 1169.2921059652901, 1331.773347125516, 1265.955344869733, 1184.4970655108211, 1176.6338553714716, 1319.1326874487572, 1353.0106380916664, 1288.3409391079924, 1043.5518433968837, 1467.2829870907997, 1066.652491858401, 1350.7581941024328, 1198.0093339706523, 1393.6810684036966, 1147.8120112549932, 1394.0373385005546, 1187.7714991744538, 1185.1275088930538, 1278.6798545922156, 1243.315478660198, 1376.7588663849524, 1325.9019332880396, 1354.8041596477833, 1207.4773349730733, 1382.8917875932086, 1364.5003809475504, 1328.7070026034162, 1340.6456658653458, 1249.7099783870647, 1307.971468756347, 1332.9019852850151, 1224.878928134705, 1313.4032090833318, 1280.767374593093, 1243.9907182425334, 1336.819950461642, 1251.600265366137, 1133.8910609586421, 1429.8689075667628, 1292.0563090990872, 1296.3813151926809], "episode_lengths": [266, 189, 230, 222, 244, 240, 245, 240, 175, 213, 198, 230, 257, 235, 241, 230, 204, 310, 232, 216, 202, 240, 203, 186, 261, 260, 207, 182, 212, 243, 180, 260, 198, 182, 213, 239, 217, 168, 198, 218, 231, 202, 217, 245, 163, 199, 185, 203, 219, 218, 175, 238, 224, 276, 193, 234, 242, 235, 231, 208, 217, 214, 179, 182, 178, 194, 184, 197, 235, 223, 251, 181, 247, 178, 232, 173, 194, 238, 210, 216, 183, 153, 209, 217, 187, 221, 185, 165, 171, 175, 186, 187, 180, 183, 197, 189, 211, 248, 190, 169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2397898630764395, "mean_inference_ms": 0.9618092664706, "mean_action_processing_ms": 0.08688635774456505, "mean_env_wait_ms": 0.4826350345512204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1477.7991781083742, "episode_reward_min": 1043.5518433968837, "episode_reward_mean": 1284.736677517998, "episode_len_mean": 211.53, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1150.8654640463008, 1134.8109591769307, 1347.9022642845803, 1262.8408042842389, 1371.6264827844018, 1393.8049658566263, 1409.0603003030367, 1296.7531703250256, 1286.1986879373799, 1178.7851744804343, 1258.3588078051152, 1263.832727091234, 1418.5949839945679, 1199.093058463812, 1373.8756365016097, 1246.2859330474669, 1234.9824591018662, 1393.931644951865, 1220.0945835246553, 1242.0718010863538, 1265.8346349871401, 1276.3328074185458, 1333.5230965714327, 1283.3461396465734, 1373.7527049572845, 1327.9194682771563, 1268.550835527652, 1129.404832570991, 1301.3063599826166, 1219.1667479456837, 1145.3553292795295, 1361.7423237113708, 1221.334918690654, 1262.8334355038387, 1211.5799543000212, 1408.5631416141252, 1212.3643337005674, 1122.410788474358, 1281.214948570083, 1296.4971900914322, 1343.0765869186953, 1284.1091538120543, 1310.2211636207314, 1347.655683176703, 1282.3879879109434, 1277.2712713569615, 1191.6069065061452, 1256.189361173435, 1350.4113800933217, 1323.5874634475672, 1202.203004333896, 1385.2486190773795, 1396.9773459042126, 1477.7991781083742, 1251.3319784880084, 1447.1726485441964, 1292.1465505590097, 1259.9824595493142, 1386.2409125302902, 1169.2921059652901, 1331.773347125516, 1265.955344869733, 1184.4970655108211, 1176.6338553714716, 1319.1326874487572, 1353.0106380916664, 1288.3409391079924, 1043.5518433968837, 1467.2829870907997, 1066.652491858401, 1350.7581941024328, 1198.0093339706523, 1393.6810684036966, 1147.8120112549932, 1394.0373385005546, 1187.7714991744538, 1185.1275088930538, 1278.6798545922156, 1243.315478660198, 1376.7588663849524, 1325.9019332880396, 1354.8041596477833, 1207.4773349730733, 1382.8917875932086, 1364.5003809475504, 1328.7070026034162, 1340.6456658653458, 1249.7099783870647, 1307.971468756347, 1332.9019852850151, 1224.878928134705, 1313.4032090833318, 1280.767374593093, 1243.9907182425334, 1336.819950461642, 1251.600265366137, 1133.8910609586421, 1429.8689075667628, 1292.0563090990872, 1296.3813151926809], "episode_lengths": [266, 189, 230, 222, 244, 240, 245, 240, 175, 213, 198, 230, 257, 235, 241, 230, 204, 310, 232, 216, 202, 240, 203, 186, 261, 260, 207, 182, 212, 243, 180, 260, 198, 182, 213, 239, 217, 168, 198, 218, 231, 202, 217, 245, 163, 199, 185, 203, 219, 218, 175, 238, 224, 276, 193, 234, 242, 235, 231, 208, 217, 214, 179, 182, 178, 194, 184, 197, 235, 223, 251, 181, 247, 178, 232, 173, 194, 238, 210, 216, 183, 153, 209, 217, 187, 221, 185, 165, 171, 175, 186, 187, 180, 183, 197, 189, 211, 248, 190, 169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2397898630764395, "mean_inference_ms": 0.9618092664706, "mean_action_processing_ms": 0.08688635774456505, "mean_env_wait_ms": 0.4826350345512204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 6864.12, "sample_time_ms": 673.008, "load_time_ms": 0.558, "load_throughput": 7163321.805, "learn_time_ms": 6177.617, "learn_throughput": 647.499, "synch_weights_time_ms": 12.681}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 198, "training_iteration": 12, "trial_id": "2db34_00000", "date": "2023-04-30_16-57-26", "timestamp": 1682848646, "time_this_iter_s": 6.845770835876465, "time_total_s": 82.61147499084473, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 82.61147499084473, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 8.040000000000001, "ram_util_percent": 65.67000000000002}}
{"custom_metrics": {"dps_mean": 10666.696739014202, "dps_min": 8696.265361640702, "dps_max": 12314.993150903121}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.251155857373309, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.833594590874128, "policy_loss": -0.036739765099119595, "vf_loss": 9.865416984147924, "vf_explained_var": 0.012122427776295651, "kl": 0.016391177879691538, "entropy": 1.6819689218715954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 1477.7991781083742, "episode_reward_min": 1043.5518433968837, "episode_reward_mean": 1280.0036086817045, "episode_len_mean": 201.29, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10666.696739014202, "dps_min": 8696.265361640702, "dps_max": 12314.993150903121}, "hist_stats": {"episode_reward": [1276.3328074185458, 1333.5230965714327, 1283.3461396465734, 1373.7527049572845, 1327.9194682771563, 1268.550835527652, 1129.404832570991, 1301.3063599826166, 1219.1667479456837, 1145.3553292795295, 1361.7423237113708, 1221.334918690654, 1262.8334355038387, 1211.5799543000212, 1408.5631416141252, 1212.3643337005674, 1122.410788474358, 1281.214948570083, 1296.4971900914322, 1343.0765869186953, 1284.1091538120543, 1310.2211636207314, 1347.655683176703, 1282.3879879109434, 1277.2712713569615, 1191.6069065061452, 1256.189361173435, 1350.4113800933217, 1323.5874634475672, 1202.203004333896, 1385.2486190773795, 1396.9773459042126, 1477.7991781083742, 1251.3319784880084, 1447.1726485441964, 1292.1465505590097, 1259.9824595493142, 1386.2409125302902, 1169.2921059652901, 1331.773347125516, 1265.955344869733, 1184.4970655108211, 1176.6338553714716, 1319.1326874487572, 1353.0106380916664, 1288.3409391079924, 1043.5518433968837, 1467.2829870907997, 1066.652491858401, 1350.7581941024328, 1198.0093339706523, 1393.6810684036966, 1147.8120112549932, 1394.0373385005546, 1187.7714991744538, 1185.1275088930538, 1278.6798545922156, 1243.315478660198, 1376.7588663849524, 1325.9019332880396, 1354.8041596477833, 1207.4773349730733, 1382.8917875932086, 1364.5003809475504, 1328.7070026034162, 1340.6456658653458, 1249.7099783870647, 1307.971468756347, 1332.9019852850151, 1224.878928134705, 1313.4032090833318, 1280.767374593093, 1243.9907182425334, 1336.819950461642, 1251.600265366137, 1133.8910609586421, 1429.8689075667628, 1292.0563090990872, 1296.3813151926809, 1233.553787438131, 1380.928275517352, 1156.751193326198, 1177.6195164150215, 1216.116596442315, 1270.6771828077594, 1243.610295091231, 1369.8705315398863, 1239.2301135678217, 1264.7006898948375, 1295.8564158924414, 1315.1032108293127, 1283.9615879143953, 1254.5754618839328, 1379.1202285037157, 1242.386541367354, 1238.005747730623, 1269.7307784039406, 1276.4434126477215, 1116.0239113243854, 1252.0321818668988], "episode_lengths": [240, 203, 186, 261, 260, 207, 182, 212, 243, 180, 260, 198, 182, 213, 239, 217, 168, 198, 218, 231, 202, 217, 245, 163, 199, 185, 203, 219, 218, 175, 238, 224, 276, 193, 234, 242, 235, 231, 208, 217, 214, 179, 182, 178, 194, 184, 197, 235, 223, 251, 181, 247, 178, 232, 173, 194, 238, 210, 216, 183, 153, 209, 217, 187, 221, 185, 165, 171, 175, 186, 187, 180, 183, 197, 189, 211, 248, 190, 169, 157, 189, 183, 175, 207, 201, 181, 185, 170, 173, 169, 144, 183, 184, 240, 201, 152, 193, 160, 175, 173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24046257841149857, "mean_inference_ms": 0.9667346873927297, "mean_action_processing_ms": 0.08699239068646188, "mean_env_wait_ms": 0.485359604704902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1477.7991781083742, "episode_reward_min": 1043.5518433968837, "episode_reward_mean": 1280.0036086817045, "episode_len_mean": 201.29, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1276.3328074185458, 1333.5230965714327, 1283.3461396465734, 1373.7527049572845, 1327.9194682771563, 1268.550835527652, 1129.404832570991, 1301.3063599826166, 1219.1667479456837, 1145.3553292795295, 1361.7423237113708, 1221.334918690654, 1262.8334355038387, 1211.5799543000212, 1408.5631416141252, 1212.3643337005674, 1122.410788474358, 1281.214948570083, 1296.4971900914322, 1343.0765869186953, 1284.1091538120543, 1310.2211636207314, 1347.655683176703, 1282.3879879109434, 1277.2712713569615, 1191.6069065061452, 1256.189361173435, 1350.4113800933217, 1323.5874634475672, 1202.203004333896, 1385.2486190773795, 1396.9773459042126, 1477.7991781083742, 1251.3319784880084, 1447.1726485441964, 1292.1465505590097, 1259.9824595493142, 1386.2409125302902, 1169.2921059652901, 1331.773347125516, 1265.955344869733, 1184.4970655108211, 1176.6338553714716, 1319.1326874487572, 1353.0106380916664, 1288.3409391079924, 1043.5518433968837, 1467.2829870907997, 1066.652491858401, 1350.7581941024328, 1198.0093339706523, 1393.6810684036966, 1147.8120112549932, 1394.0373385005546, 1187.7714991744538, 1185.1275088930538, 1278.6798545922156, 1243.315478660198, 1376.7588663849524, 1325.9019332880396, 1354.8041596477833, 1207.4773349730733, 1382.8917875932086, 1364.5003809475504, 1328.7070026034162, 1340.6456658653458, 1249.7099783870647, 1307.971468756347, 1332.9019852850151, 1224.878928134705, 1313.4032090833318, 1280.767374593093, 1243.9907182425334, 1336.819950461642, 1251.600265366137, 1133.8910609586421, 1429.8689075667628, 1292.0563090990872, 1296.3813151926809, 1233.553787438131, 1380.928275517352, 1156.751193326198, 1177.6195164150215, 1216.116596442315, 1270.6771828077594, 1243.610295091231, 1369.8705315398863, 1239.2301135678217, 1264.7006898948375, 1295.8564158924414, 1315.1032108293127, 1283.9615879143953, 1254.5754618839328, 1379.1202285037157, 1242.386541367354, 1238.005747730623, 1269.7307784039406, 1276.4434126477215, 1116.0239113243854, 1252.0321818668988], "episode_lengths": [240, 203, 186, 261, 260, 207, 182, 212, 243, 180, 260, 198, 182, 213, 239, 217, 168, 198, 218, 231, 202, 217, 245, 163, 199, 185, 203, 219, 218, 175, 238, 224, 276, 193, 234, 242, 235, 231, 208, 217, 214, 179, 182, 178, 194, 184, 197, 235, 223, 251, 181, 247, 178, 232, 173, 194, 238, 210, 216, 183, 153, 209, 217, 187, 221, 185, 165, 171, 175, 186, 187, 180, 183, 197, 189, 211, 248, 190, 169, 157, 189, 183, 175, 207, 201, 181, 185, 170, 173, 169, 144, 183, 184, 240, 201, 152, 193, 160, 175, 173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24046257841149857, "mean_inference_ms": 0.9667346873927297, "mean_action_processing_ms": 0.08699239068646188, "mean_env_wait_ms": 0.485359604704902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 6935.998, "sample_time_ms": 694.091, "load_time_ms": 0.558, "load_throughput": 7162404.372, "learn_time_ms": 6228.288, "learn_throughput": 642.231, "synch_weights_time_ms": 12.806}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 219, "training_iteration": 13, "trial_id": "2db34_00000", "date": "2023-04-30_16-57-33", "timestamp": 1682848653, "time_this_iter_s": 7.517541408538818, "time_total_s": 90.12901639938354, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 90.12901639938354, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 14.669999999999996, "ram_util_percent": 66.17}}
{"custom_metrics": {"dps_mean": 10708.55382483809, "dps_min": 8696.265361640702, "dps_max": 12347.210913981206}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.4320270071747485, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.841720316486974, "policy_loss": -0.03673722604089367, "vf_loss": 9.872502698180496, "vf_explained_var": 0.015588296036566458, "kl": 0.019849469847195746, "entropy": 1.7199443017282794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 1481.6653096777447, "episode_reward_min": 1043.5518433968837, "episode_reward_mean": 1285.0264589805709, "episode_len_mean": 196.0, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10708.55382483809, "dps_min": 8696.265361640702, "dps_max": 12347.210913981206}, "hist_stats": {"episode_reward": [1310.2211636207314, 1347.655683176703, 1282.3879879109434, 1277.2712713569615, 1191.6069065061452, 1256.189361173435, 1350.4113800933217, 1323.5874634475672, 1202.203004333896, 1385.2486190773795, 1396.9773459042126, 1477.7991781083742, 1251.3319784880084, 1447.1726485441964, 1292.1465505590097, 1259.9824595493142, 1386.2409125302902, 1169.2921059652901, 1331.773347125516, 1265.955344869733, 1184.4970655108211, 1176.6338553714716, 1319.1326874487572, 1353.0106380916664, 1288.3409391079924, 1043.5518433968837, 1467.2829870907997, 1066.652491858401, 1350.7581941024328, 1198.0093339706523, 1393.6810684036966, 1147.8120112549932, 1394.0373385005546, 1187.7714991744538, 1185.1275088930538, 1278.6798545922156, 1243.315478660198, 1376.7588663849524, 1325.9019332880396, 1354.8041596477833, 1207.4773349730733, 1382.8917875932086, 1364.5003809475504, 1328.7070026034162, 1340.6456658653458, 1249.7099783870647, 1307.971468756347, 1332.9019852850151, 1224.878928134705, 1313.4032090833318, 1280.767374593093, 1243.9907182425334, 1336.819950461642, 1251.600265366137, 1133.8910609586421, 1429.8689075667628, 1292.0563090990872, 1296.3813151926809, 1233.553787438131, 1380.928275517352, 1156.751193326198, 1177.6195164150215, 1216.116596442315, 1270.6771828077594, 1243.610295091231, 1369.8705315398863, 1239.2301135678217, 1264.7006898948375, 1295.8564158924414, 1315.1032108293127, 1283.9615879143953, 1254.5754618839328, 1379.1202285037157, 1242.386541367354, 1238.005747730623, 1269.7307784039406, 1276.4434126477215, 1116.0239113243854, 1252.0321818668988, 1251.031412300804, 1349.8835391525859, 1276.158426118958, 1148.8687911782715, 1236.372234068042, 1481.6653096777447, 1188.5871349250797, 1224.9702808698125, 1188.7390898417782, 1301.0703024852291, 1358.4440153361716, 1256.5931982647262, 1345.2003534295825, 1291.654745182814, 1326.3727320168098, 1365.1705892935197, 1304.1917926327578, 1256.5917646185317, 1376.361992819502, 1446.8219996706835, 1191.9204235679244], "episode_lengths": [217, 245, 163, 199, 185, 203, 219, 218, 175, 238, 224, 276, 193, 234, 242, 235, 231, 208, 217, 214, 179, 182, 178, 194, 184, 197, 235, 223, 251, 181, 247, 178, 232, 173, 194, 238, 210, 216, 183, 153, 209, 217, 187, 221, 185, 165, 171, 175, 186, 187, 180, 183, 197, 189, 211, 248, 190, 169, 157, 189, 183, 175, 207, 201, 181, 185, 170, 173, 169, 144, 183, 184, 240, 201, 152, 193, 160, 175, 173, 177, 195, 193, 161, 184, 215, 180, 192, 165, 218, 199, 180, 200, 195, 189, 178, 212, 184, 211, 189, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24185676616215368, "mean_inference_ms": 0.9725978099742508, "mean_action_processing_ms": 0.08745856913638576, "mean_env_wait_ms": 0.4890588769320184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1481.6653096777447, "episode_reward_min": 1043.5518433968837, "episode_reward_mean": 1285.0264589805709, "episode_len_mean": 196.0, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1310.2211636207314, 1347.655683176703, 1282.3879879109434, 1277.2712713569615, 1191.6069065061452, 1256.189361173435, 1350.4113800933217, 1323.5874634475672, 1202.203004333896, 1385.2486190773795, 1396.9773459042126, 1477.7991781083742, 1251.3319784880084, 1447.1726485441964, 1292.1465505590097, 1259.9824595493142, 1386.2409125302902, 1169.2921059652901, 1331.773347125516, 1265.955344869733, 1184.4970655108211, 1176.6338553714716, 1319.1326874487572, 1353.0106380916664, 1288.3409391079924, 1043.5518433968837, 1467.2829870907997, 1066.652491858401, 1350.7581941024328, 1198.0093339706523, 1393.6810684036966, 1147.8120112549932, 1394.0373385005546, 1187.7714991744538, 1185.1275088930538, 1278.6798545922156, 1243.315478660198, 1376.7588663849524, 1325.9019332880396, 1354.8041596477833, 1207.4773349730733, 1382.8917875932086, 1364.5003809475504, 1328.7070026034162, 1340.6456658653458, 1249.7099783870647, 1307.971468756347, 1332.9019852850151, 1224.878928134705, 1313.4032090833318, 1280.767374593093, 1243.9907182425334, 1336.819950461642, 1251.600265366137, 1133.8910609586421, 1429.8689075667628, 1292.0563090990872, 1296.3813151926809, 1233.553787438131, 1380.928275517352, 1156.751193326198, 1177.6195164150215, 1216.116596442315, 1270.6771828077594, 1243.610295091231, 1369.8705315398863, 1239.2301135678217, 1264.7006898948375, 1295.8564158924414, 1315.1032108293127, 1283.9615879143953, 1254.5754618839328, 1379.1202285037157, 1242.386541367354, 1238.005747730623, 1269.7307784039406, 1276.4434126477215, 1116.0239113243854, 1252.0321818668988, 1251.031412300804, 1349.8835391525859, 1276.158426118958, 1148.8687911782715, 1236.372234068042, 1481.6653096777447, 1188.5871349250797, 1224.9702808698125, 1188.7390898417782, 1301.0703024852291, 1358.4440153361716, 1256.5931982647262, 1345.2003534295825, 1291.654745182814, 1326.3727320168098, 1365.1705892935197, 1304.1917926327578, 1256.5917646185317, 1376.361992819502, 1446.8219996706835, 1191.9204235679244], "episode_lengths": [217, 245, 163, 199, 185, 203, 219, 218, 175, 238, 224, 276, 193, 234, 242, 235, 231, 208, 217, 214, 179, 182, 178, 194, 184, 197, 235, 223, 251, 181, 247, 178, 232, 173, 194, 238, 210, 216, 183, 153, 209, 217, 187, 221, 185, 165, 171, 175, 186, 187, 180, 183, 197, 189, 211, 248, 190, 169, 157, 189, 183, 175, 207, 201, 181, 185, 170, 173, 169, 144, 183, 184, 240, 201, 152, 193, 160, 175, 173, 177, 195, 193, 161, 184, 215, 180, 192, 165, 218, 199, 180, 200, 195, 189, 178, 212, 184, 211, 189, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24185676616215368, "mean_inference_ms": 0.9725978099742508, "mean_action_processing_ms": 0.08745856913638576, "mean_env_wait_ms": 0.4890588769320184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 7002.451, "sample_time_ms": 706.759, "load_time_ms": 0.605, "load_throughput": 6610668.663, "learn_time_ms": 6281.873, "learn_throughput": 636.753, "synch_weights_time_ms": 12.958}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 240, "training_iteration": 14, "trial_id": "2db34_00000", "date": "2023-04-30_16-57-41", "timestamp": 1682848661, "time_this_iter_s": 7.391039848327637, "time_total_s": 97.52005624771118, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 97.52005624771118, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 11.029999999999998, "ram_util_percent": 67.09}}
{"custom_metrics": {"dps_mean": 10613.677921971257, "dps_min": 8696.265361640702, "dps_max": 12471.922451728668}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.48004133605188, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.835490295451175, "policy_loss": -0.03834180541797191, "vf_loss": 9.869158161327404, "vf_explained_var": 0.014504871060771326, "kl": 0.015579835374970596, "entropy": 1.655254525523032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 1496.6306942074393, "episode_reward_min": 1043.5518433968837, "episode_reward_mean": 1273.6413506365504, "episode_len_mean": 188.05, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10613.677921971257, "dps_min": 8696.265361640702, "dps_max": 12471.922451728668}, "hist_stats": {"episode_reward": [1353.0106380916664, 1288.3409391079924, 1043.5518433968837, 1467.2829870907997, 1066.652491858401, 1350.7581941024328, 1198.0093339706523, 1393.6810684036966, 1147.8120112549932, 1394.0373385005546, 1187.7714991744538, 1185.1275088930538, 1278.6798545922156, 1243.315478660198, 1376.7588663849524, 1325.9019332880396, 1354.8041596477833, 1207.4773349730733, 1382.8917875932086, 1364.5003809475504, 1328.7070026034162, 1340.6456658653458, 1249.7099783870647, 1307.971468756347, 1332.9019852850151, 1224.878928134705, 1313.4032090833318, 1280.767374593093, 1243.9907182425334, 1336.819950461642, 1251.600265366137, 1133.8910609586421, 1429.8689075667628, 1292.0563090990872, 1296.3813151926809, 1233.553787438131, 1380.928275517352, 1156.751193326198, 1177.6195164150215, 1216.116596442315, 1270.6771828077594, 1243.610295091231, 1369.8705315398863, 1239.2301135678217, 1264.7006898948375, 1295.8564158924414, 1315.1032108293127, 1283.9615879143953, 1254.5754618839328, 1379.1202285037157, 1242.386541367354, 1238.005747730623, 1269.7307784039406, 1276.4434126477215, 1116.0239113243854, 1252.0321818668988, 1251.031412300804, 1349.8835391525859, 1276.158426118958, 1148.8687911782715, 1236.372234068042, 1481.6653096777447, 1188.5871349250797, 1224.9702808698125, 1188.7390898417782, 1301.0703024852291, 1358.4440153361716, 1256.5931982647262, 1345.2003534295825, 1291.654745182814, 1326.3727320168098, 1365.1705892935197, 1304.1917926327578, 1256.5917646185317, 1376.361992819502, 1446.8219996706835, 1191.9204235679244, 1238.008954201374, 1352.962162868508, 1428.2810064970345, 1238.1666089982632, 1317.0582029506177, 1337.4919526763433, 1249.8679513057195, 1308.1824295064462, 1156.1636633743622, 1265.6348160814366, 1161.1743654429863, 1131.9795011208225, 1312.792835317401, 1120.2067913989774, 1496.6306942074393, 1236.703851403786, 1348.0405626067159, 1230.8172359672044, 1085.7355480407075, 1098.5910985165015, 1175.5749531137437, 1212.8093952879995, 1244.3329053856485], "episode_lengths": [194, 184, 197, 235, 223, 251, 181, 247, 178, 232, 173, 194, 238, 210, 216, 183, 153, 209, 217, 187, 221, 185, 165, 171, 175, 186, 187, 180, 183, 197, 189, 211, 248, 190, 169, 157, 189, 183, 175, 207, 201, 181, 185, 170, 173, 169, 144, 183, 184, 240, 201, 152, 193, 160, 175, 173, 177, 195, 193, 161, 184, 215, 180, 192, 165, 218, 199, 180, 200, 195, 189, 178, 212, 184, 211, 189, 154, 180, 193, 199, 178, 195, 180, 192, 196, 139, 172, 154, 180, 157, 156, 254, 188, 197, 159, 140, 157, 167, 167, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2433638075393312, "mean_inference_ms": 0.977769277113016, "mean_action_processing_ms": 0.08771888123625089, "mean_env_wait_ms": 0.492163782221496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1496.6306942074393, "episode_reward_min": 1043.5518433968837, "episode_reward_mean": 1273.6413506365504, "episode_len_mean": 188.05, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1353.0106380916664, 1288.3409391079924, 1043.5518433968837, 1467.2829870907997, 1066.652491858401, 1350.7581941024328, 1198.0093339706523, 1393.6810684036966, 1147.8120112549932, 1394.0373385005546, 1187.7714991744538, 1185.1275088930538, 1278.6798545922156, 1243.315478660198, 1376.7588663849524, 1325.9019332880396, 1354.8041596477833, 1207.4773349730733, 1382.8917875932086, 1364.5003809475504, 1328.7070026034162, 1340.6456658653458, 1249.7099783870647, 1307.971468756347, 1332.9019852850151, 1224.878928134705, 1313.4032090833318, 1280.767374593093, 1243.9907182425334, 1336.819950461642, 1251.600265366137, 1133.8910609586421, 1429.8689075667628, 1292.0563090990872, 1296.3813151926809, 1233.553787438131, 1380.928275517352, 1156.751193326198, 1177.6195164150215, 1216.116596442315, 1270.6771828077594, 1243.610295091231, 1369.8705315398863, 1239.2301135678217, 1264.7006898948375, 1295.8564158924414, 1315.1032108293127, 1283.9615879143953, 1254.5754618839328, 1379.1202285037157, 1242.386541367354, 1238.005747730623, 1269.7307784039406, 1276.4434126477215, 1116.0239113243854, 1252.0321818668988, 1251.031412300804, 1349.8835391525859, 1276.158426118958, 1148.8687911782715, 1236.372234068042, 1481.6653096777447, 1188.5871349250797, 1224.9702808698125, 1188.7390898417782, 1301.0703024852291, 1358.4440153361716, 1256.5931982647262, 1345.2003534295825, 1291.654745182814, 1326.3727320168098, 1365.1705892935197, 1304.1917926327578, 1256.5917646185317, 1376.361992819502, 1446.8219996706835, 1191.9204235679244, 1238.008954201374, 1352.962162868508, 1428.2810064970345, 1238.1666089982632, 1317.0582029506177, 1337.4919526763433, 1249.8679513057195, 1308.1824295064462, 1156.1636633743622, 1265.6348160814366, 1161.1743654429863, 1131.9795011208225, 1312.792835317401, 1120.2067913989774, 1496.6306942074393, 1236.703851403786, 1348.0405626067159, 1230.8172359672044, 1085.7355480407075, 1098.5910985165015, 1175.5749531137437, 1212.8093952879995, 1244.3329053856485], "episode_lengths": [194, 184, 197, 235, 223, 251, 181, 247, 178, 232, 173, 194, 238, 210, 216, 183, 153, 209, 217, 187, 221, 185, 165, 171, 175, 186, 187, 180, 183, 197, 189, 211, 248, 190, 169, 157, 189, 183, 175, 207, 201, 181, 185, 170, 173, 169, 144, 183, 184, 240, 201, 152, 193, 160, 175, 173, 177, 195, 193, 161, 184, 215, 180, 192, 165, 218, 199, 180, 200, 195, 189, 178, 212, 184, 211, 189, 154, 180, 193, 199, 178, 195, 180, 192, 196, 139, 172, 154, 180, 157, 156, 254, 188, 197, 159, 140, 157, 167, 167, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2433638075393312, "mean_inference_ms": 0.977769277113016, "mean_action_processing_ms": 0.08771888123625089, "mean_env_wait_ms": 0.492163782221496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 7032.628, "sample_time_ms": 709.192, "load_time_ms": 0.605, "load_throughput": 6610668.663, "learn_time_ms": 6309.518, "learn_throughput": 633.963, "synch_weights_time_ms": 13.058}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 263, "training_iteration": 15, "trial_id": "2db34_00000", "date": "2023-04-30_16-57-48", "timestamp": 1682848668, "time_this_iter_s": 7.042868375778198, "time_total_s": 104.56292462348938, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 104.56292462348938, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 9.400000000000002, "ram_util_percent": 67.32}}
{"custom_metrics": {"dps_mean": 10626.800253665338, "dps_min": 9047.796233672561, "dps_max": 12471.922451728668}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.291260600987301, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.853019775882844, "policy_loss": -0.0318930271151726, "vf_loss": 9.879251807223085, "vf_explained_var": 0.01971930823018474, "kl": 0.018870013792089142, "entropy": 1.6854553472611211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 1496.6306942074393, "episode_reward_min": 1085.7355480407075, "episode_reward_mean": 1275.2160304398408, "episode_len_mean": 184.8, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10626.800253665338, "dps_min": 9047.796233672561, "dps_max": 12471.922451728668}, "hist_stats": {"episode_reward": [1249.7099783870647, 1307.971468756347, 1332.9019852850151, 1224.878928134705, 1313.4032090833318, 1280.767374593093, 1243.9907182425334, 1336.819950461642, 1251.600265366137, 1133.8910609586421, 1429.8689075667628, 1292.0563090990872, 1296.3813151926809, 1233.553787438131, 1380.928275517352, 1156.751193326198, 1177.6195164150215, 1216.116596442315, 1270.6771828077594, 1243.610295091231, 1369.8705315398863, 1239.2301135678217, 1264.7006898948375, 1295.8564158924414, 1315.1032108293127, 1283.9615879143953, 1254.5754618839328, 1379.1202285037157, 1242.386541367354, 1238.005747730623, 1269.7307784039406, 1276.4434126477215, 1116.0239113243854, 1252.0321818668988, 1251.031412300804, 1349.8835391525859, 1276.158426118958, 1148.8687911782715, 1236.372234068042, 1481.6653096777447, 1188.5871349250797, 1224.9702808698125, 1188.7390898417782, 1301.0703024852291, 1358.4440153361716, 1256.5931982647262, 1345.2003534295825, 1291.654745182814, 1326.3727320168098, 1365.1705892935197, 1304.1917926327578, 1256.5917646185317, 1376.361992819502, 1446.8219996706835, 1191.9204235679244, 1238.008954201374, 1352.962162868508, 1428.2810064970345, 1238.1666089982632, 1317.0582029506177, 1337.4919526763433, 1249.8679513057195, 1308.1824295064462, 1156.1636633743622, 1265.6348160814366, 1161.1743654429863, 1131.9795011208225, 1312.792835317401, 1120.2067913989774, 1496.6306942074393, 1236.703851403786, 1348.0405626067159, 1230.8172359672044, 1085.7355480407075, 1098.5910985165015, 1175.5749531137437, 1212.8093952879995, 1244.3329053856485, 1237.4863754021067, 1303.3012215762826, 1268.8113686947618, 1187.0347742646877, 1163.739717329773, 1347.9721633562579, 1267.0959700607204, 1348.5869115945648, 1441.340771815016, 1328.6334774992984, 1366.5713230130832, 1241.8475127835266, 1336.1250663097492, 1366.9184056792642, 1143.7010267497906, 1420.6845116065629, 1224.2275243878803, 1220.1425410162094, 1293.459927763599, 1293.8924257244817, 1366.1211812259305, 1269.4921008768379], "episode_lengths": [165, 171, 175, 186, 187, 180, 183, 197, 189, 211, 248, 190, 169, 157, 189, 183, 175, 207, 201, 181, 185, 170, 173, 169, 144, 183, 184, 240, 201, 152, 193, 160, 175, 173, 177, 195, 193, 161, 184, 215, 180, 192, 165, 218, 199, 180, 200, 195, 189, 178, 212, 184, 211, 189, 154, 180, 193, 199, 178, 195, 180, 192, 196, 139, 172, 154, 180, 157, 156, 254, 188, 197, 159, 140, 157, 167, 167, 180, 176, 216, 194, 183, 136, 202, 198, 204, 229, 192, 198, 191, 183, 204, 167, 200, 178, 167, 191, 176, 197, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24474292854352997, "mean_inference_ms": 0.9820247719263105, "mean_action_processing_ms": 0.08785319189880121, "mean_env_wait_ms": 0.4945032595268924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1496.6306942074393, "episode_reward_min": 1085.7355480407075, "episode_reward_mean": 1275.2160304398408, "episode_len_mean": 184.8, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1249.7099783870647, 1307.971468756347, 1332.9019852850151, 1224.878928134705, 1313.4032090833318, 1280.767374593093, 1243.9907182425334, 1336.819950461642, 1251.600265366137, 1133.8910609586421, 1429.8689075667628, 1292.0563090990872, 1296.3813151926809, 1233.553787438131, 1380.928275517352, 1156.751193326198, 1177.6195164150215, 1216.116596442315, 1270.6771828077594, 1243.610295091231, 1369.8705315398863, 1239.2301135678217, 1264.7006898948375, 1295.8564158924414, 1315.1032108293127, 1283.9615879143953, 1254.5754618839328, 1379.1202285037157, 1242.386541367354, 1238.005747730623, 1269.7307784039406, 1276.4434126477215, 1116.0239113243854, 1252.0321818668988, 1251.031412300804, 1349.8835391525859, 1276.158426118958, 1148.8687911782715, 1236.372234068042, 1481.6653096777447, 1188.5871349250797, 1224.9702808698125, 1188.7390898417782, 1301.0703024852291, 1358.4440153361716, 1256.5931982647262, 1345.2003534295825, 1291.654745182814, 1326.3727320168098, 1365.1705892935197, 1304.1917926327578, 1256.5917646185317, 1376.361992819502, 1446.8219996706835, 1191.9204235679244, 1238.008954201374, 1352.962162868508, 1428.2810064970345, 1238.1666089982632, 1317.0582029506177, 1337.4919526763433, 1249.8679513057195, 1308.1824295064462, 1156.1636633743622, 1265.6348160814366, 1161.1743654429863, 1131.9795011208225, 1312.792835317401, 1120.2067913989774, 1496.6306942074393, 1236.703851403786, 1348.0405626067159, 1230.8172359672044, 1085.7355480407075, 1098.5910985165015, 1175.5749531137437, 1212.8093952879995, 1244.3329053856485, 1237.4863754021067, 1303.3012215762826, 1268.8113686947618, 1187.0347742646877, 1163.739717329773, 1347.9721633562579, 1267.0959700607204, 1348.5869115945648, 1441.340771815016, 1328.6334774992984, 1366.5713230130832, 1241.8475127835266, 1336.1250663097492, 1366.9184056792642, 1143.7010267497906, 1420.6845116065629, 1224.2275243878803, 1220.1425410162094, 1293.459927763599, 1293.8924257244817, 1366.1211812259305, 1269.4921008768379], "episode_lengths": [165, 171, 175, 186, 187, 180, 183, 197, 189, 211, 248, 190, 169, 157, 189, 183, 175, 207, 201, 181, 185, 170, 173, 169, 144, 183, 184, 240, 201, 152, 193, 160, 175, 173, 177, 195, 193, 161, 184, 215, 180, 192, 165, 218, 199, 180, 200, 195, 189, 178, 212, 184, 211, 189, 154, 180, 193, 199, 178, 195, 180, 192, 196, 139, 172, 154, 180, 157, 156, 254, 188, 197, 159, 140, 157, 167, 167, 180, 176, 216, 194, 183, 136, 202, 198, 204, 229, 192, 198, 191, 183, 204, 167, 200, 178, 167, 191, 176, 197, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24474292854352997, "mean_inference_ms": 0.9820247719263105, "mean_action_processing_ms": 0.08785319189880121, "mean_env_wait_ms": 0.4945032595268924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 7056.783, "sample_time_ms": 718.113, "load_time_ms": 0.605, "load_throughput": 6610668.663, "learn_time_ms": 6324.707, "learn_throughput": 632.44, "synch_weights_time_ms": 12.958}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 285, "training_iteration": 16, "trial_id": "2db34_00000", "date": "2023-04-30_16-57-55", "timestamp": 1682848675, "time_this_iter_s": 7.074783563613892, "time_total_s": 111.63770818710327, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 111.63770818710327, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 10.029999999999998, "ram_util_percent": 67.24000000000001}}
{"custom_metrics": {"dps_mean": 10623.232887072307, "dps_min": 9047.796233672561, "dps_max": 12471.922451728668}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.054051928622748, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.818717836564588, "policy_loss": -0.029941555914739446, "vf_loss": 9.84443384806315, "vf_explained_var": 0.0082748604718075, "kl": 0.01408507909856685, "entropy": 1.62689586570186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 1496.6306942074393, "episode_reward_min": 1085.7355480407075, "episode_reward_mean": 1274.7879464486766, "episode_len_mean": 184.02, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10623.232887072307, "dps_min": 9047.796233672561, "dps_max": 12471.922451728668}, "hist_stats": {"episode_reward": [1239.2301135678217, 1264.7006898948375, 1295.8564158924414, 1315.1032108293127, 1283.9615879143953, 1254.5754618839328, 1379.1202285037157, 1242.386541367354, 1238.005747730623, 1269.7307784039406, 1276.4434126477215, 1116.0239113243854, 1252.0321818668988, 1251.031412300804, 1349.8835391525859, 1276.158426118958, 1148.8687911782715, 1236.372234068042, 1481.6653096777447, 1188.5871349250797, 1224.9702808698125, 1188.7390898417782, 1301.0703024852291, 1358.4440153361716, 1256.5931982647262, 1345.2003534295825, 1291.654745182814, 1326.3727320168098, 1365.1705892935197, 1304.1917926327578, 1256.5917646185317, 1376.361992819502, 1446.8219996706835, 1191.9204235679244, 1238.008954201374, 1352.962162868508, 1428.2810064970345, 1238.1666089982632, 1317.0582029506177, 1337.4919526763433, 1249.8679513057195, 1308.1824295064462, 1156.1636633743622, 1265.6348160814366, 1161.1743654429863, 1131.9795011208225, 1312.792835317401, 1120.2067913989774, 1496.6306942074393, 1236.703851403786, 1348.0405626067159, 1230.8172359672044, 1085.7355480407075, 1098.5910985165015, 1175.5749531137437, 1212.8093952879995, 1244.3329053856485, 1237.4863754021067, 1303.3012215762826, 1268.8113686947618, 1187.0347742646877, 1163.739717329773, 1347.9721633562579, 1267.0959700607204, 1348.5869115945648, 1441.340771815016, 1328.6334774992984, 1366.5713230130832, 1241.8475127835266, 1336.1250663097492, 1366.9184056792642, 1143.7010267497906, 1420.6845116065629, 1224.2275243878803, 1220.1425410162094, 1293.459927763599, 1293.8924257244817, 1366.1211812259305, 1269.4921008768379, 1307.4953075350384, 1298.9306954872798, 1215.0613790723003, 1229.946216617713, 1349.7751382530164, 1281.0936306081885, 1329.7438573213683, 1192.4205165367573, 1319.8507824539392, 1234.9428584047153, 1333.1075197135835, 1168.490654019498, 1195.302235074631, 1264.7500076272065, 1473.9360471830198, 1256.4913582255704, 1427.800614965638, 1153.8216925806964, 1125.9193909334451, 1259.1652391168668, 1282.515308858069], "episode_lengths": [170, 173, 169, 144, 183, 184, 240, 201, 152, 193, 160, 175, 173, 177, 195, 193, 161, 184, 215, 180, 192, 165, 218, 199, 180, 200, 195, 189, 178, 212, 184, 211, 189, 154, 180, 193, 199, 178, 195, 180, 192, 196, 139, 172, 154, 180, 157, 156, 254, 188, 197, 159, 140, 157, 167, 167, 180, 176, 216, 194, 183, 136, 202, 198, 204, 229, 192, 198, 191, 183, 204, 167, 200, 178, 167, 191, 176, 197, 201, 175, 170, 179, 172, 216, 183, 208, 155, 208, 179, 236, 170, 163, 199, 216, 167, 221, 153, 145, 169, 167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24609268622739072, "mean_inference_ms": 0.9845337177163479, "mean_action_processing_ms": 0.08799449796870473, "mean_env_wait_ms": 0.49606668267906445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1496.6306942074393, "episode_reward_min": 1085.7355480407075, "episode_reward_mean": 1274.7879464486766, "episode_len_mean": 184.02, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1239.2301135678217, 1264.7006898948375, 1295.8564158924414, 1315.1032108293127, 1283.9615879143953, 1254.5754618839328, 1379.1202285037157, 1242.386541367354, 1238.005747730623, 1269.7307784039406, 1276.4434126477215, 1116.0239113243854, 1252.0321818668988, 1251.031412300804, 1349.8835391525859, 1276.158426118958, 1148.8687911782715, 1236.372234068042, 1481.6653096777447, 1188.5871349250797, 1224.9702808698125, 1188.7390898417782, 1301.0703024852291, 1358.4440153361716, 1256.5931982647262, 1345.2003534295825, 1291.654745182814, 1326.3727320168098, 1365.1705892935197, 1304.1917926327578, 1256.5917646185317, 1376.361992819502, 1446.8219996706835, 1191.9204235679244, 1238.008954201374, 1352.962162868508, 1428.2810064970345, 1238.1666089982632, 1317.0582029506177, 1337.4919526763433, 1249.8679513057195, 1308.1824295064462, 1156.1636633743622, 1265.6348160814366, 1161.1743654429863, 1131.9795011208225, 1312.792835317401, 1120.2067913989774, 1496.6306942074393, 1236.703851403786, 1348.0405626067159, 1230.8172359672044, 1085.7355480407075, 1098.5910985165015, 1175.5749531137437, 1212.8093952879995, 1244.3329053856485, 1237.4863754021067, 1303.3012215762826, 1268.8113686947618, 1187.0347742646877, 1163.739717329773, 1347.9721633562579, 1267.0959700607204, 1348.5869115945648, 1441.340771815016, 1328.6334774992984, 1366.5713230130832, 1241.8475127835266, 1336.1250663097492, 1366.9184056792642, 1143.7010267497906, 1420.6845116065629, 1224.2275243878803, 1220.1425410162094, 1293.459927763599, 1293.8924257244817, 1366.1211812259305, 1269.4921008768379, 1307.4953075350384, 1298.9306954872798, 1215.0613790723003, 1229.946216617713, 1349.7751382530164, 1281.0936306081885, 1329.7438573213683, 1192.4205165367573, 1319.8507824539392, 1234.9428584047153, 1333.1075197135835, 1168.490654019498, 1195.302235074631, 1264.7500076272065, 1473.9360471830198, 1256.4913582255704, 1427.800614965638, 1153.8216925806964, 1125.9193909334451, 1259.1652391168668, 1282.515308858069], "episode_lengths": [170, 173, 169, 144, 183, 184, 240, 201, 152, 193, 160, 175, 173, 177, 195, 193, 161, 184, 215, 180, 192, 165, 218, 199, 180, 200, 195, 189, 178, 212, 184, 211, 189, 154, 180, 193, 199, 178, 195, 180, 192, 196, 139, 172, 154, 180, 157, 156, 254, 188, 197, 159, 140, 157, 167, 167, 180, 176, 216, 194, 183, 136, 202, 198, 204, 229, 192, 198, 191, 183, 204, 167, 200, 178, 167, 191, 176, 197, 201, 175, 170, 179, 172, 216, 183, 208, 155, 208, 179, 236, 170, 163, 199, 216, 167, 221, 153, 145, 169, 167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24609268622739072, "mean_inference_ms": 0.9845337177163479, "mean_action_processing_ms": 0.08799449796870473, "mean_env_wait_ms": 0.49606668267906445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 7058.872, "sample_time_ms": 707.609, "load_time_ms": 0.605, "load_throughput": 6614317.366, "learn_time_ms": 6337.107, "learn_throughput": 631.203, "synch_weights_time_ms": 13.151}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 306, "training_iteration": 17, "trial_id": "2db34_00000", "date": "2023-04-30_16-58-02", "timestamp": 1682848682, "time_this_iter_s": 7.105838775634766, "time_total_s": 118.74354696273804, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 118.74354696273804, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 10.03, "ram_util_percent": 67.15}}
{"custom_metrics": {"dps_mean": 10844.041924044914, "dps_min": 9047.796233672561, "dps_max": 14233.467659385524}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.68490386874445, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.839140828450521, "policy_loss": -0.02684190693481635, "vf_loss": 9.863253974914551, "vf_explained_var": 0.01001744661279904, "kl": 0.00909592802493566, "entropy": 1.678655288168179, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 1708.0161191262616, "episode_reward_min": 1085.7355480407075, "episode_reward_mean": 1301.2850308853895, "episode_len_mean": 187.93, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10844.041924044914, "dps_min": 9047.796233672561, "dps_max": 14233.467659385524}, "hist_stats": {"episode_reward": [1188.5871349250797, 1224.9702808698125, 1188.7390898417782, 1301.0703024852291, 1358.4440153361716, 1256.5931982647262, 1345.2003534295825, 1291.654745182814, 1326.3727320168098, 1365.1705892935197, 1304.1917926327578, 1256.5917646185317, 1376.361992819502, 1446.8219996706835, 1191.9204235679244, 1238.008954201374, 1352.962162868508, 1428.2810064970345, 1238.1666089982632, 1317.0582029506177, 1337.4919526763433, 1249.8679513057195, 1308.1824295064462, 1156.1636633743622, 1265.6348160814366, 1161.1743654429863, 1131.9795011208225, 1312.792835317401, 1120.2067913989774, 1496.6306942074393, 1236.703851403786, 1348.0405626067159, 1230.8172359672044, 1085.7355480407075, 1098.5910985165015, 1175.5749531137437, 1212.8093952879995, 1244.3329053856485, 1237.4863754021067, 1303.3012215762826, 1268.8113686947618, 1187.0347742646877, 1163.739717329773, 1347.9721633562579, 1267.0959700607204, 1348.5869115945648, 1441.340771815016, 1328.6334774992984, 1366.5713230130832, 1241.8475127835266, 1336.1250663097492, 1366.9184056792642, 1143.7010267497906, 1420.6845116065629, 1224.2275243878803, 1220.1425410162094, 1293.459927763599, 1293.8924257244817, 1366.1211812259305, 1269.4921008768379, 1307.4953075350384, 1298.9306954872798, 1215.0613790723003, 1229.946216617713, 1349.7751382530164, 1281.0936306081885, 1329.7438573213683, 1192.4205165367573, 1319.8507824539392, 1234.9428584047153, 1333.1075197135835, 1168.490654019498, 1195.302235074631, 1264.7500076272065, 1473.9360471830198, 1256.4913582255704, 1427.800614965638, 1153.8216925806964, 1125.9193909334451, 1259.1652391168668, 1282.515308858069, 1393.0912638908378, 1511.9624106815527, 1474.1653725319954, 1310.807535602241, 1426.9045101758006, 1299.956717987438, 1327.536226362544, 1349.7459651819415, 1335.1806265385267, 1456.1092339780498, 1456.5599537627102, 1399.0529209722347, 1331.0040605352315, 1417.7240047978562, 1253.662065318633, 1708.0161191262616, 1371.9708338001133, 1458.3763097245633, 1539.032307026545], "episode_lengths": [180, 192, 165, 218, 199, 180, 200, 195, 189, 178, 212, 184, 211, 189, 154, 180, 193, 199, 178, 195, 180, 192, 196, 139, 172, 154, 180, 157, 156, 254, 188, 197, 159, 140, 157, 167, 167, 180, 176, 216, 194, 183, 136, 202, 198, 204, 229, 192, 198, 191, 183, 204, 167, 200, 178, 167, 191, 176, 197, 201, 175, 170, 179, 172, 216, 183, 208, 155, 208, 179, 236, 170, 163, 199, 216, 167, 221, 153, 145, 169, 167, 202, 227, 227, 163, 217, 181, 183, 176, 187, 202, 224, 210, 208, 209, 183, 217, 214, 197, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24691577563281825, "mean_inference_ms": 0.984742689124237, "mean_action_processing_ms": 0.08795692363805252, "mean_env_wait_ms": 0.49632538347494226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1708.0161191262616, "episode_reward_min": 1085.7355480407075, "episode_reward_mean": 1301.2850308853895, "episode_len_mean": 187.93, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1188.5871349250797, 1224.9702808698125, 1188.7390898417782, 1301.0703024852291, 1358.4440153361716, 1256.5931982647262, 1345.2003534295825, 1291.654745182814, 1326.3727320168098, 1365.1705892935197, 1304.1917926327578, 1256.5917646185317, 1376.361992819502, 1446.8219996706835, 1191.9204235679244, 1238.008954201374, 1352.962162868508, 1428.2810064970345, 1238.1666089982632, 1317.0582029506177, 1337.4919526763433, 1249.8679513057195, 1308.1824295064462, 1156.1636633743622, 1265.6348160814366, 1161.1743654429863, 1131.9795011208225, 1312.792835317401, 1120.2067913989774, 1496.6306942074393, 1236.703851403786, 1348.0405626067159, 1230.8172359672044, 1085.7355480407075, 1098.5910985165015, 1175.5749531137437, 1212.8093952879995, 1244.3329053856485, 1237.4863754021067, 1303.3012215762826, 1268.8113686947618, 1187.0347742646877, 1163.739717329773, 1347.9721633562579, 1267.0959700607204, 1348.5869115945648, 1441.340771815016, 1328.6334774992984, 1366.5713230130832, 1241.8475127835266, 1336.1250663097492, 1366.9184056792642, 1143.7010267497906, 1420.6845116065629, 1224.2275243878803, 1220.1425410162094, 1293.459927763599, 1293.8924257244817, 1366.1211812259305, 1269.4921008768379, 1307.4953075350384, 1298.9306954872798, 1215.0613790723003, 1229.946216617713, 1349.7751382530164, 1281.0936306081885, 1329.7438573213683, 1192.4205165367573, 1319.8507824539392, 1234.9428584047153, 1333.1075197135835, 1168.490654019498, 1195.302235074631, 1264.7500076272065, 1473.9360471830198, 1256.4913582255704, 1427.800614965638, 1153.8216925806964, 1125.9193909334451, 1259.1652391168668, 1282.515308858069, 1393.0912638908378, 1511.9624106815527, 1474.1653725319954, 1310.807535602241, 1426.9045101758006, 1299.956717987438, 1327.536226362544, 1349.7459651819415, 1335.1806265385267, 1456.1092339780498, 1456.5599537627102, 1399.0529209722347, 1331.0040605352315, 1417.7240047978562, 1253.662065318633, 1708.0161191262616, 1371.9708338001133, 1458.3763097245633, 1539.032307026545], "episode_lengths": [180, 192, 165, 218, 199, 180, 200, 195, 189, 178, 212, 184, 211, 189, 154, 180, 193, 199, 178, 195, 180, 192, 196, 139, 172, 154, 180, 157, 156, 254, 188, 197, 159, 140, 157, 167, 167, 180, 176, 216, 194, 183, 136, 202, 198, 204, 229, 192, 198, 191, 183, 204, 167, 200, 178, 167, 191, 176, 197, 201, 175, 170, 179, 172, 216, 183, 208, 155, 208, 179, 236, 170, 163, 199, 216, 167, 221, 153, 145, 169, 167, 202, 227, 227, 163, 217, 181, 183, 176, 187, 202, 224, 210, 208, 209, 183, 217, 214, 197, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24691577563281825, "mean_inference_ms": 0.984742689124237, "mean_action_processing_ms": 0.08795692363805252, "mean_env_wait_ms": 0.49632538347494226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 7081.651, "sample_time_ms": 709.201, "load_time_ms": 0.702, "load_throughput": 5700912.705, "learn_time_ms": 6358.192, "learn_throughput": 629.11, "synch_weights_time_ms": 13.056}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 325, "training_iteration": 18, "trial_id": "2db34_00000", "date": "2023-04-30_16-58-09", "timestamp": 1682848689, "time_this_iter_s": 7.064538955688477, "time_total_s": 125.80808591842651, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 125.80808591842651, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 10.030000000000001, "ram_util_percent": 67.30999999999999}}
{"custom_metrics": {"dps_mean": 10939.666527433514, "dps_min": 9047.796233672561, "dps_max": 14233.467659385524}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.818677101276254, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.865509332636352, "policy_loss": -0.03253698734145972, "vf_loss": 9.89393059515184, "vf_explained_var": 0.008348597698314215, "kl": 0.013719117937502606, "entropy": 1.6465303847866675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 1708.0161191262616, "episode_reward_min": 1085.7355480407075, "episode_reward_mean": 1312.7599832920214, "episode_len_mean": 189.59, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10939.666527433514, "dps_min": 9047.796233672561, "dps_max": 14233.467659385524}, "hist_stats": {"episode_reward": [1238.1666089982632, 1317.0582029506177, 1337.4919526763433, 1249.8679513057195, 1308.1824295064462, 1156.1636633743622, 1265.6348160814366, 1161.1743654429863, 1131.9795011208225, 1312.792835317401, 1120.2067913989774, 1496.6306942074393, 1236.703851403786, 1348.0405626067159, 1230.8172359672044, 1085.7355480407075, 1098.5910985165015, 1175.5749531137437, 1212.8093952879995, 1244.3329053856485, 1237.4863754021067, 1303.3012215762826, 1268.8113686947618, 1187.0347742646877, 1163.739717329773, 1347.9721633562579, 1267.0959700607204, 1348.5869115945648, 1441.340771815016, 1328.6334774992984, 1366.5713230130832, 1241.8475127835266, 1336.1250663097492, 1366.9184056792642, 1143.7010267497906, 1420.6845116065629, 1224.2275243878803, 1220.1425410162094, 1293.459927763599, 1293.8924257244817, 1366.1211812259305, 1269.4921008768379, 1307.4953075350384, 1298.9306954872798, 1215.0613790723003, 1229.946216617713, 1349.7751382530164, 1281.0936306081885, 1329.7438573213683, 1192.4205165367573, 1319.8507824539392, 1234.9428584047153, 1333.1075197135835, 1168.490654019498, 1195.302235074631, 1264.7500076272065, 1473.9360471830198, 1256.4913582255704, 1427.800614965638, 1153.8216925806964, 1125.9193909334451, 1259.1652391168668, 1282.515308858069, 1393.0912638908378, 1511.9624106815527, 1474.1653725319954, 1310.807535602241, 1426.9045101758006, 1299.956717987438, 1327.536226362544, 1349.7459651819415, 1335.1806265385267, 1456.1092339780498, 1456.5599537627102, 1399.0529209722347, 1331.0040605352315, 1417.7240047978562, 1253.662065318633, 1708.0161191262616, 1371.9708338001133, 1458.3763097245633, 1539.032307026545, 1310.22614769737, 1253.6442800507473, 1355.5893012404886, 1518.6559734919856, 1342.0846567309463, 1297.3400301409672, 1259.2952823776996, 1421.3670597363216, 1313.1416471400591, 1447.1599623444909, 1585.0863975316704, 1359.9034787455855, 1371.3934340741844, 1313.2576561757649, 1442.2279264819942, 1350.3846153857519, 1287.9071949116787, 1360.7727349273255], "episode_lengths": [178, 195, 180, 192, 196, 139, 172, 154, 180, 157, 156, 254, 188, 197, 159, 140, 157, 167, 167, 180, 176, 216, 194, 183, 136, 202, 198, 204, 229, 192, 198, 191, 183, 204, 167, 200, 178, 167, 191, 176, 197, 201, 175, 170, 179, 172, 216, 183, 208, 155, 208, 179, 236, 170, 163, 199, 216, 167, 221, 153, 145, 169, 167, 202, 227, 227, 163, 217, 181, 183, 176, 187, 202, 224, 210, 208, 209, 183, 217, 214, 197, 206, 192, 182, 207, 197, 189, 181, 208, 228, 177, 200, 218, 210, 208, 171, 215, 220, 192, 189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2470846455628372, "mean_inference_ms": 0.984889456642706, "mean_action_processing_ms": 0.08776143437496386, "mean_env_wait_ms": 0.49613173201093524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1708.0161191262616, "episode_reward_min": 1085.7355480407075, "episode_reward_mean": 1312.7599832920214, "episode_len_mean": 189.59, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1238.1666089982632, 1317.0582029506177, 1337.4919526763433, 1249.8679513057195, 1308.1824295064462, 1156.1636633743622, 1265.6348160814366, 1161.1743654429863, 1131.9795011208225, 1312.792835317401, 1120.2067913989774, 1496.6306942074393, 1236.703851403786, 1348.0405626067159, 1230.8172359672044, 1085.7355480407075, 1098.5910985165015, 1175.5749531137437, 1212.8093952879995, 1244.3329053856485, 1237.4863754021067, 1303.3012215762826, 1268.8113686947618, 1187.0347742646877, 1163.739717329773, 1347.9721633562579, 1267.0959700607204, 1348.5869115945648, 1441.340771815016, 1328.6334774992984, 1366.5713230130832, 1241.8475127835266, 1336.1250663097492, 1366.9184056792642, 1143.7010267497906, 1420.6845116065629, 1224.2275243878803, 1220.1425410162094, 1293.459927763599, 1293.8924257244817, 1366.1211812259305, 1269.4921008768379, 1307.4953075350384, 1298.9306954872798, 1215.0613790723003, 1229.946216617713, 1349.7751382530164, 1281.0936306081885, 1329.7438573213683, 1192.4205165367573, 1319.8507824539392, 1234.9428584047153, 1333.1075197135835, 1168.490654019498, 1195.302235074631, 1264.7500076272065, 1473.9360471830198, 1256.4913582255704, 1427.800614965638, 1153.8216925806964, 1125.9193909334451, 1259.1652391168668, 1282.515308858069, 1393.0912638908378, 1511.9624106815527, 1474.1653725319954, 1310.807535602241, 1426.9045101758006, 1299.956717987438, 1327.536226362544, 1349.7459651819415, 1335.1806265385267, 1456.1092339780498, 1456.5599537627102, 1399.0529209722347, 1331.0040605352315, 1417.7240047978562, 1253.662065318633, 1708.0161191262616, 1371.9708338001133, 1458.3763097245633, 1539.032307026545, 1310.22614769737, 1253.6442800507473, 1355.5893012404886, 1518.6559734919856, 1342.0846567309463, 1297.3400301409672, 1259.2952823776996, 1421.3670597363216, 1313.1416471400591, 1447.1599623444909, 1585.0863975316704, 1359.9034787455855, 1371.3934340741844, 1313.2576561757649, 1442.2279264819942, 1350.3846153857519, 1287.9071949116787, 1360.7727349273255], "episode_lengths": [178, 195, 180, 192, 196, 139, 172, 154, 180, 157, 156, 254, 188, 197, 159, 140, 157, 167, 167, 180, 176, 216, 194, 183, 136, 202, 198, 204, 229, 192, 198, 191, 183, 204, 167, 200, 178, 167, 191, 176, 197, 201, 175, 170, 179, 172, 216, 183, 208, 155, 208, 179, 236, 170, 163, 199, 216, 167, 221, 153, 145, 169, 167, 202, 227, 227, 163, 217, 181, 183, 176, 187, 202, 224, 210, 208, 209, 183, 217, 214, 197, 206, 192, 182, 207, 197, 189, 181, 208, 228, 177, 200, 218, 210, 208, 171, 215, 220, 192, 189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2470846455628372, "mean_inference_ms": 0.984889456642706, "mean_action_processing_ms": 0.08776143437496386, "mean_env_wait_ms": 0.49613173201093524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 7098.753, "sample_time_ms": 710.58, "load_time_ms": 0.654, "load_throughput": 6119721.32, "learn_time_ms": 6373.723, "learn_throughput": 627.577, "synch_weights_time_ms": 13.197}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 343, "training_iteration": 19, "trial_id": "2db34_00000", "date": "2023-04-30_16-58-16", "timestamp": 1682848696, "time_this_iter_s": 6.982436418533325, "time_total_s": 132.79052233695984, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 132.79052233695984, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 8.370000000000001, "ram_util_percent": 67.28999999999999}}
{"custom_metrics": {"dps_mean": 11248.061678697486, "dps_min": 9382.661591112043, "dps_max": 14233.467659385524}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.221442959000988, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.838127110594062, "policy_loss": -0.0396557494897836, "vf_loss": 9.872400358671783, "vf_explained_var": 0.00423741622637677, "kl": 0.017941530540938628, "entropy": 1.5644504500973608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 1708.0161191262616, "episode_reward_min": 1125.9193909334451, "episode_reward_mean": 1349.767401443698, "episode_len_mean": 197.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 11248.061678697486, "dps_min": 9382.661591112043, "dps_max": 14233.467659385524}, "hist_stats": {"episode_reward": [1237.4863754021067, 1303.3012215762826, 1268.8113686947618, 1187.0347742646877, 1163.739717329773, 1347.9721633562579, 1267.0959700607204, 1348.5869115945648, 1441.340771815016, 1328.6334774992984, 1366.5713230130832, 1241.8475127835266, 1336.1250663097492, 1366.9184056792642, 1143.7010267497906, 1420.6845116065629, 1224.2275243878803, 1220.1425410162094, 1293.459927763599, 1293.8924257244817, 1366.1211812259305, 1269.4921008768379, 1307.4953075350384, 1298.9306954872798, 1215.0613790723003, 1229.946216617713, 1349.7751382530164, 1281.0936306081885, 1329.7438573213683, 1192.4205165367573, 1319.8507824539392, 1234.9428584047153, 1333.1075197135835, 1168.490654019498, 1195.302235074631, 1264.7500076272065, 1473.9360471830198, 1256.4913582255704, 1427.800614965638, 1153.8216925806964, 1125.9193909334451, 1259.1652391168668, 1282.515308858069, 1393.0912638908378, 1511.9624106815527, 1474.1653725319954, 1310.807535602241, 1426.9045101758006, 1299.956717987438, 1327.536226362544, 1349.7459651819415, 1335.1806265385267, 1456.1092339780498, 1456.5599537627102, 1399.0529209722347, 1331.0040605352315, 1417.7240047978562, 1253.662065318633, 1708.0161191262616, 1371.9708338001133, 1458.3763097245633, 1539.032307026545, 1310.22614769737, 1253.6442800507473, 1355.5893012404886, 1518.6559734919856, 1342.0846567309463, 1297.3400301409672, 1259.2952823776996, 1421.3670597363216, 1313.1416471400591, 1447.1599623444909, 1585.0863975316704, 1359.9034787455855, 1371.3934340741844, 1313.2576561757649, 1442.2279264819942, 1350.3846153857519, 1287.9071949116787, 1360.7727349273255, 1654.0034153219385, 1384.0287719381545, 1324.1968734155473, 1248.2455019429729, 1522.770653573248, 1447.2070771673573, 1446.1509092863716, 1390.508387165321, 1346.2250859569695, 1206.2049588712, 1498.7651580208108, 1340.2543771620944, 1694.0159900259541, 1236.2267683833675, 1560.3949702428233, 1436.0805545000437, 1424.4673000678488, 1476.70459262279, 1339.5204152228337, 1452.7254169831394], "episode_lengths": [176, 216, 194, 183, 136, 202, 198, 204, 229, 192, 198, 191, 183, 204, 167, 200, 178, 167, 191, 176, 197, 201, 175, 170, 179, 172, 216, 183, 208, 155, 208, 179, 236, 170, 163, 199, 216, 167, 221, 153, 145, 169, 167, 202, 227, 227, 163, 217, 181, 183, 176, 187, 202, 224, 210, 208, 209, 183, 217, 214, 197, 206, 192, 182, 207, 197, 189, 181, 208, 228, 177, 200, 218, 210, 208, 171, 215, 220, 192, 189, 214, 219, 218, 194, 230, 237, 231, 223, 211, 192, 208, 191, 246, 178, 224, 227, 218, 194, 191, 203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24749875161276502, "mean_inference_ms": 0.9847041255429058, "mean_action_processing_ms": 0.08806091907933776, "mean_env_wait_ms": 0.49568757059839874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1708.0161191262616, "episode_reward_min": 1125.9193909334451, "episode_reward_mean": 1349.767401443698, "episode_len_mean": 197.0, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1237.4863754021067, 1303.3012215762826, 1268.8113686947618, 1187.0347742646877, 1163.739717329773, 1347.9721633562579, 1267.0959700607204, 1348.5869115945648, 1441.340771815016, 1328.6334774992984, 1366.5713230130832, 1241.8475127835266, 1336.1250663097492, 1366.9184056792642, 1143.7010267497906, 1420.6845116065629, 1224.2275243878803, 1220.1425410162094, 1293.459927763599, 1293.8924257244817, 1366.1211812259305, 1269.4921008768379, 1307.4953075350384, 1298.9306954872798, 1215.0613790723003, 1229.946216617713, 1349.7751382530164, 1281.0936306081885, 1329.7438573213683, 1192.4205165367573, 1319.8507824539392, 1234.9428584047153, 1333.1075197135835, 1168.490654019498, 1195.302235074631, 1264.7500076272065, 1473.9360471830198, 1256.4913582255704, 1427.800614965638, 1153.8216925806964, 1125.9193909334451, 1259.1652391168668, 1282.515308858069, 1393.0912638908378, 1511.9624106815527, 1474.1653725319954, 1310.807535602241, 1426.9045101758006, 1299.956717987438, 1327.536226362544, 1349.7459651819415, 1335.1806265385267, 1456.1092339780498, 1456.5599537627102, 1399.0529209722347, 1331.0040605352315, 1417.7240047978562, 1253.662065318633, 1708.0161191262616, 1371.9708338001133, 1458.3763097245633, 1539.032307026545, 1310.22614769737, 1253.6442800507473, 1355.5893012404886, 1518.6559734919856, 1342.0846567309463, 1297.3400301409672, 1259.2952823776996, 1421.3670597363216, 1313.1416471400591, 1447.1599623444909, 1585.0863975316704, 1359.9034787455855, 1371.3934340741844, 1313.2576561757649, 1442.2279264819942, 1350.3846153857519, 1287.9071949116787, 1360.7727349273255, 1654.0034153219385, 1384.0287719381545, 1324.1968734155473, 1248.2455019429729, 1522.770653573248, 1447.2070771673573, 1446.1509092863716, 1390.508387165321, 1346.2250859569695, 1206.2049588712, 1498.7651580208108, 1340.2543771620944, 1694.0159900259541, 1236.2267683833675, 1560.3949702428233, 1436.0805545000437, 1424.4673000678488, 1476.70459262279, 1339.5204152228337, 1452.7254169831394], "episode_lengths": [176, 216, 194, 183, 136, 202, 198, 204, 229, 192, 198, 191, 183, 204, 167, 200, 178, 167, 191, 176, 197, 201, 175, 170, 179, 172, 216, 183, 208, 155, 208, 179, 236, 170, 163, 199, 216, 167, 221, 153, 145, 169, 167, 202, 227, 227, 163, 217, 181, 183, 176, 187, 202, 224, 210, 208, 209, 183, 217, 214, 197, 206, 192, 182, 207, 197, 189, 181, 208, 228, 177, 200, 218, 210, 208, 171, 215, 220, 192, 189, 214, 219, 218, 194, 230, 237, 231, 223, 211, 192, 208, 191, 246, 178, 224, 227, 218, 194, 191, 203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24749875161276502, "mean_inference_ms": 0.9847041255429058, "mean_action_processing_ms": 0.08806091907933776, "mean_env_wait_ms": 0.49568757059839874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 7115.898, "sample_time_ms": 711.801, "load_time_ms": 0.553, "load_throughput": 7238110.359, "learn_time_ms": 6389.726, "learn_throughput": 626.005, "synch_weights_time_ms": 13.217}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 363, "training_iteration": 20, "trial_id": "2db34_00000", "date": "2023-04-30_16-58-23", "timestamp": 1682848703, "time_this_iter_s": 7.171778678894043, "time_total_s": 139.96230101585388, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 139.96230101585388, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 9.03, "ram_util_percent": 67.27000000000001}}
{"custom_metrics": {"dps_mean": 11430.744641673191, "dps_min": 9382.661591112043, "dps_max": 14233.467659385524}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.160988449858081, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.866742901135517, "policy_loss": -0.03454298706605069, "vf_loss": 9.897394697127803, "vf_explained_var": 0.009396033774140061, "kl": 0.012970630586884873, "entropy": 1.4998895864332875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 1708.0161191262616, "episode_reward_min": 1125.9193909334451, "episode_reward_mean": 1371.6893570007833, "episode_len_mean": 196.98, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 11430.744641673191, "dps_min": 9382.661591112043, "dps_max": 14233.467659385524}, "hist_stats": {"episode_reward": [1307.4953075350384, 1298.9306954872798, 1215.0613790723003, 1229.946216617713, 1349.7751382530164, 1281.0936306081885, 1329.7438573213683, 1192.4205165367573, 1319.8507824539392, 1234.9428584047153, 1333.1075197135835, 1168.490654019498, 1195.302235074631, 1264.7500076272065, 1473.9360471830198, 1256.4913582255704, 1427.800614965638, 1153.8216925806964, 1125.9193909334451, 1259.1652391168668, 1282.515308858069, 1393.0912638908378, 1511.9624106815527, 1474.1653725319954, 1310.807535602241, 1426.9045101758006, 1299.956717987438, 1327.536226362544, 1349.7459651819415, 1335.1806265385267, 1456.1092339780498, 1456.5599537627102, 1399.0529209722347, 1331.0040605352315, 1417.7240047978562, 1253.662065318633, 1708.0161191262616, 1371.9708338001133, 1458.3763097245633, 1539.032307026545, 1310.22614769737, 1253.6442800507473, 1355.5893012404886, 1518.6559734919856, 1342.0846567309463, 1297.3400301409672, 1259.2952823776996, 1421.3670597363216, 1313.1416471400591, 1447.1599623444909, 1585.0863975316704, 1359.9034787455855, 1371.3934340741844, 1313.2576561757649, 1442.2279264819942, 1350.3846153857519, 1287.9071949116787, 1360.7727349273255, 1654.0034153219385, 1384.0287719381545, 1324.1968734155473, 1248.2455019429729, 1522.770653573248, 1447.2070771673573, 1446.1509092863716, 1390.508387165321, 1346.2250859569695, 1206.2049588712, 1498.7651580208108, 1340.2543771620944, 1694.0159900259541, 1236.2267683833675, 1560.3949702428233, 1436.0805545000437, 1424.4673000678488, 1476.70459262279, 1339.5204152228337, 1452.7254169831394, 1518.2216878400336, 1415.8487087803314, 1339.0898759217735, 1339.358163136279, 1451.708929874392, 1370.300127324059, 1286.040051179764, 1487.8586922423829, 1377.8586720227545, 1350.3416906426548, 1274.4584572970246, 1442.9507792068637, 1442.4968026644042, 1346.7291793976808, 1508.6786357802619, 1311.1383008484925, 1338.2758013920284, 1485.8598033988821, 1313.5760867769484, 1308.1841983833308, 1374.2604070963523, 1546.1468032321916], "episode_lengths": [175, 170, 179, 172, 216, 183, 208, 155, 208, 179, 236, 170, 163, 199, 216, 167, 221, 153, 145, 169, 167, 202, 227, 227, 163, 217, 181, 183, 176, 187, 202, 224, 210, 208, 209, 183, 217, 214, 197, 206, 192, 182, 207, 197, 189, 181, 208, 228, 177, 200, 218, 210, 208, 171, 215, 220, 192, 189, 214, 219, 218, 194, 230, 237, 231, 223, 211, 192, 208, 191, 246, 178, 224, 227, 218, 194, 191, 203, 232, 182, 186, 181, 187, 196, 178, 210, 173, 199, 168, 177, 216, 194, 161, 165, 195, 207, 207, 177, 172, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2479777897692064, "mean_inference_ms": 0.9849161707615943, "mean_action_processing_ms": 0.08812087934198416, "mean_env_wait_ms": 0.4954633630219998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1708.0161191262616, "episode_reward_min": 1125.9193909334451, "episode_reward_mean": 1371.6893570007833, "episode_len_mean": 196.98, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1307.4953075350384, 1298.9306954872798, 1215.0613790723003, 1229.946216617713, 1349.7751382530164, 1281.0936306081885, 1329.7438573213683, 1192.4205165367573, 1319.8507824539392, 1234.9428584047153, 1333.1075197135835, 1168.490654019498, 1195.302235074631, 1264.7500076272065, 1473.9360471830198, 1256.4913582255704, 1427.800614965638, 1153.8216925806964, 1125.9193909334451, 1259.1652391168668, 1282.515308858069, 1393.0912638908378, 1511.9624106815527, 1474.1653725319954, 1310.807535602241, 1426.9045101758006, 1299.956717987438, 1327.536226362544, 1349.7459651819415, 1335.1806265385267, 1456.1092339780498, 1456.5599537627102, 1399.0529209722347, 1331.0040605352315, 1417.7240047978562, 1253.662065318633, 1708.0161191262616, 1371.9708338001133, 1458.3763097245633, 1539.032307026545, 1310.22614769737, 1253.6442800507473, 1355.5893012404886, 1518.6559734919856, 1342.0846567309463, 1297.3400301409672, 1259.2952823776996, 1421.3670597363216, 1313.1416471400591, 1447.1599623444909, 1585.0863975316704, 1359.9034787455855, 1371.3934340741844, 1313.2576561757649, 1442.2279264819942, 1350.3846153857519, 1287.9071949116787, 1360.7727349273255, 1654.0034153219385, 1384.0287719381545, 1324.1968734155473, 1248.2455019429729, 1522.770653573248, 1447.2070771673573, 1446.1509092863716, 1390.508387165321, 1346.2250859569695, 1206.2049588712, 1498.7651580208108, 1340.2543771620944, 1694.0159900259541, 1236.2267683833675, 1560.3949702428233, 1436.0805545000437, 1424.4673000678488, 1476.70459262279, 1339.5204152228337, 1452.7254169831394, 1518.2216878400336, 1415.8487087803314, 1339.0898759217735, 1339.358163136279, 1451.708929874392, 1370.300127324059, 1286.040051179764, 1487.8586922423829, 1377.8586720227545, 1350.3416906426548, 1274.4584572970246, 1442.9507792068637, 1442.4968026644042, 1346.7291793976808, 1508.6786357802619, 1311.1383008484925, 1338.2758013920284, 1485.8598033988821, 1313.5760867769484, 1308.1841983833308, 1374.2604070963523, 1546.1468032321916], "episode_lengths": [175, 170, 179, 172, 216, 183, 208, 155, 208, 179, 236, 170, 163, 199, 216, 167, 221, 153, 145, 169, 167, 202, 227, 227, 163, 217, 181, 183, 176, 187, 202, 224, 210, 208, 209, 183, 217, 214, 197, 206, 192, 182, 207, 197, 189, 181, 208, 228, 177, 200, 218, 210, 208, 171, 215, 220, 192, 189, 214, 219, 218, 194, 230, 237, 231, 223, 211, 192, 208, 191, 246, 178, 224, 227, 218, 194, 191, 203, 232, 182, 186, 181, 187, 196, 178, 210, 173, 199, 168, 177, 216, 194, 161, 165, 195, 207, 207, 177, 172, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2479777897692064, "mean_inference_ms": 0.9849161707615943, "mean_action_processing_ms": 0.08812087934198416, "mean_env_wait_ms": 0.4954633630219998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 7106.135, "sample_time_ms": 712.792, "load_time_ms": 0.595, "load_throughput": 6720564.012, "learn_time_ms": 6378.802, "learn_throughput": 627.077, "synch_weights_time_ms": 13.245}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 385, "training_iteration": 21, "trial_id": "2db34_00000", "date": "2023-04-30_16-58-30", "timestamp": 1682848710, "time_this_iter_s": 6.927680253982544, "time_total_s": 146.88998126983643, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 146.88998126983643, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 11.110000000000003, "ram_util_percent": 67.20000000000002}}
{"custom_metrics": {"dps_mean": 11554.496075414552, "dps_min": 10051.707990593333, "dps_max": 14233.467659385524}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.423550663648113, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.8625637321062, "policy_loss": -0.02962424565226801, "vf_loss": 9.888886575801399, "vf_explained_var": 0.0028442202075835196, "kl": 0.011004821271219274, "entropy": 1.4213458827105903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 1708.0161191262616, "episode_reward_min": 1206.2049588712, "episode_reward_mean": 1386.539529049746, "episode_len_mean": 195.41, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 11554.496075414552, "dps_min": 10051.707990593333, "dps_max": 14233.467659385524}, "hist_stats": {"episode_reward": [1511.9624106815527, 1474.1653725319954, 1310.807535602241, 1426.9045101758006, 1299.956717987438, 1327.536226362544, 1349.7459651819415, 1335.1806265385267, 1456.1092339780498, 1456.5599537627102, 1399.0529209722347, 1331.0040605352315, 1417.7240047978562, 1253.662065318633, 1708.0161191262616, 1371.9708338001133, 1458.3763097245633, 1539.032307026545, 1310.22614769737, 1253.6442800507473, 1355.5893012404886, 1518.6559734919856, 1342.0846567309463, 1297.3400301409672, 1259.2952823776996, 1421.3670597363216, 1313.1416471400591, 1447.1599623444909, 1585.0863975316704, 1359.9034787455855, 1371.3934340741844, 1313.2576561757649, 1442.2279264819942, 1350.3846153857519, 1287.9071949116787, 1360.7727349273255, 1654.0034153219385, 1384.0287719381545, 1324.1968734155473, 1248.2455019429729, 1522.770653573248, 1447.2070771673573, 1446.1509092863716, 1390.508387165321, 1346.2250859569695, 1206.2049588712, 1498.7651580208108, 1340.2543771620944, 1694.0159900259541, 1236.2267683833675, 1560.3949702428233, 1436.0805545000437, 1424.4673000678488, 1476.70459262279, 1339.5204152228337, 1452.7254169831394, 1518.2216878400336, 1415.8487087803314, 1339.0898759217735, 1339.358163136279, 1451.708929874392, 1370.300127324059, 1286.040051179764, 1487.8586922423829, 1377.8586720227545, 1350.3416906426548, 1274.4584572970246, 1442.9507792068637, 1442.4968026644042, 1346.7291793976808, 1508.6786357802619, 1311.1383008484925, 1338.2758013920284, 1485.8598033988821, 1313.5760867769484, 1308.1841983833308, 1374.2604070963523, 1546.1468032321916, 1346.1224331203823, 1550.0147257400754, 1322.3854779367332, 1284.18797284994, 1304.8801323402342, 1274.0811065583896, 1335.8518326098667, 1340.1962640309705, 1383.2759072311155, 1468.2286002784444, 1358.2194761667308, 1258.2912399900765, 1383.7004924596463, 1363.2073763968265, 1275.8580239019118, 1423.7135502717917, 1342.5578864612587, 1339.137113915766, 1288.2666136321736, 1304.0866454185696, 1333.3082913093774, 1299.097756755381], "episode_lengths": [227, 227, 163, 217, 181, 183, 176, 187, 202, 224, 210, 208, 209, 183, 217, 214, 197, 206, 192, 182, 207, 197, 189, 181, 208, 228, 177, 200, 218, 210, 208, 171, 215, 220, 192, 189, 214, 219, 218, 194, 230, 237, 231, 223, 211, 192, 208, 191, 246, 178, 224, 227, 218, 194, 191, 203, 232, 182, 186, 181, 187, 196, 178, 210, 173, 199, 168, 177, 216, 194, 161, 165, 195, 207, 207, 177, 172, 218, 169, 212, 208, 164, 171, 151, 215, 159, 189, 190, 189, 155, 149, 174, 169, 185, 179, 186, 168, 168, 174, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24805931340397935, "mean_inference_ms": 0.9847394696226212, "mean_action_processing_ms": 0.08807177006714191, "mean_env_wait_ms": 0.4953389458820179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1708.0161191262616, "episode_reward_min": 1206.2049588712, "episode_reward_mean": 1386.539529049746, "episode_len_mean": 195.41, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1511.9624106815527, 1474.1653725319954, 1310.807535602241, 1426.9045101758006, 1299.956717987438, 1327.536226362544, 1349.7459651819415, 1335.1806265385267, 1456.1092339780498, 1456.5599537627102, 1399.0529209722347, 1331.0040605352315, 1417.7240047978562, 1253.662065318633, 1708.0161191262616, 1371.9708338001133, 1458.3763097245633, 1539.032307026545, 1310.22614769737, 1253.6442800507473, 1355.5893012404886, 1518.6559734919856, 1342.0846567309463, 1297.3400301409672, 1259.2952823776996, 1421.3670597363216, 1313.1416471400591, 1447.1599623444909, 1585.0863975316704, 1359.9034787455855, 1371.3934340741844, 1313.2576561757649, 1442.2279264819942, 1350.3846153857519, 1287.9071949116787, 1360.7727349273255, 1654.0034153219385, 1384.0287719381545, 1324.1968734155473, 1248.2455019429729, 1522.770653573248, 1447.2070771673573, 1446.1509092863716, 1390.508387165321, 1346.2250859569695, 1206.2049588712, 1498.7651580208108, 1340.2543771620944, 1694.0159900259541, 1236.2267683833675, 1560.3949702428233, 1436.0805545000437, 1424.4673000678488, 1476.70459262279, 1339.5204152228337, 1452.7254169831394, 1518.2216878400336, 1415.8487087803314, 1339.0898759217735, 1339.358163136279, 1451.708929874392, 1370.300127324059, 1286.040051179764, 1487.8586922423829, 1377.8586720227545, 1350.3416906426548, 1274.4584572970246, 1442.9507792068637, 1442.4968026644042, 1346.7291793976808, 1508.6786357802619, 1311.1383008484925, 1338.2758013920284, 1485.8598033988821, 1313.5760867769484, 1308.1841983833308, 1374.2604070963523, 1546.1468032321916, 1346.1224331203823, 1550.0147257400754, 1322.3854779367332, 1284.18797284994, 1304.8801323402342, 1274.0811065583896, 1335.8518326098667, 1340.1962640309705, 1383.2759072311155, 1468.2286002784444, 1358.2194761667308, 1258.2912399900765, 1383.7004924596463, 1363.2073763968265, 1275.8580239019118, 1423.7135502717917, 1342.5578864612587, 1339.137113915766, 1288.2666136321736, 1304.0866454185696, 1333.3082913093774, 1299.097756755381], "episode_lengths": [227, 227, 163, 217, 181, 183, 176, 187, 202, 224, 210, 208, 209, 183, 217, 214, 197, 206, 192, 182, 207, 197, 189, 181, 208, 228, 177, 200, 218, 210, 208, 171, 215, 220, 192, 189, 214, 219, 218, 194, 230, 237, 231, 223, 211, 192, 208, 191, 246, 178, 224, 227, 218, 194, 191, 203, 232, 182, 186, 181, 187, 196, 178, 210, 173, 199, 168, 177, 216, 194, 161, 165, 195, 207, 207, 177, 172, 218, 169, 212, 208, 164, 171, 151, 215, 159, 189, 190, 189, 155, 149, 174, 169, 185, 179, 186, 168, 168, 174, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24805931340397935, "mean_inference_ms": 0.9847394696226212, "mean_action_processing_ms": 0.08807177006714191, "mean_env_wait_ms": 0.4953389458820179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 7112.015, "sample_time_ms": 710.688, "load_time_ms": 0.595, "load_throughput": 6720564.012, "learn_time_ms": 6387.282, "learn_throughput": 626.244, "synch_weights_time_ms": 12.648}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 407, "training_iteration": 22, "trial_id": "2db34_00000", "date": "2023-04-30_16-58-37", "timestamp": 1682848717, "time_this_iter_s": 6.907209873199463, "time_total_s": 153.7971911430359, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 153.7971911430359, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 7.15, "ram_util_percent": 67.23999999999998}}
{"custom_metrics": {"dps_mean": 11688.326225451261, "dps_min": 10051.707990593333, "dps_max": 14656.238630561078}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.033376904264573, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.858468727398945, "policy_loss": -0.03734061788487178, "vf_loss": 9.891214587098808, "vf_explained_var": 0.004171326596249816, "kl": 0.015315814885617089, "entropy": 1.4294122996509717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 1758.7486356673282, "episode_reward_min": 1206.2049588712, "episode_reward_mean": 1402.5991470541512, "episode_len_mean": 192.76, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 11688.326225451261, "dps_min": 10051.707990593333, "dps_max": 14656.238630561078}, "hist_stats": {"episode_reward": [1342.0846567309463, 1297.3400301409672, 1259.2952823776996, 1421.3670597363216, 1313.1416471400591, 1447.1599623444909, 1585.0863975316704, 1359.9034787455855, 1371.3934340741844, 1313.2576561757649, 1442.2279264819942, 1350.3846153857519, 1287.9071949116787, 1360.7727349273255, 1654.0034153219385, 1384.0287719381545, 1324.1968734155473, 1248.2455019429729, 1522.770653573248, 1447.2070771673573, 1446.1509092863716, 1390.508387165321, 1346.2250859569695, 1206.2049588712, 1498.7651580208108, 1340.2543771620944, 1694.0159900259541, 1236.2267683833675, 1560.3949702428233, 1436.0805545000437, 1424.4673000678488, 1476.70459262279, 1339.5204152228337, 1452.7254169831394, 1518.2216878400336, 1415.8487087803314, 1339.0898759217735, 1339.358163136279, 1451.708929874392, 1370.300127324059, 1286.040051179764, 1487.8586922423829, 1377.8586720227545, 1350.3416906426548, 1274.4584572970246, 1442.9507792068637, 1442.4968026644042, 1346.7291793976808, 1508.6786357802619, 1311.1383008484925, 1338.2758013920284, 1485.8598033988821, 1313.5760867769484, 1308.1841983833308, 1374.2604070963523, 1546.1468032321916, 1346.1224331203823, 1550.0147257400754, 1322.3854779367332, 1284.18797284994, 1304.8801323402342, 1274.0811065583896, 1335.8518326098667, 1340.1962640309705, 1383.2759072311155, 1468.2286002784444, 1358.2194761667308, 1258.2912399900765, 1383.7004924596463, 1363.2073763968265, 1275.8580239019118, 1423.7135502717917, 1342.5578864612587, 1339.137113915766, 1288.2666136321736, 1304.0866454185696, 1333.3082913093774, 1299.097756755381, 1739.9587520436153, 1467.8753050692776, 1758.7486356673282, 1555.1849901155663, 1258.0687190963156, 1426.6793620259737, 1410.1946008451675, 1375.5991834562085, 1442.7822682057827, 1499.5615611792734, 1268.2105706898662, 1330.6697688204654, 1624.4233603306216, 1537.4210452940665, 1454.431710713842, 1450.5953576992474, 1470.7077185353266, 1320.3236214098456, 1728.6736168981429, 1468.9965870331882, 1445.2067226272995, 1437.5312192689516], "episode_lengths": [189, 181, 208, 228, 177, 200, 218, 210, 208, 171, 215, 220, 192, 189, 214, 219, 218, 194, 230, 237, 231, 223, 211, 192, 208, 191, 246, 178, 224, 227, 218, 194, 191, 203, 232, 182, 186, 181, 187, 196, 178, 210, 173, 199, 168, 177, 216, 194, 161, 165, 195, 207, 207, 177, 172, 218, 169, 212, 208, 164, 171, 151, 215, 159, 189, 190, 189, 155, 149, 174, 169, 185, 179, 186, 168, 168, 174, 172, 245, 181, 259, 228, 176, 168, 165, 173, 164, 186, 143, 171, 202, 211, 185, 176, 170, 149, 242, 188, 177, 185]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24847618121193207, "mean_inference_ms": 0.9853166108172029, "mean_action_processing_ms": 0.08809769173123858, "mean_env_wait_ms": 0.495728477700197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1758.7486356673282, "episode_reward_min": 1206.2049588712, "episode_reward_mean": 1402.5991470541512, "episode_len_mean": 192.76, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1342.0846567309463, 1297.3400301409672, 1259.2952823776996, 1421.3670597363216, 1313.1416471400591, 1447.1599623444909, 1585.0863975316704, 1359.9034787455855, 1371.3934340741844, 1313.2576561757649, 1442.2279264819942, 1350.3846153857519, 1287.9071949116787, 1360.7727349273255, 1654.0034153219385, 1384.0287719381545, 1324.1968734155473, 1248.2455019429729, 1522.770653573248, 1447.2070771673573, 1446.1509092863716, 1390.508387165321, 1346.2250859569695, 1206.2049588712, 1498.7651580208108, 1340.2543771620944, 1694.0159900259541, 1236.2267683833675, 1560.3949702428233, 1436.0805545000437, 1424.4673000678488, 1476.70459262279, 1339.5204152228337, 1452.7254169831394, 1518.2216878400336, 1415.8487087803314, 1339.0898759217735, 1339.358163136279, 1451.708929874392, 1370.300127324059, 1286.040051179764, 1487.8586922423829, 1377.8586720227545, 1350.3416906426548, 1274.4584572970246, 1442.9507792068637, 1442.4968026644042, 1346.7291793976808, 1508.6786357802619, 1311.1383008484925, 1338.2758013920284, 1485.8598033988821, 1313.5760867769484, 1308.1841983833308, 1374.2604070963523, 1546.1468032321916, 1346.1224331203823, 1550.0147257400754, 1322.3854779367332, 1284.18797284994, 1304.8801323402342, 1274.0811065583896, 1335.8518326098667, 1340.1962640309705, 1383.2759072311155, 1468.2286002784444, 1358.2194761667308, 1258.2912399900765, 1383.7004924596463, 1363.2073763968265, 1275.8580239019118, 1423.7135502717917, 1342.5578864612587, 1339.137113915766, 1288.2666136321736, 1304.0866454185696, 1333.3082913093774, 1299.097756755381, 1739.9587520436153, 1467.8753050692776, 1758.7486356673282, 1555.1849901155663, 1258.0687190963156, 1426.6793620259737, 1410.1946008451675, 1375.5991834562085, 1442.7822682057827, 1499.5615611792734, 1268.2105706898662, 1330.6697688204654, 1624.4233603306216, 1537.4210452940665, 1454.431710713842, 1450.5953576992474, 1470.7077185353266, 1320.3236214098456, 1728.6736168981429, 1468.9965870331882, 1445.2067226272995, 1437.5312192689516], "episode_lengths": [189, 181, 208, 228, 177, 200, 218, 210, 208, 171, 215, 220, 192, 189, 214, 219, 218, 194, 230, 237, 231, 223, 211, 192, 208, 191, 246, 178, 224, 227, 218, 194, 191, 203, 232, 182, 186, 181, 187, 196, 178, 210, 173, 199, 168, 177, 216, 194, 161, 165, 195, 207, 207, 177, 172, 218, 169, 212, 208, 164, 171, 151, 215, 159, 189, 190, 189, 155, 149, 174, 169, 185, 179, 186, 168, 168, 174, 172, 245, 181, 259, 228, 176, 168, 165, 173, 164, 186, 143, 171, 202, 211, 185, 176, 170, 149, 242, 188, 177, 185]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24847618121193207, "mean_inference_ms": 0.9853166108172029, "mean_action_processing_ms": 0.08809769173123858, "mean_env_wait_ms": 0.495728477700197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 7061.349, "sample_time_ms": 707.768, "load_time_ms": 0.495, "load_throughput": 8076453.088, "learn_time_ms": 6339.763, "learn_throughput": 630.938, "synch_weights_time_ms": 12.522}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 429, "training_iteration": 23, "trial_id": "2db34_00000", "date": "2023-04-30_16-58-44", "timestamp": 1682848724, "time_this_iter_s": 7.010376453399658, "time_total_s": 160.80756759643555, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 160.80756759643555, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 10.911111111111111, "ram_util_percent": 67.24444444444444}}
{"custom_metrics": {"dps_mean": 11702.640975823213, "dps_min": 9948.033456150935, "dps_max": 14656.238630561078}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.33169405473176, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.851091757128316, "policy_loss": -0.03454741211407768, "vf_loss": 9.881284205118815, "vf_explained_var": 0.0029691228302576207, "kl": 0.014516562475676866, "entropy": 1.4383305170202767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 1758.7486356673282, "episode_reward_min": 1193.7640147381126, "episode_reward_mean": 1404.3169170987853, "episode_len_mean": 187.86, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 11702.640975823213, "dps_min": 9948.033456150935, "dps_max": 14656.238630561078}, "hist_stats": {"episode_reward": [1346.2250859569695, 1206.2049588712, 1498.7651580208108, 1340.2543771620944, 1694.0159900259541, 1236.2267683833675, 1560.3949702428233, 1436.0805545000437, 1424.4673000678488, 1476.70459262279, 1339.5204152228337, 1452.7254169831394, 1518.2216878400336, 1415.8487087803314, 1339.0898759217735, 1339.358163136279, 1451.708929874392, 1370.300127324059, 1286.040051179764, 1487.8586922423829, 1377.8586720227545, 1350.3416906426548, 1274.4584572970246, 1442.9507792068637, 1442.4968026644042, 1346.7291793976808, 1508.6786357802619, 1311.1383008484925, 1338.2758013920284, 1485.8598033988821, 1313.5760867769484, 1308.1841983833308, 1374.2604070963523, 1546.1468032321916, 1346.1224331203823, 1550.0147257400754, 1322.3854779367332, 1284.18797284994, 1304.8801323402342, 1274.0811065583896, 1335.8518326098667, 1340.1962640309705, 1383.2759072311155, 1468.2286002784444, 1358.2194761667308, 1258.2912399900765, 1383.7004924596463, 1363.2073763968265, 1275.8580239019118, 1423.7135502717917, 1342.5578864612587, 1339.137113915766, 1288.2666136321736, 1304.0866454185696, 1333.3082913093774, 1299.097756755381, 1739.9587520436153, 1467.8753050692776, 1758.7486356673282, 1555.1849901155663, 1258.0687190963156, 1426.6793620259737, 1410.1946008451675, 1375.5991834562085, 1442.7822682057827, 1499.5615611792734, 1268.2105706898662, 1330.6697688204654, 1624.4233603306216, 1537.4210452940665, 1454.431710713842, 1450.5953576992474, 1470.7077185353266, 1320.3236214098456, 1728.6736168981429, 1468.9965870331882, 1445.2067226272995, 1437.5312192689516, 1624.7302767553401, 1415.493110672691, 1386.431781443682, 1193.7640147381126, 1351.819162762354, 1271.3251619058985, 1451.787399438579, 1324.0431631676772, 1340.0482688294285, 1226.1998403364805, 1252.4647892292, 1361.6032875013173, 1436.3683205011846, 1365.4778126324964, 1502.5479760027708, 1444.747510419758, 1729.328095071388, 1446.567543529869, 1422.657868565137, 1374.3479349117656, 1501.0628899547717, 1317.394462608856], "episode_lengths": [211, 192, 208, 191, 246, 178, 224, 227, 218, 194, 191, 203, 232, 182, 186, 181, 187, 196, 178, 210, 173, 199, 168, 177, 216, 194, 161, 165, 195, 207, 207, 177, 172, 218, 169, 212, 208, 164, 171, 151, 215, 159, 189, 190, 189, 155, 149, 174, 169, 185, 179, 186, 168, 168, 174, 172, 245, 181, 259, 228, 176, 168, 165, 173, 164, 186, 143, 171, 202, 211, 185, 176, 170, 149, 242, 188, 177, 185, 230, 181, 207, 170, 186, 154, 194, 169, 171, 155, 175, 160, 171, 198, 213, 184, 226, 187, 169, 212, 211, 159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24925735921672637, "mean_inference_ms": 0.985913633982381, "mean_action_processing_ms": 0.08812942299356641, "mean_env_wait_ms": 0.49557363472283017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1758.7486356673282, "episode_reward_min": 1193.7640147381126, "episode_reward_mean": 1404.3169170987853, "episode_len_mean": 187.86, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1346.2250859569695, 1206.2049588712, 1498.7651580208108, 1340.2543771620944, 1694.0159900259541, 1236.2267683833675, 1560.3949702428233, 1436.0805545000437, 1424.4673000678488, 1476.70459262279, 1339.5204152228337, 1452.7254169831394, 1518.2216878400336, 1415.8487087803314, 1339.0898759217735, 1339.358163136279, 1451.708929874392, 1370.300127324059, 1286.040051179764, 1487.8586922423829, 1377.8586720227545, 1350.3416906426548, 1274.4584572970246, 1442.9507792068637, 1442.4968026644042, 1346.7291793976808, 1508.6786357802619, 1311.1383008484925, 1338.2758013920284, 1485.8598033988821, 1313.5760867769484, 1308.1841983833308, 1374.2604070963523, 1546.1468032321916, 1346.1224331203823, 1550.0147257400754, 1322.3854779367332, 1284.18797284994, 1304.8801323402342, 1274.0811065583896, 1335.8518326098667, 1340.1962640309705, 1383.2759072311155, 1468.2286002784444, 1358.2194761667308, 1258.2912399900765, 1383.7004924596463, 1363.2073763968265, 1275.8580239019118, 1423.7135502717917, 1342.5578864612587, 1339.137113915766, 1288.2666136321736, 1304.0866454185696, 1333.3082913093774, 1299.097756755381, 1739.9587520436153, 1467.8753050692776, 1758.7486356673282, 1555.1849901155663, 1258.0687190963156, 1426.6793620259737, 1410.1946008451675, 1375.5991834562085, 1442.7822682057827, 1499.5615611792734, 1268.2105706898662, 1330.6697688204654, 1624.4233603306216, 1537.4210452940665, 1454.431710713842, 1450.5953576992474, 1470.7077185353266, 1320.3236214098456, 1728.6736168981429, 1468.9965870331882, 1445.2067226272995, 1437.5312192689516, 1624.7302767553401, 1415.493110672691, 1386.431781443682, 1193.7640147381126, 1351.819162762354, 1271.3251619058985, 1451.787399438579, 1324.0431631676772, 1340.0482688294285, 1226.1998403364805, 1252.4647892292, 1361.6032875013173, 1436.3683205011846, 1365.4778126324964, 1502.5479760027708, 1444.747510419758, 1729.328095071388, 1446.567543529869, 1422.657868565137, 1374.3479349117656, 1501.0628899547717, 1317.394462608856], "episode_lengths": [211, 192, 208, 191, 246, 178, 224, 227, 218, 194, 191, 203, 232, 182, 186, 181, 187, 196, 178, 210, 173, 199, 168, 177, 216, 194, 161, 165, 195, 207, 207, 177, 172, 218, 169, 212, 208, 164, 171, 151, 215, 159, 189, 190, 189, 155, 149, 174, 169, 185, 179, 186, 168, 168, 174, 172, 245, 181, 259, 228, 176, 168, 165, 173, 164, 186, 143, 171, 202, 211, 185, 176, 170, 149, 242, 188, 177, 185, 230, 181, 207, 170, 186, 154, 194, 169, 171, 155, 175, 160, 171, 198, 213, 184, 226, 187, 169, 212, 211, 159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24925735921672637, "mean_inference_ms": 0.985913633982381, "mean_action_processing_ms": 0.08812942299356641, "mean_env_wait_ms": 0.49557363472283017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 7003.468, "sample_time_ms": 695.112, "load_time_ms": 0.495, "load_throughput": 8078397.535, "learn_time_ms": 6294.523, "learn_throughput": 635.473, "synch_weights_time_ms": 12.437}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 451, "training_iteration": 24, "trial_id": "2db34_00000", "date": "2023-04-30_16-58-51", "timestamp": 1682848731, "time_this_iter_s": 6.813140869140625, "time_total_s": 167.62070846557617, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 167.62070846557617, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 67.27000000000001}}
{"custom_metrics": {"dps_mean": 11658.200960775846, "dps_min": 9179.883604100847, "dps_max": 14656.238630561078}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.373118119342353, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.867259806971397, "policy_loss": -0.03372152411999802, "vf_loss": 9.897473655208465, "vf_explained_var": 0.0023697340360251807, "kl": 0.011692261596983227, "entropy": 1.3503193522653272, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 1758.7486356673282, "episode_reward_min": 1101.586032492101, "episode_reward_mean": 1398.9841152931012, "episode_len_mean": 182.41, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 11658.200960775846, "dps_min": 9179.883604100847, "dps_max": 14656.238630561078}, "hist_stats": {"episode_reward": [1274.4584572970246, 1442.9507792068637, 1442.4968026644042, 1346.7291793976808, 1508.6786357802619, 1311.1383008484925, 1338.2758013920284, 1485.8598033988821, 1313.5760867769484, 1308.1841983833308, 1374.2604070963523, 1546.1468032321916, 1346.1224331203823, 1550.0147257400754, 1322.3854779367332, 1284.18797284994, 1304.8801323402342, 1274.0811065583896, 1335.8518326098667, 1340.1962640309705, 1383.2759072311155, 1468.2286002784444, 1358.2194761667308, 1258.2912399900765, 1383.7004924596463, 1363.2073763968265, 1275.8580239019118, 1423.7135502717917, 1342.5578864612587, 1339.137113915766, 1288.2666136321736, 1304.0866454185696, 1333.3082913093774, 1299.097756755381, 1739.9587520436153, 1467.8753050692776, 1758.7486356673282, 1555.1849901155663, 1258.0687190963156, 1426.6793620259737, 1410.1946008451675, 1375.5991834562085, 1442.7822682057827, 1499.5615611792734, 1268.2105706898662, 1330.6697688204654, 1624.4233603306216, 1537.4210452940665, 1454.431710713842, 1450.5953576992474, 1470.7077185353266, 1320.3236214098456, 1728.6736168981429, 1468.9965870331882, 1445.2067226272995, 1437.5312192689516, 1624.7302767553401, 1415.493110672691, 1386.431781443682, 1193.7640147381126, 1351.819162762354, 1271.3251619058985, 1451.787399438579, 1324.0431631676772, 1340.0482688294285, 1226.1998403364805, 1252.4647892292, 1361.6032875013173, 1436.3683205011846, 1365.4778126324964, 1502.5479760027708, 1444.747510419758, 1729.328095071388, 1446.567543529869, 1422.657868565137, 1374.3479349117656, 1501.0628899547717, 1317.394462608856, 1535.3457332199891, 1379.0696005229067, 1517.2779860807577, 1551.4193911618843, 1400.908299519733, 1336.2805350036872, 1101.586032492101, 1327.889101612213, 1288.8101124068207, 1633.209380188921, 1230.9563525468095, 1408.6757762561572, 1384.1405732546934, 1183.1935353625295, 1436.6636621308492, 1257.0988251681474, 1312.3952110935095, 1322.9283517624604, 1409.369915618591, 1360.8744541532724, 1500.0156019580775, 1536.8235749417913], "episode_lengths": [168, 177, 216, 194, 161, 165, 195, 207, 207, 177, 172, 218, 169, 212, 208, 164, 171, 151, 215, 159, 189, 190, 189, 155, 149, 174, 169, 185, 179, 186, 168, 168, 174, 172, 245, 181, 259, 228, 176, 168, 165, 173, 164, 186, 143, 171, 202, 211, 185, 176, 170, 149, 242, 188, 177, 185, 230, 181, 207, 170, 186, 154, 194, 169, 171, 155, 175, 160, 171, 198, 213, 184, 226, 187, 169, 212, 211, 159, 193, 161, 247, 214, 163, 145, 154, 142, 157, 220, 168, 180, 150, 160, 185, 157, 174, 186, 161, 175, 163, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2501771122998631, "mean_inference_ms": 0.9861526556547812, "mean_action_processing_ms": 0.0881467648196258, "mean_env_wait_ms": 0.4959147250276509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1758.7486356673282, "episode_reward_min": 1101.586032492101, "episode_reward_mean": 1398.9841152931012, "episode_len_mean": 182.41, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1274.4584572970246, 1442.9507792068637, 1442.4968026644042, 1346.7291793976808, 1508.6786357802619, 1311.1383008484925, 1338.2758013920284, 1485.8598033988821, 1313.5760867769484, 1308.1841983833308, 1374.2604070963523, 1546.1468032321916, 1346.1224331203823, 1550.0147257400754, 1322.3854779367332, 1284.18797284994, 1304.8801323402342, 1274.0811065583896, 1335.8518326098667, 1340.1962640309705, 1383.2759072311155, 1468.2286002784444, 1358.2194761667308, 1258.2912399900765, 1383.7004924596463, 1363.2073763968265, 1275.8580239019118, 1423.7135502717917, 1342.5578864612587, 1339.137113915766, 1288.2666136321736, 1304.0866454185696, 1333.3082913093774, 1299.097756755381, 1739.9587520436153, 1467.8753050692776, 1758.7486356673282, 1555.1849901155663, 1258.0687190963156, 1426.6793620259737, 1410.1946008451675, 1375.5991834562085, 1442.7822682057827, 1499.5615611792734, 1268.2105706898662, 1330.6697688204654, 1624.4233603306216, 1537.4210452940665, 1454.431710713842, 1450.5953576992474, 1470.7077185353266, 1320.3236214098456, 1728.6736168981429, 1468.9965870331882, 1445.2067226272995, 1437.5312192689516, 1624.7302767553401, 1415.493110672691, 1386.431781443682, 1193.7640147381126, 1351.819162762354, 1271.3251619058985, 1451.787399438579, 1324.0431631676772, 1340.0482688294285, 1226.1998403364805, 1252.4647892292, 1361.6032875013173, 1436.3683205011846, 1365.4778126324964, 1502.5479760027708, 1444.747510419758, 1729.328095071388, 1446.567543529869, 1422.657868565137, 1374.3479349117656, 1501.0628899547717, 1317.394462608856, 1535.3457332199891, 1379.0696005229067, 1517.2779860807577, 1551.4193911618843, 1400.908299519733, 1336.2805350036872, 1101.586032492101, 1327.889101612213, 1288.8101124068207, 1633.209380188921, 1230.9563525468095, 1408.6757762561572, 1384.1405732546934, 1183.1935353625295, 1436.6636621308492, 1257.0988251681474, 1312.3952110935095, 1322.9283517624604, 1409.369915618591, 1360.8744541532724, 1500.0156019580775, 1536.8235749417913], "episode_lengths": [168, 177, 216, 194, 161, 165, 195, 207, 207, 177, 172, 218, 169, 212, 208, 164, 171, 151, 215, 159, 189, 190, 189, 155, 149, 174, 169, 185, 179, 186, 168, 168, 174, 172, 245, 181, 259, 228, 176, 168, 165, 173, 164, 186, 143, 171, 202, 211, 185, 176, 170, 149, 242, 188, 177, 185, 230, 181, 207, 170, 186, 154, 194, 169, 171, 155, 175, 160, 171, 198, 213, 184, 226, 187, 169, 212, 211, 159, 193, 161, 247, 214, 163, 145, 154, 142, 157, 220, 168, 180, 150, 160, 185, 157, 174, 186, 161, 175, 163, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2501771122998631, "mean_inference_ms": 0.9861526556547812, "mean_action_processing_ms": 0.0881467648196258, "mean_env_wait_ms": 0.4959147250276509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 7010.272, "sample_time_ms": 708.166, "load_time_ms": 0.596, "load_throughput": 6716797.182, "learn_time_ms": 6288.373, "learn_throughput": 636.095, "synch_weights_time_ms": 12.336}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 473, "training_iteration": 25, "trial_id": "2db34_00000", "date": "2023-04-30_16-58-58", "timestamp": 1682848738, "time_this_iter_s": 7.110335350036621, "time_total_s": 174.7310438156128, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 174.7310438156128, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 11.29, "ram_util_percent": 66.86}}
{"custom_metrics": {"dps_mean": 11723.058011801224, "dps_min": 9179.883604100847, "dps_max": 14656.238630561078}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.0863261496508, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.853928633659116, "policy_loss": -0.03492072310238596, "vf_loss": 9.88337661886728, "vf_explained_var": 0.007499871266785489, "kl": 0.01824242672475271, "entropy": 1.2551766394287027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 1758.7486356673282, "episode_reward_min": 1101.586032492101, "episode_reward_mean": 1406.7669614161468, "episode_len_mean": 181.65, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 11723.058011801224, "dps_min": 9179.883604100847, "dps_max": 14656.238630561078}, "hist_stats": {"episode_reward": [1358.2194761667308, 1258.2912399900765, 1383.7004924596463, 1363.2073763968265, 1275.8580239019118, 1423.7135502717917, 1342.5578864612587, 1339.137113915766, 1288.2666136321736, 1304.0866454185696, 1333.3082913093774, 1299.097756755381, 1739.9587520436153, 1467.8753050692776, 1758.7486356673282, 1555.1849901155663, 1258.0687190963156, 1426.6793620259737, 1410.1946008451675, 1375.5991834562085, 1442.7822682057827, 1499.5615611792734, 1268.2105706898662, 1330.6697688204654, 1624.4233603306216, 1537.4210452940665, 1454.431710713842, 1450.5953576992474, 1470.7077185353266, 1320.3236214098456, 1728.6736168981429, 1468.9965870331882, 1445.2067226272995, 1437.5312192689516, 1624.7302767553401, 1415.493110672691, 1386.431781443682, 1193.7640147381126, 1351.819162762354, 1271.3251619058985, 1451.787399438579, 1324.0431631676772, 1340.0482688294285, 1226.1998403364805, 1252.4647892292, 1361.6032875013173, 1436.3683205011846, 1365.4778126324964, 1502.5479760027708, 1444.747510419758, 1729.328095071388, 1446.567543529869, 1422.657868565137, 1374.3479349117656, 1501.0628899547717, 1317.394462608856, 1535.3457332199891, 1379.0696005229067, 1517.2779860807577, 1551.4193911618843, 1400.908299519733, 1336.2805350036872, 1101.586032492101, 1327.889101612213, 1288.8101124068207, 1633.209380188921, 1230.9563525468095, 1408.6757762561572, 1384.1405732546934, 1183.1935353625295, 1436.6636621308492, 1257.0988251681474, 1312.3952110935095, 1322.9283517624604, 1409.369915618591, 1360.8744541532724, 1500.0156019580775, 1536.8235749417913, 1361.9900917808682, 1271.1632598412436, 1268.5968510632379, 1651.4267131073884, 1372.9203627102083, 1540.139849362341, 1394.041095640548, 1398.953209130868, 1327.7716392903585, 1684.366548999769, 1386.1772964920392, 1503.96017348335, 1392.4629326924698, 1476.7438596239622, 1294.417269739842, 1360.3514754260002, 1333.8556427723433, 1258.3069924578658, 1548.1100651677084, 1241.4341788160946, 1439.7030705654536, 1573.3717423111932], "episode_lengths": [189, 155, 149, 174, 169, 185, 179, 186, 168, 168, 174, 172, 245, 181, 259, 228, 176, 168, 165, 173, 164, 186, 143, 171, 202, 211, 185, 176, 170, 149, 242, 188, 177, 185, 230, 181, 207, 170, 186, 154, 194, 169, 171, 155, 175, 160, 171, 198, 213, 184, 226, 187, 169, 212, 211, 159, 193, 161, 247, 214, 163, 145, 154, 142, 157, 220, 168, 180, 150, 160, 185, 157, 174, 186, 161, 175, 163, 207, 203, 154, 149, 199, 224, 203, 165, 196, 163, 237, 167, 192, 143, 185, 188, 161, 180, 147, 231, 137, 184, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25082804888797944, "mean_inference_ms": 0.9863547596590374, "mean_action_processing_ms": 0.08818649591399336, "mean_env_wait_ms": 0.49604626922509193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1758.7486356673282, "episode_reward_min": 1101.586032492101, "episode_reward_mean": 1406.7669614161468, "episode_len_mean": 181.65, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1358.2194761667308, 1258.2912399900765, 1383.7004924596463, 1363.2073763968265, 1275.8580239019118, 1423.7135502717917, 1342.5578864612587, 1339.137113915766, 1288.2666136321736, 1304.0866454185696, 1333.3082913093774, 1299.097756755381, 1739.9587520436153, 1467.8753050692776, 1758.7486356673282, 1555.1849901155663, 1258.0687190963156, 1426.6793620259737, 1410.1946008451675, 1375.5991834562085, 1442.7822682057827, 1499.5615611792734, 1268.2105706898662, 1330.6697688204654, 1624.4233603306216, 1537.4210452940665, 1454.431710713842, 1450.5953576992474, 1470.7077185353266, 1320.3236214098456, 1728.6736168981429, 1468.9965870331882, 1445.2067226272995, 1437.5312192689516, 1624.7302767553401, 1415.493110672691, 1386.431781443682, 1193.7640147381126, 1351.819162762354, 1271.3251619058985, 1451.787399438579, 1324.0431631676772, 1340.0482688294285, 1226.1998403364805, 1252.4647892292, 1361.6032875013173, 1436.3683205011846, 1365.4778126324964, 1502.5479760027708, 1444.747510419758, 1729.328095071388, 1446.567543529869, 1422.657868565137, 1374.3479349117656, 1501.0628899547717, 1317.394462608856, 1535.3457332199891, 1379.0696005229067, 1517.2779860807577, 1551.4193911618843, 1400.908299519733, 1336.2805350036872, 1101.586032492101, 1327.889101612213, 1288.8101124068207, 1633.209380188921, 1230.9563525468095, 1408.6757762561572, 1384.1405732546934, 1183.1935353625295, 1436.6636621308492, 1257.0988251681474, 1312.3952110935095, 1322.9283517624604, 1409.369915618591, 1360.8744541532724, 1500.0156019580775, 1536.8235749417913, 1361.9900917808682, 1271.1632598412436, 1268.5968510632379, 1651.4267131073884, 1372.9203627102083, 1540.139849362341, 1394.041095640548, 1398.953209130868, 1327.7716392903585, 1684.366548999769, 1386.1772964920392, 1503.96017348335, 1392.4629326924698, 1476.7438596239622, 1294.417269739842, 1360.3514754260002, 1333.8556427723433, 1258.3069924578658, 1548.1100651677084, 1241.4341788160946, 1439.7030705654536, 1573.3717423111932], "episode_lengths": [189, 155, 149, 174, 169, 185, 179, 186, 168, 168, 174, 172, 245, 181, 259, 228, 176, 168, 165, 173, 164, 186, 143, 171, 202, 211, 185, 176, 170, 149, 242, 188, 177, 185, 230, 181, 207, 170, 186, 154, 194, 169, 171, 155, 175, 160, 171, 198, 213, 184, 226, 187, 169, 212, 211, 159, 193, 161, 247, 214, 163, 145, 154, 142, 157, 220, 168, 180, 150, 160, 185, 157, 174, 186, 161, 175, 163, 207, 203, 154, 149, 199, 224, 203, 165, 196, 163, 237, 167, 192, 143, 185, 188, 161, 180, 147, 231, 137, 184, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25082804888797944, "mean_inference_ms": 0.9863547596590374, "mean_action_processing_ms": 0.08818649591399336, "mean_env_wait_ms": 0.49604626922509193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 7006.33, "sample_time_ms": 701.548, "load_time_ms": 0.596, "load_throughput": 6716797.182, "learn_time_ms": 6291.25, "learn_throughput": 635.804, "synch_weights_time_ms": 12.336}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 495, "training_iteration": 26, "trial_id": "2db34_00000", "date": "2023-04-30_16-59-05", "timestamp": 1682848745, "time_this_iter_s": 7.034853458404541, "time_total_s": 181.76589727401733, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 181.76589727401733, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 66.77000000000001}}
{"custom_metrics": {"dps_mean": 11899.753416954762, "dps_min": 9179.883604100847, "dps_max": 16013.846874806746}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.95032036881293, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.858832602347096, "policy_loss": -0.034260712402261875, "vf_loss": 9.888686975868799, "vf_explained_var": 0.003628054036889025, "kl": 0.014687846318702376, "entropy": 1.2474677495418056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 1921.6616249768103, "episode_reward_min": 1101.586032492101, "episode_reward_mean": 1427.970410034571, "episode_len_mean": 183.99, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 11899.753416954762, "dps_min": 9179.883604100847, "dps_max": 16013.846874806746}, "hist_stats": {"episode_reward": [1499.5615611792734, 1268.2105706898662, 1330.6697688204654, 1624.4233603306216, 1537.4210452940665, 1454.431710713842, 1450.5953576992474, 1470.7077185353266, 1320.3236214098456, 1728.6736168981429, 1468.9965870331882, 1445.2067226272995, 1437.5312192689516, 1624.7302767553401, 1415.493110672691, 1386.431781443682, 1193.7640147381126, 1351.819162762354, 1271.3251619058985, 1451.787399438579, 1324.0431631676772, 1340.0482688294285, 1226.1998403364805, 1252.4647892292, 1361.6032875013173, 1436.3683205011846, 1365.4778126324964, 1502.5479760027708, 1444.747510419758, 1729.328095071388, 1446.567543529869, 1422.657868565137, 1374.3479349117656, 1501.0628899547717, 1317.394462608856, 1535.3457332199891, 1379.0696005229067, 1517.2779860807577, 1551.4193911618843, 1400.908299519733, 1336.2805350036872, 1101.586032492101, 1327.889101612213, 1288.8101124068207, 1633.209380188921, 1230.9563525468095, 1408.6757762561572, 1384.1405732546934, 1183.1935353625295, 1436.6636621308492, 1257.0988251681474, 1312.3952110935095, 1322.9283517624604, 1409.369915618591, 1360.8744541532724, 1500.0156019580775, 1536.8235749417913, 1361.9900917808682, 1271.1632598412436, 1268.5968510632379, 1651.4267131073884, 1372.9203627102083, 1540.139849362341, 1394.041095640548, 1398.953209130868, 1327.7716392903585, 1684.366548999769, 1386.1772964920392, 1503.96017348335, 1392.4629326924698, 1476.7438596239622, 1294.417269739842, 1360.3514754260002, 1333.8556427723433, 1258.3069924578658, 1548.1100651677084, 1241.4341788160946, 1439.7030705654536, 1573.3717423111932, 1895.5943973254655, 1383.5879912954515, 1541.7303435920726, 1344.5139849925363, 1921.6616249768103, 1288.4581273623996, 1345.2054004031606, 1312.6008529397043, 1501.130412301389, 1325.019772633041, 1399.0428574211228, 1470.3997694763575, 1437.3760790617284, 1460.522479134231, 1460.1883013789193, 1720.2193584375702, 1578.0057817899033, 1678.9698082693058, 1366.2230186721588, 1762.645142743632, 1331.785640840202], "episode_lengths": [186, 143, 171, 202, 211, 185, 176, 170, 149, 242, 188, 177, 185, 230, 181, 207, 170, 186, 154, 194, 169, 171, 155, 175, 160, 171, 198, 213, 184, 226, 187, 169, 212, 211, 159, 193, 161, 247, 214, 163, 145, 154, 142, 157, 220, 168, 180, 150, 160, 185, 157, 174, 186, 161, 175, 163, 207, 203, 154, 149, 199, 224, 203, 165, 196, 163, 237, 167, 192, 143, 185, 188, 161, 180, 147, 231, 137, 184, 201, 245, 172, 183, 182, 247, 155, 180, 180, 190, 191, 185, 171, 225, 184, 171, 240, 198, 221, 165, 245, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2512094638913135, "mean_inference_ms": 0.9862301002572482, "mean_action_processing_ms": 0.0880807619271526, "mean_env_wait_ms": 0.49606829200038133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1921.6616249768103, "episode_reward_min": 1101.586032492101, "episode_reward_mean": 1427.970410034571, "episode_len_mean": 183.99, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1499.5615611792734, 1268.2105706898662, 1330.6697688204654, 1624.4233603306216, 1537.4210452940665, 1454.431710713842, 1450.5953576992474, 1470.7077185353266, 1320.3236214098456, 1728.6736168981429, 1468.9965870331882, 1445.2067226272995, 1437.5312192689516, 1624.7302767553401, 1415.493110672691, 1386.431781443682, 1193.7640147381126, 1351.819162762354, 1271.3251619058985, 1451.787399438579, 1324.0431631676772, 1340.0482688294285, 1226.1998403364805, 1252.4647892292, 1361.6032875013173, 1436.3683205011846, 1365.4778126324964, 1502.5479760027708, 1444.747510419758, 1729.328095071388, 1446.567543529869, 1422.657868565137, 1374.3479349117656, 1501.0628899547717, 1317.394462608856, 1535.3457332199891, 1379.0696005229067, 1517.2779860807577, 1551.4193911618843, 1400.908299519733, 1336.2805350036872, 1101.586032492101, 1327.889101612213, 1288.8101124068207, 1633.209380188921, 1230.9563525468095, 1408.6757762561572, 1384.1405732546934, 1183.1935353625295, 1436.6636621308492, 1257.0988251681474, 1312.3952110935095, 1322.9283517624604, 1409.369915618591, 1360.8744541532724, 1500.0156019580775, 1536.8235749417913, 1361.9900917808682, 1271.1632598412436, 1268.5968510632379, 1651.4267131073884, 1372.9203627102083, 1540.139849362341, 1394.041095640548, 1398.953209130868, 1327.7716392903585, 1684.366548999769, 1386.1772964920392, 1503.96017348335, 1392.4629326924698, 1476.7438596239622, 1294.417269739842, 1360.3514754260002, 1333.8556427723433, 1258.3069924578658, 1548.1100651677084, 1241.4341788160946, 1439.7030705654536, 1573.3717423111932, 1895.5943973254655, 1383.5879912954515, 1541.7303435920726, 1344.5139849925363, 1921.6616249768103, 1288.4581273623996, 1345.2054004031606, 1312.6008529397043, 1501.130412301389, 1325.019772633041, 1399.0428574211228, 1470.3997694763575, 1437.3760790617284, 1460.522479134231, 1460.1883013789193, 1720.2193584375702, 1578.0057817899033, 1678.9698082693058, 1366.2230186721588, 1762.645142743632, 1331.785640840202], "episode_lengths": [186, 143, 171, 202, 211, 185, 176, 170, 149, 242, 188, 177, 185, 230, 181, 207, 170, 186, 154, 194, 169, 171, 155, 175, 160, 171, 198, 213, 184, 226, 187, 169, 212, 211, 159, 193, 161, 247, 214, 163, 145, 154, 142, 157, 220, 168, 180, 150, 160, 185, 157, 174, 186, 161, 175, 163, 207, 203, 154, 149, 199, 224, 203, 165, 196, 163, 237, 167, 192, 143, 185, 188, 161, 180, 147, 231, 137, 184, 201, 245, 172, 183, 182, 247, 155, 180, 180, 190, 191, 185, 171, 225, 184, 171, 240, 198, 221, 165, 245, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2512094638913135, "mean_inference_ms": 0.9862301002572482, "mean_action_processing_ms": 0.0880807619271526, "mean_env_wait_ms": 0.49606829200038133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 7010.589, "sample_time_ms": 701.424, "load_time_ms": 0.496, "load_throughput": 8072567.002, "learn_time_ms": 6295.789, "learn_throughput": 635.345, "synch_weights_time_ms": 12.18}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 516, "training_iteration": 27, "trial_id": "2db34_00000", "date": "2023-04-30_16-59-13", "timestamp": 1682848753, "time_this_iter_s": 7.147482633590698, "time_total_s": 188.91337990760803, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 188.91337990760803, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 9.27, "ram_util_percent": 66.78999999999999}}
{"custom_metrics": {"dps_mean": 11927.06324660409, "dps_min": 9179.883604100847, "dps_max": 16013.846874806746}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4480571149497905, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.902697531382243, "policy_loss": -0.03719432191117116, "vf_loss": 9.935124787976665, "vf_explained_var": 0.013190197816459082, "kl": 0.01589015199888013, "entropy": 1.233833884744234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 1921.6616249768103, "episode_reward_min": 1101.586032492101, "episode_reward_mean": 1431.2475895924906, "episode_len_mean": 183.57, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 11927.06324660409, "dps_min": 9179.883604100847, "dps_max": 16013.846874806746}, "hist_stats": {"episode_reward": [1340.0482688294285, 1226.1998403364805, 1252.4647892292, 1361.6032875013173, 1436.3683205011846, 1365.4778126324964, 1502.5479760027708, 1444.747510419758, 1729.328095071388, 1446.567543529869, 1422.657868565137, 1374.3479349117656, 1501.0628899547717, 1317.394462608856, 1535.3457332199891, 1379.0696005229067, 1517.2779860807577, 1551.4193911618843, 1400.908299519733, 1336.2805350036872, 1101.586032492101, 1327.889101612213, 1288.8101124068207, 1633.209380188921, 1230.9563525468095, 1408.6757762561572, 1384.1405732546934, 1183.1935353625295, 1436.6636621308492, 1257.0988251681474, 1312.3952110935095, 1322.9283517624604, 1409.369915618591, 1360.8744541532724, 1500.0156019580775, 1536.8235749417913, 1361.9900917808682, 1271.1632598412436, 1268.5968510632379, 1651.4267131073884, 1372.9203627102083, 1540.139849362341, 1394.041095640548, 1398.953209130868, 1327.7716392903585, 1684.366548999769, 1386.1772964920392, 1503.96017348335, 1392.4629326924698, 1476.7438596239622, 1294.417269739842, 1360.3514754260002, 1333.8556427723433, 1258.3069924578658, 1548.1100651677084, 1241.4341788160946, 1439.7030705654536, 1573.3717423111932, 1895.5943973254655, 1383.5879912954515, 1541.7303435920726, 1344.5139849925363, 1921.6616249768103, 1288.4581273623996, 1345.2054004031606, 1312.6008529397043, 1501.130412301389, 1325.019772633041, 1399.0428574211228, 1470.3997694763575, 1437.3760790617284, 1460.522479134231, 1460.1883013789193, 1720.2193584375702, 1578.0057817899033, 1678.9698082693058, 1366.2230186721588, 1762.645142743632, 1331.785640840202, 1205.2025576865221, 1457.388605651618, 1453.8130461703001, 1295.0007677121612, 1222.6556339535846, 1458.8092282251773, 1446.6127218562756, 1656.4080342098089, 1588.0811626862499, 1226.3638430540777, 1621.8287171396648, 1389.6994710615402, 1338.5471396264202, 1733.937526041809, 1605.2509183233544, 1249.541759175664, 1497.174664404522, 1266.9461912103025, 1631.656654201393, 1367.2786181169508, 1671.6676266690454], "episode_lengths": [171, 155, 175, 160, 171, 198, 213, 184, 226, 187, 169, 212, 211, 159, 193, 161, 247, 214, 163, 145, 154, 142, 157, 220, 168, 180, 150, 160, 185, 157, 174, 186, 161, 175, 163, 207, 203, 154, 149, 199, 224, 203, 165, 196, 163, 237, 167, 192, 143, 185, 188, 161, 180, 147, 231, 137, 184, 201, 245, 172, 183, 182, 247, 155, 180, 180, 190, 191, 185, 171, 225, 184, 171, 240, 198, 221, 165, 245, 131, 156, 192, 165, 148, 133, 180, 172, 231, 216, 140, 207, 163, 161, 229, 231, 159, 198, 163, 208, 187, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2514792157489543, "mean_inference_ms": 0.9859919915442384, "mean_action_processing_ms": 0.08814638682134715, "mean_env_wait_ms": 0.495949258895221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1921.6616249768103, "episode_reward_min": 1101.586032492101, "episode_reward_mean": 1431.2475895924906, "episode_len_mean": 183.57, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1340.0482688294285, 1226.1998403364805, 1252.4647892292, 1361.6032875013173, 1436.3683205011846, 1365.4778126324964, 1502.5479760027708, 1444.747510419758, 1729.328095071388, 1446.567543529869, 1422.657868565137, 1374.3479349117656, 1501.0628899547717, 1317.394462608856, 1535.3457332199891, 1379.0696005229067, 1517.2779860807577, 1551.4193911618843, 1400.908299519733, 1336.2805350036872, 1101.586032492101, 1327.889101612213, 1288.8101124068207, 1633.209380188921, 1230.9563525468095, 1408.6757762561572, 1384.1405732546934, 1183.1935353625295, 1436.6636621308492, 1257.0988251681474, 1312.3952110935095, 1322.9283517624604, 1409.369915618591, 1360.8744541532724, 1500.0156019580775, 1536.8235749417913, 1361.9900917808682, 1271.1632598412436, 1268.5968510632379, 1651.4267131073884, 1372.9203627102083, 1540.139849362341, 1394.041095640548, 1398.953209130868, 1327.7716392903585, 1684.366548999769, 1386.1772964920392, 1503.96017348335, 1392.4629326924698, 1476.7438596239622, 1294.417269739842, 1360.3514754260002, 1333.8556427723433, 1258.3069924578658, 1548.1100651677084, 1241.4341788160946, 1439.7030705654536, 1573.3717423111932, 1895.5943973254655, 1383.5879912954515, 1541.7303435920726, 1344.5139849925363, 1921.6616249768103, 1288.4581273623996, 1345.2054004031606, 1312.6008529397043, 1501.130412301389, 1325.019772633041, 1399.0428574211228, 1470.3997694763575, 1437.3760790617284, 1460.522479134231, 1460.1883013789193, 1720.2193584375702, 1578.0057817899033, 1678.9698082693058, 1366.2230186721588, 1762.645142743632, 1331.785640840202, 1205.2025576865221, 1457.388605651618, 1453.8130461703001, 1295.0007677121612, 1222.6556339535846, 1458.8092282251773, 1446.6127218562756, 1656.4080342098089, 1588.0811626862499, 1226.3638430540777, 1621.8287171396648, 1389.6994710615402, 1338.5471396264202, 1733.937526041809, 1605.2509183233544, 1249.541759175664, 1497.174664404522, 1266.9461912103025, 1631.656654201393, 1367.2786181169508, 1671.6676266690454], "episode_lengths": [171, 155, 175, 160, 171, 198, 213, 184, 226, 187, 169, 212, 211, 159, 193, 161, 247, 214, 163, 145, 154, 142, 157, 220, 168, 180, 150, 160, 185, 157, 174, 186, 161, 175, 163, 207, 203, 154, 149, 199, 224, 203, 165, 196, 163, 237, 167, 192, 143, 185, 188, 161, 180, 147, 231, 137, 184, 201, 245, 172, 183, 182, 247, 155, 180, 180, 190, 191, 185, 171, 225, 184, 171, 240, 198, 221, 165, 245, 131, 156, 192, 165, 148, 133, 180, 172, 231, 216, 140, 207, 163, 161, 229, 231, 159, 198, 163, 208, 187, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2514792157489543, "mean_inference_ms": 0.9859919915442384, "mean_action_processing_ms": 0.08814638682134715, "mean_env_wait_ms": 0.495949258895221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 6993.52, "sample_time_ms": 702.611, "load_time_ms": 0.399, "load_throughput": 10033619.999, "learn_time_ms": 6277.629, "learn_throughput": 637.183, "synch_weights_time_ms": 12.18}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 537, "training_iteration": 28, "trial_id": "2db34_00000", "date": "2023-04-30_16-59-20", "timestamp": 1682848760, "time_this_iter_s": 6.893743276596069, "time_total_s": 195.8071231842041, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 195.8071231842041, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 9.655555555555557, "ram_util_percent": 66.85555555555555}}
{"custom_metrics": {"dps_mean": 12143.790993858785, "dps_min": 9859.946128021076, "dps_max": 17712.09467260928}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.410605759261757, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.904313124379804, "policy_loss": -0.03441958673578757, "vf_loss": 9.935190395642353, "vf_explained_var": 0.015653897357243363, "kl": 0.011807714362060245, "entropy": 1.2955829607543126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 2125.451360713113, "episode_reward_min": 1183.1935353625295, "episode_reward_mean": 1457.2549192630543, "episode_len_mean": 184.48, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12143.790993858785, "dps_min": 9859.946128021076, "dps_max": 17712.09467260928}, "hist_stats": {"episode_reward": [1633.209380188921, 1230.9563525468095, 1408.6757762561572, 1384.1405732546934, 1183.1935353625295, 1436.6636621308492, 1257.0988251681474, 1312.3952110935095, 1322.9283517624604, 1409.369915618591, 1360.8744541532724, 1500.0156019580775, 1536.8235749417913, 1361.9900917808682, 1271.1632598412436, 1268.5968510632379, 1651.4267131073884, 1372.9203627102083, 1540.139849362341, 1394.041095640548, 1398.953209130868, 1327.7716392903585, 1684.366548999769, 1386.1772964920392, 1503.96017348335, 1392.4629326924698, 1476.7438596239622, 1294.417269739842, 1360.3514754260002, 1333.8556427723433, 1258.3069924578658, 1548.1100651677084, 1241.4341788160946, 1439.7030705654536, 1573.3717423111932, 1895.5943973254655, 1383.5879912954515, 1541.7303435920726, 1344.5139849925363, 1921.6616249768103, 1288.4581273623996, 1345.2054004031606, 1312.6008529397043, 1501.130412301389, 1325.019772633041, 1399.0428574211228, 1470.3997694763575, 1437.3760790617284, 1460.522479134231, 1460.1883013789193, 1720.2193584375702, 1578.0057817899033, 1678.9698082693058, 1366.2230186721588, 1762.645142743632, 1331.785640840202, 1205.2025576865221, 1457.388605651618, 1453.8130461703001, 1295.0007677121612, 1222.6556339535846, 1458.8092282251773, 1446.6127218562756, 1656.4080342098089, 1588.0811626862499, 1226.3638430540777, 1621.8287171396648, 1389.6994710615402, 1338.5471396264202, 1733.937526041809, 1605.2509183233544, 1249.541759175664, 1497.174664404522, 1266.9461912103025, 1631.656654201393, 1367.2786181169508, 1671.6676266690454, 2125.451360713113, 1620.1198247158604, 1707.8704374519305, 1588.8519466862174, 1744.7927477704945, 1340.8640837702003, 1236.6604307899013, 1670.5800009599711, 1192.071709644505, 1425.682349930747, 1196.6015210018406, 1437.763942404465, 1718.16221095513, 1601.5224480223897, 1682.4788375629528, 1472.0068454908794, 1643.3480821753053, 1506.7146841668064, 1497.0562575479046, 1307.1263324876722, 1335.6503565219293, 1238.2834331112615, 1470.476515289395], "episode_lengths": [220, 168, 180, 150, 160, 185, 157, 174, 186, 161, 175, 163, 207, 203, 154, 149, 199, 224, 203, 165, 196, 163, 237, 167, 192, 143, 185, 188, 161, 180, 147, 231, 137, 184, 201, 245, 172, 183, 182, 247, 155, 180, 180, 190, 191, 185, 171, 225, 184, 171, 240, 198, 221, 165, 245, 131, 156, 192, 165, 148, 133, 180, 172, 231, 216, 140, 207, 163, 161, 229, 231, 159, 198, 163, 208, 187, 195, 320, 195, 221, 184, 224, 169, 126, 180, 140, 149, 137, 187, 214, 203, 230, 168, 210, 194, 172, 191, 150, 142, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25179233740507984, "mean_inference_ms": 0.9869644795545633, "mean_action_processing_ms": 0.08826096040418889, "mean_env_wait_ms": 0.49645214819658157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 2125.451360713113, "episode_reward_min": 1183.1935353625295, "episode_reward_mean": 1457.2549192630543, "episode_len_mean": 184.48, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1633.209380188921, 1230.9563525468095, 1408.6757762561572, 1384.1405732546934, 1183.1935353625295, 1436.6636621308492, 1257.0988251681474, 1312.3952110935095, 1322.9283517624604, 1409.369915618591, 1360.8744541532724, 1500.0156019580775, 1536.8235749417913, 1361.9900917808682, 1271.1632598412436, 1268.5968510632379, 1651.4267131073884, 1372.9203627102083, 1540.139849362341, 1394.041095640548, 1398.953209130868, 1327.7716392903585, 1684.366548999769, 1386.1772964920392, 1503.96017348335, 1392.4629326924698, 1476.7438596239622, 1294.417269739842, 1360.3514754260002, 1333.8556427723433, 1258.3069924578658, 1548.1100651677084, 1241.4341788160946, 1439.7030705654536, 1573.3717423111932, 1895.5943973254655, 1383.5879912954515, 1541.7303435920726, 1344.5139849925363, 1921.6616249768103, 1288.4581273623996, 1345.2054004031606, 1312.6008529397043, 1501.130412301389, 1325.019772633041, 1399.0428574211228, 1470.3997694763575, 1437.3760790617284, 1460.522479134231, 1460.1883013789193, 1720.2193584375702, 1578.0057817899033, 1678.9698082693058, 1366.2230186721588, 1762.645142743632, 1331.785640840202, 1205.2025576865221, 1457.388605651618, 1453.8130461703001, 1295.0007677121612, 1222.6556339535846, 1458.8092282251773, 1446.6127218562756, 1656.4080342098089, 1588.0811626862499, 1226.3638430540777, 1621.8287171396648, 1389.6994710615402, 1338.5471396264202, 1733.937526041809, 1605.2509183233544, 1249.541759175664, 1497.174664404522, 1266.9461912103025, 1631.656654201393, 1367.2786181169508, 1671.6676266690454, 2125.451360713113, 1620.1198247158604, 1707.8704374519305, 1588.8519466862174, 1744.7927477704945, 1340.8640837702003, 1236.6604307899013, 1670.5800009599711, 1192.071709644505, 1425.682349930747, 1196.6015210018406, 1437.763942404465, 1718.16221095513, 1601.5224480223897, 1682.4788375629528, 1472.0068454908794, 1643.3480821753053, 1506.7146841668064, 1497.0562575479046, 1307.1263324876722, 1335.6503565219293, 1238.2834331112615, 1470.476515289395], "episode_lengths": [220, 168, 180, 150, 160, 185, 157, 174, 186, 161, 175, 163, 207, 203, 154, 149, 199, 224, 203, 165, 196, 163, 237, 167, 192, 143, 185, 188, 161, 180, 147, 231, 137, 184, 201, 245, 172, 183, 182, 247, 155, 180, 180, 190, 191, 185, 171, 225, 184, 171, 240, 198, 221, 165, 245, 131, 156, 192, 165, 148, 133, 180, 172, 231, 216, 140, 207, 163, 161, 229, 231, 159, 198, 163, 208, 187, 195, 320, 195, 221, 184, 224, 169, 126, 180, 140, 149, 137, 187, 214, 203, 230, 168, 210, 194, 172, 191, 150, 142, 152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25179233740507984, "mean_inference_ms": 0.9869644795545633, "mean_action_processing_ms": 0.08826096040418889, "mean_env_wait_ms": 0.49645214819658157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 6999.708, "sample_time_ms": 710.567, "load_time_ms": 0.447, "load_throughput": 8951190.311, "learn_time_ms": 6276.008, "learn_throughput": 637.348, "synch_weights_time_ms": 12.085}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 560, "training_iteration": 29, "trial_id": "2db34_00000", "date": "2023-04-30_16-59-27", "timestamp": 1682848767, "time_this_iter_s": 7.043792009353638, "time_total_s": 202.85091519355774, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 202.85091519355774, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 10.38, "ram_util_percent": 66.82999999999998}}
{"custom_metrics": {"dps_mean": 12115.076576349626, "dps_min": 9896.920983244903, "dps_max": 17712.09467260928}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.802545302529488, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.883221523736113, "policy_loss": -0.039140594638483496, "vf_loss": 9.91791757870746, "vf_explained_var": 0.012614644727399272, "kl": 0.014815155975036116, "entropy": 1.1646696547667186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 2125.451360713113, "episode_reward_min": 1187.6305179893882, "episode_reward_mean": 1453.8091891619554, "episode_len_mean": 182.26, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12115.076576349626, "dps_min": 9896.920983244903, "dps_max": 17712.09467260928}, "hist_stats": {"episode_reward": [1684.366548999769, 1386.1772964920392, 1503.96017348335, 1392.4629326924698, 1476.7438596239622, 1294.417269739842, 1360.3514754260002, 1333.8556427723433, 1258.3069924578658, 1548.1100651677084, 1241.4341788160946, 1439.7030705654536, 1573.3717423111932, 1895.5943973254655, 1383.5879912954515, 1541.7303435920726, 1344.5139849925363, 1921.6616249768103, 1288.4581273623996, 1345.2054004031606, 1312.6008529397043, 1501.130412301389, 1325.019772633041, 1399.0428574211228, 1470.3997694763575, 1437.3760790617284, 1460.522479134231, 1460.1883013789193, 1720.2193584375702, 1578.0057817899033, 1678.9698082693058, 1366.2230186721588, 1762.645142743632, 1331.785640840202, 1205.2025576865221, 1457.388605651618, 1453.8130461703001, 1295.0007677121612, 1222.6556339535846, 1458.8092282251773, 1446.6127218562756, 1656.4080342098089, 1588.0811626862499, 1226.3638430540777, 1621.8287171396648, 1389.6994710615402, 1338.5471396264202, 1733.937526041809, 1605.2509183233544, 1249.541759175664, 1497.174664404522, 1266.9461912103025, 1631.656654201393, 1367.2786181169508, 1671.6676266690454, 2125.451360713113, 1620.1198247158604, 1707.8704374519305, 1588.8519466862174, 1744.7927477704945, 1340.8640837702003, 1236.6604307899013, 1670.5800009599711, 1192.071709644505, 1425.682349930747, 1196.6015210018406, 1437.763942404465, 1718.16221095513, 1601.5224480223897, 1682.4788375629528, 1472.0068454908794, 1643.3480821753053, 1506.7146841668064, 1497.0562575479046, 1307.1263324876722, 1335.6503565219293, 1238.2834331112615, 1470.476515289395, 1187.6305179893882, 1538.8908132777074, 1313.8802282290872, 1340.5511182100395, 1257.4828179739186, 1429.7373944052333, 1423.8580015371642, 1484.661783434859, 1377.5571043276123, 1441.4710913471747, 1362.9582362875997, 1207.7307979739137, 1251.254552299555, 1581.4676838571063, 1292.4477308961145, 1285.5427577722162, 1305.9354061689955, 1408.2929250323075, 1389.4155852581787, 1455.6444689490627, 1517.1978321113568, 1365.1664289143691], "episode_lengths": [237, 167, 192, 143, 185, 188, 161, 180, 147, 231, 137, 184, 201, 245, 172, 183, 182, 247, 155, 180, 180, 190, 191, 185, 171, 225, 184, 171, 240, 198, 221, 165, 245, 131, 156, 192, 165, 148, 133, 180, 172, 231, 216, 140, 207, 163, 161, 229, 231, 159, 198, 163, 208, 187, 195, 320, 195, 221, 184, 224, 169, 126, 180, 140, 149, 137, 187, 214, 203, 230, 168, 210, 194, 172, 191, 150, 142, 152, 142, 184, 139, 152, 174, 165, 171, 175, 174, 183, 195, 140, 146, 182, 160, 134, 161, 185, 190, 196, 215, 157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2519323592588737, "mean_inference_ms": 0.9874605640295442, "mean_action_processing_ms": 0.08825894688775282, "mean_env_wait_ms": 0.49676634185737795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 2125.451360713113, "episode_reward_min": 1187.6305179893882, "episode_reward_mean": 1453.8091891619554, "episode_len_mean": 182.26, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1684.366548999769, 1386.1772964920392, 1503.96017348335, 1392.4629326924698, 1476.7438596239622, 1294.417269739842, 1360.3514754260002, 1333.8556427723433, 1258.3069924578658, 1548.1100651677084, 1241.4341788160946, 1439.7030705654536, 1573.3717423111932, 1895.5943973254655, 1383.5879912954515, 1541.7303435920726, 1344.5139849925363, 1921.6616249768103, 1288.4581273623996, 1345.2054004031606, 1312.6008529397043, 1501.130412301389, 1325.019772633041, 1399.0428574211228, 1470.3997694763575, 1437.3760790617284, 1460.522479134231, 1460.1883013789193, 1720.2193584375702, 1578.0057817899033, 1678.9698082693058, 1366.2230186721588, 1762.645142743632, 1331.785640840202, 1205.2025576865221, 1457.388605651618, 1453.8130461703001, 1295.0007677121612, 1222.6556339535846, 1458.8092282251773, 1446.6127218562756, 1656.4080342098089, 1588.0811626862499, 1226.3638430540777, 1621.8287171396648, 1389.6994710615402, 1338.5471396264202, 1733.937526041809, 1605.2509183233544, 1249.541759175664, 1497.174664404522, 1266.9461912103025, 1631.656654201393, 1367.2786181169508, 1671.6676266690454, 2125.451360713113, 1620.1198247158604, 1707.8704374519305, 1588.8519466862174, 1744.7927477704945, 1340.8640837702003, 1236.6604307899013, 1670.5800009599711, 1192.071709644505, 1425.682349930747, 1196.6015210018406, 1437.763942404465, 1718.16221095513, 1601.5224480223897, 1682.4788375629528, 1472.0068454908794, 1643.3480821753053, 1506.7146841668064, 1497.0562575479046, 1307.1263324876722, 1335.6503565219293, 1238.2834331112615, 1470.476515289395, 1187.6305179893882, 1538.8908132777074, 1313.8802282290872, 1340.5511182100395, 1257.4828179739186, 1429.7373944052333, 1423.8580015371642, 1484.661783434859, 1377.5571043276123, 1441.4710913471747, 1362.9582362875997, 1207.7307979739137, 1251.254552299555, 1581.4676838571063, 1292.4477308961145, 1285.5427577722162, 1305.9354061689955, 1408.2929250323075, 1389.4155852581787, 1455.6444689490627, 1517.1978321113568, 1365.1664289143691], "episode_lengths": [237, 167, 192, 143, 185, 188, 161, 180, 147, 231, 137, 184, 201, 245, 172, 183, 182, 247, 155, 180, 180, 190, 191, 185, 171, 225, 184, 171, 240, 198, 221, 165, 245, 131, 156, 192, 165, 148, 133, 180, 172, 231, 216, 140, 207, 163, 161, 229, 231, 159, 198, 163, 208, 187, 195, 320, 195, 221, 184, 224, 169, 126, 180, 140, 149, 137, 187, 214, 203, 230, 168, 210, 194, 172, 191, 150, 142, 152, 142, 184, 139, 152, 174, 165, 171, 175, 174, 183, 195, 140, 146, 182, 160, 134, 161, 185, 190, 196, 215, 157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2519323592588737, "mean_inference_ms": 0.9874605640295442, "mean_action_processing_ms": 0.08825894688775282, "mean_env_wait_ms": 0.49676634185737795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 6976.364, "sample_time_ms": 712.837, "load_time_ms": 0.447, "load_throughput": 8951190.311, "learn_time_ms": 6250.397, "learn_throughput": 639.959, "synch_weights_time_ms": 12.083}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 582, "training_iteration": 30, "trial_id": "2db34_00000", "date": "2023-04-30_16-59-34", "timestamp": 1682848774, "time_this_iter_s": 6.936935901641846, "time_total_s": 209.78785109519958, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 209.78785109519958, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 9.18, "ram_util_percent": 66.9}}
{"custom_metrics": {"dps_mean": 12170.000005634682, "dps_min": 9896.920983244903, "dps_max": 17712.09467260928}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.6077574362037, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.853390300914805, "policy_loss": -0.032288253664850226, "vf_loss": 9.88270341709096, "vf_explained_var": 0.0198034663995107, "kl": 0.009917249675118377, "entropy": 1.0500696739201905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 2125.451360713113, "episode_reward_min": 1187.6305179893882, "episode_reward_mean": 1460.4000006761614, "episode_len_mean": 182.21, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12170.000005634682, "dps_min": 9896.920983244903, "dps_max": 17712.09467260928}, "hist_stats": {"episode_reward": [1501.130412301389, 1325.019772633041, 1399.0428574211228, 1470.3997694763575, 1437.3760790617284, 1460.522479134231, 1460.1883013789193, 1720.2193584375702, 1578.0057817899033, 1678.9698082693058, 1366.2230186721588, 1762.645142743632, 1331.785640840202, 1205.2025576865221, 1457.388605651618, 1453.8130461703001, 1295.0007677121612, 1222.6556339535846, 1458.8092282251773, 1446.6127218562756, 1656.4080342098089, 1588.0811626862499, 1226.3638430540777, 1621.8287171396648, 1389.6994710615402, 1338.5471396264202, 1733.937526041809, 1605.2509183233544, 1249.541759175664, 1497.174664404522, 1266.9461912103025, 1631.656654201393, 1367.2786181169508, 1671.6676266690454, 2125.451360713113, 1620.1198247158604, 1707.8704374519305, 1588.8519466862174, 1744.7927477704945, 1340.8640837702003, 1236.6604307899013, 1670.5800009599711, 1192.071709644505, 1425.682349930747, 1196.6015210018406, 1437.763942404465, 1718.16221095513, 1601.5224480223897, 1682.4788375629528, 1472.0068454908794, 1643.3480821753053, 1506.7146841668064, 1497.0562575479046, 1307.1263324876722, 1335.6503565219293, 1238.2834331112615, 1470.476515289395, 1187.6305179893882, 1538.8908132777074, 1313.8802282290872, 1340.5511182100395, 1257.4828179739186, 1429.7373944052333, 1423.8580015371642, 1484.661783434859, 1377.5571043276123, 1441.4710913471747, 1362.9582362875997, 1207.7307979739137, 1251.254552299555, 1581.4676838571063, 1292.4477308961145, 1285.5427577722162, 1305.9354061689955, 1408.2929250323075, 1389.4155852581787, 1455.6444689490627, 1517.1978321113568, 1365.1664289143691, 1480.9788228381592, 1356.5483896234189, 1501.0378553149776, 1621.322030748405, 1417.9503708330294, 1550.6815413587606, 1541.8915679076804, 1258.267978604665, 1733.8726824686541, 1628.0503559701992, 1918.8496484591867, 1265.6932953455735, 1214.2252769990084, 1554.0555359007337, 1383.0669644272923, 1397.564897819814, 1230.7970309242469, 1579.0709436338173, 1276.2373599131577, 1417.0551709995375, 1858.4774027659685], "episode_lengths": [190, 191, 185, 171, 225, 184, 171, 240, 198, 221, 165, 245, 131, 156, 192, 165, 148, 133, 180, 172, 231, 216, 140, 207, 163, 161, 229, 231, 159, 198, 163, 208, 187, 195, 320, 195, 221, 184, 224, 169, 126, 180, 140, 149, 137, 187, 214, 203, 230, 168, 210, 194, 172, 191, 150, 142, 152, 142, 184, 139, 152, 174, 165, 171, 175, 174, 183, 195, 140, 146, 182, 160, 134, 161, 185, 190, 196, 215, 157, 177, 176, 200, 208, 192, 207, 199, 141, 203, 188, 249, 183, 160, 204, 197, 181, 121, 167, 145, 147, 247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25225028567255786, "mean_inference_ms": 0.9883321750937639, "mean_action_processing_ms": 0.08818778555319334, "mean_env_wait_ms": 0.49698357483116085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 2125.451360713113, "episode_reward_min": 1187.6305179893882, "episode_reward_mean": 1460.4000006761614, "episode_len_mean": 182.21, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1501.130412301389, 1325.019772633041, 1399.0428574211228, 1470.3997694763575, 1437.3760790617284, 1460.522479134231, 1460.1883013789193, 1720.2193584375702, 1578.0057817899033, 1678.9698082693058, 1366.2230186721588, 1762.645142743632, 1331.785640840202, 1205.2025576865221, 1457.388605651618, 1453.8130461703001, 1295.0007677121612, 1222.6556339535846, 1458.8092282251773, 1446.6127218562756, 1656.4080342098089, 1588.0811626862499, 1226.3638430540777, 1621.8287171396648, 1389.6994710615402, 1338.5471396264202, 1733.937526041809, 1605.2509183233544, 1249.541759175664, 1497.174664404522, 1266.9461912103025, 1631.656654201393, 1367.2786181169508, 1671.6676266690454, 2125.451360713113, 1620.1198247158604, 1707.8704374519305, 1588.8519466862174, 1744.7927477704945, 1340.8640837702003, 1236.6604307899013, 1670.5800009599711, 1192.071709644505, 1425.682349930747, 1196.6015210018406, 1437.763942404465, 1718.16221095513, 1601.5224480223897, 1682.4788375629528, 1472.0068454908794, 1643.3480821753053, 1506.7146841668064, 1497.0562575479046, 1307.1263324876722, 1335.6503565219293, 1238.2834331112615, 1470.476515289395, 1187.6305179893882, 1538.8908132777074, 1313.8802282290872, 1340.5511182100395, 1257.4828179739186, 1429.7373944052333, 1423.8580015371642, 1484.661783434859, 1377.5571043276123, 1441.4710913471747, 1362.9582362875997, 1207.7307979739137, 1251.254552299555, 1581.4676838571063, 1292.4477308961145, 1285.5427577722162, 1305.9354061689955, 1408.2929250323075, 1389.4155852581787, 1455.6444689490627, 1517.1978321113568, 1365.1664289143691, 1480.9788228381592, 1356.5483896234189, 1501.0378553149776, 1621.322030748405, 1417.9503708330294, 1550.6815413587606, 1541.8915679076804, 1258.267978604665, 1733.8726824686541, 1628.0503559701992, 1918.8496484591867, 1265.6932953455735, 1214.2252769990084, 1554.0555359007337, 1383.0669644272923, 1397.564897819814, 1230.7970309242469, 1579.0709436338173, 1276.2373599131577, 1417.0551709995375, 1858.4774027659685], "episode_lengths": [190, 191, 185, 171, 225, 184, 171, 240, 198, 221, 165, 245, 131, 156, 192, 165, 148, 133, 180, 172, 231, 216, 140, 207, 163, 161, 229, 231, 159, 198, 163, 208, 187, 195, 320, 195, 221, 184, 224, 169, 126, 180, 140, 149, 137, 187, 214, 203, 230, 168, 210, 194, 172, 191, 150, 142, 152, 142, 184, 139, 152, 174, 165, 171, 175, 174, 183, 195, 140, 146, 182, 160, 134, 161, 185, 190, 196, 215, 157, 177, 176, 200, 208, 192, 207, 199, 141, 203, 188, 249, 183, 160, 204, 197, 181, 121, 167, 145, 147, 247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25225028567255786, "mean_inference_ms": 0.9883321750937639, "mean_action_processing_ms": 0.08818778555319334, "mean_env_wait_ms": 0.49698357483116085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 6997.104, "sample_time_ms": 704.242, "load_time_ms": 0.454, "load_throughput": 8814803.762, "learn_time_ms": 6279.752, "learn_throughput": 636.968, "synch_weights_time_ms": 11.96}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 603, "training_iteration": 31, "trial_id": "2db34_00000", "date": "2023-04-30_16-59-41", "timestamp": 1682848781, "time_this_iter_s": 7.135054349899292, "time_total_s": 216.92290544509888, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 216.92290544509888, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 9.149999999999999, "ram_util_percent": 67.16}}
{"custom_metrics": {"dps_mean": 12374.790902154202, "dps_min": 9896.920983244903, "dps_max": 17881.671584443517}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.51825108887047, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.86114239949052, "policy_loss": -0.03654925523110495, "vf_loss": 9.89254970037809, "vf_explained_var": 0.01776311544961827, "kl": 0.017139858737657988, "entropy": 1.0819797056977467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 2145.800590133221, "episode_reward_min": 1187.6305179893882, "episode_reward_mean": 1484.974908258504, "episode_len_mean": 184.21, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12374.790902154202, "dps_min": 9896.920983244903, "dps_max": 17881.671584443517}, "hist_stats": {"episode_reward": [1226.3638430540777, 1621.8287171396648, 1389.6994710615402, 1338.5471396264202, 1733.937526041809, 1605.2509183233544, 1249.541759175664, 1497.174664404522, 1266.9461912103025, 1631.656654201393, 1367.2786181169508, 1671.6676266690454, 2125.451360713113, 1620.1198247158604, 1707.8704374519305, 1588.8519466862174, 1744.7927477704945, 1340.8640837702003, 1236.6604307899013, 1670.5800009599711, 1192.071709644505, 1425.682349930747, 1196.6015210018406, 1437.763942404465, 1718.16221095513, 1601.5224480223897, 1682.4788375629528, 1472.0068454908794, 1643.3480821753053, 1506.7146841668064, 1497.0562575479046, 1307.1263324876722, 1335.6503565219293, 1238.2834331112615, 1470.476515289395, 1187.6305179893882, 1538.8908132777074, 1313.8802282290872, 1340.5511182100395, 1257.4828179739186, 1429.7373944052333, 1423.8580015371642, 1484.661783434859, 1377.5571043276123, 1441.4710913471747, 1362.9582362875997, 1207.7307979739137, 1251.254552299555, 1581.4676838571063, 1292.4477308961145, 1285.5427577722162, 1305.9354061689955, 1408.2929250323075, 1389.4155852581787, 1455.6444689490627, 1517.1978321113568, 1365.1664289143691, 1480.9788228381592, 1356.5483896234189, 1501.0378553149776, 1621.322030748405, 1417.9503708330294, 1550.6815413587606, 1541.8915679076804, 1258.267978604665, 1733.8726824686541, 1628.0503559701992, 1918.8496484591867, 1265.6932953455735, 1214.2252769990084, 1554.0555359007337, 1383.0669644272923, 1397.564897819814, 1230.7970309242469, 1579.0709436338173, 1276.2373599131577, 1417.0551709995375, 1858.4774027659685, 1739.855911298859, 1526.537964775866, 2058.024044818584, 1494.851024339748, 1712.6294074401028, 1562.8671378533086, 1511.476528970853, 1252.031981770433, 1636.6991626670501, 1448.1978766002023, 1632.0304042526705, 1483.1706484772249, 2145.800590133221, 1512.830802132328, 1522.3958000557304, 1425.927974710849, 1501.1388158306522, 1591.7640315306141, 1474.6101810984433, 1676.0973980407405, 1436.0731290281099, 1387.9801227199587], "episode_lengths": [140, 207, 163, 161, 229, 231, 159, 198, 163, 208, 187, 195, 320, 195, 221, 184, 224, 169, 126, 180, 140, 149, 137, 187, 214, 203, 230, 168, 210, 194, 172, 191, 150, 142, 152, 142, 184, 139, 152, 174, 165, 171, 175, 174, 183, 195, 140, 146, 182, 160, 134, 161, 185, 190, 196, 215, 157, 177, 176, 200, 208, 192, 207, 199, 141, 203, 188, 249, 183, 160, 204, 197, 181, 121, 167, 145, 147, 247, 230, 179, 281, 182, 225, 179, 203, 137, 213, 167, 191, 174, 305, 167, 204, 167, 179, 225, 188, 208, 160, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25256816691692274, "mean_inference_ms": 0.9889297777535729, "mean_action_processing_ms": 0.08815393071490313, "mean_env_wait_ms": 0.4974593546039956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 2145.800590133221, "episode_reward_min": 1187.6305179893882, "episode_reward_mean": 1484.974908258504, "episode_len_mean": 184.21, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1226.3638430540777, 1621.8287171396648, 1389.6994710615402, 1338.5471396264202, 1733.937526041809, 1605.2509183233544, 1249.541759175664, 1497.174664404522, 1266.9461912103025, 1631.656654201393, 1367.2786181169508, 1671.6676266690454, 2125.451360713113, 1620.1198247158604, 1707.8704374519305, 1588.8519466862174, 1744.7927477704945, 1340.8640837702003, 1236.6604307899013, 1670.5800009599711, 1192.071709644505, 1425.682349930747, 1196.6015210018406, 1437.763942404465, 1718.16221095513, 1601.5224480223897, 1682.4788375629528, 1472.0068454908794, 1643.3480821753053, 1506.7146841668064, 1497.0562575479046, 1307.1263324876722, 1335.6503565219293, 1238.2834331112615, 1470.476515289395, 1187.6305179893882, 1538.8908132777074, 1313.8802282290872, 1340.5511182100395, 1257.4828179739186, 1429.7373944052333, 1423.8580015371642, 1484.661783434859, 1377.5571043276123, 1441.4710913471747, 1362.9582362875997, 1207.7307979739137, 1251.254552299555, 1581.4676838571063, 1292.4477308961145, 1285.5427577722162, 1305.9354061689955, 1408.2929250323075, 1389.4155852581787, 1455.6444689490627, 1517.1978321113568, 1365.1664289143691, 1480.9788228381592, 1356.5483896234189, 1501.0378553149776, 1621.322030748405, 1417.9503708330294, 1550.6815413587606, 1541.8915679076804, 1258.267978604665, 1733.8726824686541, 1628.0503559701992, 1918.8496484591867, 1265.6932953455735, 1214.2252769990084, 1554.0555359007337, 1383.0669644272923, 1397.564897819814, 1230.7970309242469, 1579.0709436338173, 1276.2373599131577, 1417.0551709995375, 1858.4774027659685, 1739.855911298859, 1526.537964775866, 2058.024044818584, 1494.851024339748, 1712.6294074401028, 1562.8671378533086, 1511.476528970853, 1252.031981770433, 1636.6991626670501, 1448.1978766002023, 1632.0304042526705, 1483.1706484772249, 2145.800590133221, 1512.830802132328, 1522.3958000557304, 1425.927974710849, 1501.1388158306522, 1591.7640315306141, 1474.6101810984433, 1676.0973980407405, 1436.0731290281099, 1387.9801227199587], "episode_lengths": [140, 207, 163, 161, 229, 231, 159, 198, 163, 208, 187, 195, 320, 195, 221, 184, 224, 169, 126, 180, 140, 149, 137, 187, 214, 203, 230, 168, 210, 194, 172, 191, 150, 142, 152, 142, 184, 139, 152, 174, 165, 171, 175, 174, 183, 195, 140, 146, 182, 160, 134, 161, 185, 190, 196, 215, 157, 177, 176, 200, 208, 192, 207, 199, 141, 203, 188, 249, 183, 160, 204, 197, 181, 121, 167, 145, 147, 247, 230, 179, 281, 182, 225, 179, 203, 137, 213, 167, 191, 174, 305, 167, 204, 167, 179, 225, 188, 208, 160, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25256816691692274, "mean_inference_ms": 0.9889297777535729, "mean_action_processing_ms": 0.08815393071490313, "mean_env_wait_ms": 0.4974593546039956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 7024.032, "sample_time_ms": 712.09, "load_time_ms": 0.554, "load_throughput": 7220043.896, "learn_time_ms": 6298.834, "learn_throughput": 635.038, "synch_weights_time_ms": 11.959}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 625, "training_iteration": 32, "trial_id": "2db34_00000", "date": "2023-04-30_16-59-48", "timestamp": 1682848788, "time_this_iter_s": 7.171855211257935, "time_total_s": 224.0947606563568, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 224.0947606563568, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 10.889999999999999, "ram_util_percent": 67.75999999999999}}
{"custom_metrics": {"dps_mean": 12374.657930871594, "dps_min": 9896.920983244903, "dps_max": 17881.671584443517}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.733648560508605, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.871729430331978, "policy_loss": -0.03632206312100333, "vf_loss": 9.903215213488506, "vf_explained_var": 0.011082626158191312, "kl": 0.016120960157272247, "entropy": 1.121566568459234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 2145.800590133221, "episode_reward_min": 1187.6305179893882, "episode_reward_mean": 1484.9589517045908, "episode_len_mean": 185.12, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12374.657930871594, "dps_min": 9896.920983244903, "dps_max": 17881.671584443517}, "hist_stats": {"episode_reward": [1192.071709644505, 1425.682349930747, 1196.6015210018406, 1437.763942404465, 1718.16221095513, 1601.5224480223897, 1682.4788375629528, 1472.0068454908794, 1643.3480821753053, 1506.7146841668064, 1497.0562575479046, 1307.1263324876722, 1335.6503565219293, 1238.2834331112615, 1470.476515289395, 1187.6305179893882, 1538.8908132777074, 1313.8802282290872, 1340.5511182100395, 1257.4828179739186, 1429.7373944052333, 1423.8580015371642, 1484.661783434859, 1377.5571043276123, 1441.4710913471747, 1362.9582362875997, 1207.7307979739137, 1251.254552299555, 1581.4676838571063, 1292.4477308961145, 1285.5427577722162, 1305.9354061689955, 1408.2929250323075, 1389.4155852581787, 1455.6444689490627, 1517.1978321113568, 1365.1664289143691, 1480.9788228381592, 1356.5483896234189, 1501.0378553149776, 1621.322030748405, 1417.9503708330294, 1550.6815413587606, 1541.8915679076804, 1258.267978604665, 1733.8726824686541, 1628.0503559701992, 1918.8496484591867, 1265.6932953455735, 1214.2252769990084, 1554.0555359007337, 1383.0669644272923, 1397.564897819814, 1230.7970309242469, 1579.0709436338173, 1276.2373599131577, 1417.0551709995375, 1858.4774027659685, 1739.855911298859, 1526.537964775866, 2058.024044818584, 1494.851024339748, 1712.6294074401028, 1562.8671378533086, 1511.476528970853, 1252.031981770433, 1636.6991626670501, 1448.1978766002023, 1632.0304042526705, 1483.1706484772249, 2145.800590133221, 1512.830802132328, 1522.3958000557304, 1425.927974710849, 1501.1388158306522, 1591.7640315306141, 1474.6101810984433, 1676.0973980407405, 1436.0731290281099, 1387.9801227199587, 1448.4328340104198, 1192.2802295744154, 1849.349825998339, 1445.3310012102097, 1300.2921344453953, 1537.3638009759234, 1477.704128262383, 1804.1110913105083, 1674.4914430950462, 1669.4627565387914, 1553.455194553748, 1567.9572185759796, 1351.9221530380437, 1507.2834817053033, 1383.228171887263, 1677.1352153466114, 1386.8322603396596, 1487.0176273030604, 1448.6471688866864, 1871.1905694333434], "episode_lengths": [140, 149, 137, 187, 214, 203, 230, 168, 210, 194, 172, 191, 150, 142, 152, 142, 184, 139, 152, 174, 165, 171, 175, 174, 183, 195, 140, 146, 182, 160, 134, 161, 185, 190, 196, 215, 157, 177, 176, 200, 208, 192, 207, 199, 141, 203, 188, 249, 183, 160, 204, 197, 181, 121, 167, 145, 147, 247, 230, 179, 281, 182, 225, 179, 203, 137, 213, 167, 191, 174, 305, 167, 204, 167, 179, 225, 188, 208, 160, 146, 190, 146, 283, 193, 133, 216, 187, 257, 196, 206, 178, 215, 160, 195, 177, 214, 184, 191, 182, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25262113215031606, "mean_inference_ms": 0.9887377675566589, "mean_action_processing_ms": 0.08805022012803392, "mean_env_wait_ms": 0.49765967163708724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 2145.800590133221, "episode_reward_min": 1187.6305179893882, "episode_reward_mean": 1484.9589517045908, "episode_len_mean": 185.12, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1192.071709644505, 1425.682349930747, 1196.6015210018406, 1437.763942404465, 1718.16221095513, 1601.5224480223897, 1682.4788375629528, 1472.0068454908794, 1643.3480821753053, 1506.7146841668064, 1497.0562575479046, 1307.1263324876722, 1335.6503565219293, 1238.2834331112615, 1470.476515289395, 1187.6305179893882, 1538.8908132777074, 1313.8802282290872, 1340.5511182100395, 1257.4828179739186, 1429.7373944052333, 1423.8580015371642, 1484.661783434859, 1377.5571043276123, 1441.4710913471747, 1362.9582362875997, 1207.7307979739137, 1251.254552299555, 1581.4676838571063, 1292.4477308961145, 1285.5427577722162, 1305.9354061689955, 1408.2929250323075, 1389.4155852581787, 1455.6444689490627, 1517.1978321113568, 1365.1664289143691, 1480.9788228381592, 1356.5483896234189, 1501.0378553149776, 1621.322030748405, 1417.9503708330294, 1550.6815413587606, 1541.8915679076804, 1258.267978604665, 1733.8726824686541, 1628.0503559701992, 1918.8496484591867, 1265.6932953455735, 1214.2252769990084, 1554.0555359007337, 1383.0669644272923, 1397.564897819814, 1230.7970309242469, 1579.0709436338173, 1276.2373599131577, 1417.0551709995375, 1858.4774027659685, 1739.855911298859, 1526.537964775866, 2058.024044818584, 1494.851024339748, 1712.6294074401028, 1562.8671378533086, 1511.476528970853, 1252.031981770433, 1636.6991626670501, 1448.1978766002023, 1632.0304042526705, 1483.1706484772249, 2145.800590133221, 1512.830802132328, 1522.3958000557304, 1425.927974710849, 1501.1388158306522, 1591.7640315306141, 1474.6101810984433, 1676.0973980407405, 1436.0731290281099, 1387.9801227199587, 1448.4328340104198, 1192.2802295744154, 1849.349825998339, 1445.3310012102097, 1300.2921344453953, 1537.3638009759234, 1477.704128262383, 1804.1110913105083, 1674.4914430950462, 1669.4627565387914, 1553.455194553748, 1567.9572185759796, 1351.9221530380437, 1507.2834817053033, 1383.228171887263, 1677.1352153466114, 1386.8322603396596, 1487.0176273030604, 1448.6471688866864, 1871.1905694333434], "episode_lengths": [140, 149, 137, 187, 214, 203, 230, 168, 210, 194, 172, 191, 150, 142, 152, 142, 184, 139, 152, 174, 165, 171, 175, 174, 183, 195, 140, 146, 182, 160, 134, 161, 185, 190, 196, 215, 157, 177, 176, 200, 208, 192, 207, 199, 141, 203, 188, 249, 183, 160, 204, 197, 181, 121, 167, 145, 147, 247, 230, 179, 281, 182, 225, 179, 203, 137, 213, 167, 191, 174, 305, 167, 204, 167, 179, 225, 188, 208, 160, 146, 190, 146, 283, 193, 133, 216, 187, 257, 196, 206, 178, 215, 160, 195, 177, 214, 184, 191, 182, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25262113215031606, "mean_inference_ms": 0.9887377675566589, "mean_action_processing_ms": 0.08805022012803392, "mean_env_wait_ms": 0.49765967163708724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 7011.053, "sample_time_ms": 694.831, "load_time_ms": 0.606, "load_throughput": 6605983.384, "learn_time_ms": 6303.017, "learn_throughput": 634.617, "synch_weights_time_ms": 11.903}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 645, "training_iteration": 33, "trial_id": "2db34_00000", "date": "2023-04-30_16-59-55", "timestamp": 1682848795, "time_this_iter_s": 6.880580425262451, "time_total_s": 230.97534108161926, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 230.97534108161926, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 8.34, "ram_util_percent": 67.85999999999999}}
{"custom_metrics": {"dps_mean": 12516.137699324903, "dps_min": 9935.668579786794, "dps_max": 17881.671584443517}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.594116908504118, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.874367560109784, "policy_loss": -0.030486730900743317, "vf_loss": 9.901261022014003, "vf_explained_var": 0.008060985611331077, "kl": 0.011977555096335784, "entropy": 1.148430284793659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 2145.800590133221, "episode_reward_min": 1192.2802295744154, "episode_reward_mean": 1501.9365239189885, "episode_len_mean": 189.46, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12516.137699324903, "dps_min": 9935.668579786794, "dps_max": 17881.671584443517}, "hist_stats": {"episode_reward": [1423.8580015371642, 1484.661783434859, 1377.5571043276123, 1441.4710913471747, 1362.9582362875997, 1207.7307979739137, 1251.254552299555, 1581.4676838571063, 1292.4477308961145, 1285.5427577722162, 1305.9354061689955, 1408.2929250323075, 1389.4155852581787, 1455.6444689490627, 1517.1978321113568, 1365.1664289143691, 1480.9788228381592, 1356.5483896234189, 1501.0378553149776, 1621.322030748405, 1417.9503708330294, 1550.6815413587606, 1541.8915679076804, 1258.267978604665, 1733.8726824686541, 1628.0503559701992, 1918.8496484591867, 1265.6932953455735, 1214.2252769990084, 1554.0555359007337, 1383.0669644272923, 1397.564897819814, 1230.7970309242469, 1579.0709436338173, 1276.2373599131577, 1417.0551709995375, 1858.4774027659685, 1739.855911298859, 1526.537964775866, 2058.024044818584, 1494.851024339748, 1712.6294074401028, 1562.8671378533086, 1511.476528970853, 1252.031981770433, 1636.6991626670501, 1448.1978766002023, 1632.0304042526705, 1483.1706484772249, 2145.800590133221, 1512.830802132328, 1522.3958000557304, 1425.927974710849, 1501.1388158306522, 1591.7640315306141, 1474.6101810984433, 1676.0973980407405, 1436.0731290281099, 1387.9801227199587, 1448.4328340104198, 1192.2802295744154, 1849.349825998339, 1445.3310012102097, 1300.2921344453953, 1537.3638009759234, 1477.704128262383, 1804.1110913105083, 1674.4914430950462, 1669.4627565387914, 1553.455194553748, 1567.9572185759796, 1351.9221530380437, 1507.2834817053033, 1383.228171887263, 1677.1352153466114, 1386.8322603396596, 1487.0176273030604, 1448.6471688866864, 1871.1905694333434, 1384.408376694045, 1506.8838812830852, 1605.003769526815, 1784.2884309426747, 1670.89280263273, 1342.6054929117154, 1366.1609320305001, 1457.3207848691127, 1454.2382363417112, 1510.353253932845, 1387.3723568628425, 1445.8221709096183, 1561.159916636035, 1452.8275077724131, 1664.1317429947755, 1495.6909038578988, 1701.5084426563906, 1504.628959390622, 1390.8223924241847, 1426.5289987074004, 1378.2262844608572], "episode_lengths": [171, 175, 174, 183, 195, 140, 146, 182, 160, 134, 161, 185, 190, 196, 215, 157, 177, 176, 200, 208, 192, 207, 199, 141, 203, 188, 249, 183, 160, 204, 197, 181, 121, 167, 145, 147, 247, 230, 179, 281, 182, 225, 179, 203, 137, 213, 167, 191, 174, 305, 167, 204, 167, 179, 225, 188, 208, 160, 146, 190, 146, 283, 193, 133, 216, 187, 257, 196, 206, 178, 215, 160, 195, 177, 214, 184, 191, 182, 248, 147, 177, 235, 244, 220, 136, 193, 193, 199, 210, 199, 174, 204, 175, 193, 167, 221, 182, 197, 197, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2525247994699373, "mean_inference_ms": 0.9878004795938299, "mean_action_processing_ms": 0.08788711594394016, "mean_env_wait_ms": 0.49743904461441946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 2145.800590133221, "episode_reward_min": 1192.2802295744154, "episode_reward_mean": 1501.9365239189885, "episode_len_mean": 189.46, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1423.8580015371642, 1484.661783434859, 1377.5571043276123, 1441.4710913471747, 1362.9582362875997, 1207.7307979739137, 1251.254552299555, 1581.4676838571063, 1292.4477308961145, 1285.5427577722162, 1305.9354061689955, 1408.2929250323075, 1389.4155852581787, 1455.6444689490627, 1517.1978321113568, 1365.1664289143691, 1480.9788228381592, 1356.5483896234189, 1501.0378553149776, 1621.322030748405, 1417.9503708330294, 1550.6815413587606, 1541.8915679076804, 1258.267978604665, 1733.8726824686541, 1628.0503559701992, 1918.8496484591867, 1265.6932953455735, 1214.2252769990084, 1554.0555359007337, 1383.0669644272923, 1397.564897819814, 1230.7970309242469, 1579.0709436338173, 1276.2373599131577, 1417.0551709995375, 1858.4774027659685, 1739.855911298859, 1526.537964775866, 2058.024044818584, 1494.851024339748, 1712.6294074401028, 1562.8671378533086, 1511.476528970853, 1252.031981770433, 1636.6991626670501, 1448.1978766002023, 1632.0304042526705, 1483.1706484772249, 2145.800590133221, 1512.830802132328, 1522.3958000557304, 1425.927974710849, 1501.1388158306522, 1591.7640315306141, 1474.6101810984433, 1676.0973980407405, 1436.0731290281099, 1387.9801227199587, 1448.4328340104198, 1192.2802295744154, 1849.349825998339, 1445.3310012102097, 1300.2921344453953, 1537.3638009759234, 1477.704128262383, 1804.1110913105083, 1674.4914430950462, 1669.4627565387914, 1553.455194553748, 1567.9572185759796, 1351.9221530380437, 1507.2834817053033, 1383.228171887263, 1677.1352153466114, 1386.8322603396596, 1487.0176273030604, 1448.6471688866864, 1871.1905694333434, 1384.408376694045, 1506.8838812830852, 1605.003769526815, 1784.2884309426747, 1670.89280263273, 1342.6054929117154, 1366.1609320305001, 1457.3207848691127, 1454.2382363417112, 1510.353253932845, 1387.3723568628425, 1445.8221709096183, 1561.159916636035, 1452.8275077724131, 1664.1317429947755, 1495.6909038578988, 1701.5084426563906, 1504.628959390622, 1390.8223924241847, 1426.5289987074004, 1378.2262844608572], "episode_lengths": [171, 175, 174, 183, 195, 140, 146, 182, 160, 134, 161, 185, 190, 196, 215, 157, 177, 176, 200, 208, 192, 207, 199, 141, 203, 188, 249, 183, 160, 204, 197, 181, 121, 167, 145, 147, 247, 230, 179, 281, 182, 225, 179, 203, 137, 213, 167, 191, 174, 305, 167, 204, 167, 179, 225, 188, 208, 160, 146, 190, 146, 283, 193, 133, 216, 187, 257, 196, 206, 178, 215, 160, 195, 177, 214, 184, 191, 182, 248, 147, 177, 235, 244, 220, 136, 193, 193, 199, 210, 199, 174, 204, 175, 193, 167, 221, 182, 197, 197, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2525247994699373, "mean_inference_ms": 0.9878004795938299, "mean_action_processing_ms": 0.08788711594394016, "mean_env_wait_ms": 0.49743904461441946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 7027.722, "sample_time_ms": 696.665, "load_time_ms": 0.506, "load_throughput": 7908185.718, "learn_time_ms": 6317.911, "learn_throughput": 633.121, "synch_weights_time_ms": 12.044}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 666, "training_iteration": 34, "trial_id": "2db34_00000", "date": "2023-04-30_17-00-02", "timestamp": 1682848802, "time_this_iter_s": 6.979339361190796, "time_total_s": 237.95468044281006, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 237.95468044281006, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 8.94, "ram_util_percent": 68.05}}
{"custom_metrics": {"dps_mean": 12523.566447422534, "dps_min": 9935.668579786794, "dps_max": 17881.671584443517}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.254195825066617, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.807166559978198, "policy_loss": -0.03683532709155672, "vf_loss": 9.838133208982406, "vf_explained_var": 0.009032465245134087, "kl": 0.019562156846607955, "entropy": 1.12219543473054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 2145.800590133221, "episode_reward_min": 1192.2802295744154, "episode_reward_mean": 1502.827973690704, "episode_len_mean": 191.55, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12523.566447422534, "dps_min": 9935.668579786794, "dps_max": 17881.671584443517}, "hist_stats": {"episode_reward": [1541.8915679076804, 1258.267978604665, 1733.8726824686541, 1628.0503559701992, 1918.8496484591867, 1265.6932953455735, 1214.2252769990084, 1554.0555359007337, 1383.0669644272923, 1397.564897819814, 1230.7970309242469, 1579.0709436338173, 1276.2373599131577, 1417.0551709995375, 1858.4774027659685, 1739.855911298859, 1526.537964775866, 2058.024044818584, 1494.851024339748, 1712.6294074401028, 1562.8671378533086, 1511.476528970853, 1252.031981770433, 1636.6991626670501, 1448.1978766002023, 1632.0304042526705, 1483.1706484772249, 2145.800590133221, 1512.830802132328, 1522.3958000557304, 1425.927974710849, 1501.1388158306522, 1591.7640315306141, 1474.6101810984433, 1676.0973980407405, 1436.0731290281099, 1387.9801227199587, 1448.4328340104198, 1192.2802295744154, 1849.349825998339, 1445.3310012102097, 1300.2921344453953, 1537.3638009759234, 1477.704128262383, 1804.1110913105083, 1674.4914430950462, 1669.4627565387914, 1553.455194553748, 1567.9572185759796, 1351.9221530380437, 1507.2834817053033, 1383.228171887263, 1677.1352153466114, 1386.8322603396596, 1487.0176273030604, 1448.6471688866864, 1871.1905694333434, 1384.408376694045, 1506.8838812830852, 1605.003769526815, 1784.2884309426747, 1670.89280263273, 1342.6054929117154, 1366.1609320305001, 1457.3207848691127, 1454.2382363417112, 1510.353253932845, 1387.3723568628425, 1445.8221709096183, 1561.159916636035, 1452.8275077724131, 1664.1317429947755, 1495.6909038578988, 1701.5084426563906, 1504.628959390622, 1390.8223924241847, 1426.5289987074004, 1378.2262844608572, 1222.2346950929336, 1413.4611122860592, 1431.0098201555427, 1324.3615048152058, 1546.7978032738283, 1464.492879266044, 1627.6391509573293, 1480.3376894464284, 1456.6416339472232, 1291.9941959689784, 1512.0619315663805, 1476.213673704695, 1478.4634508159957, 1385.1452836416597, 1335.5653296091198, 1391.3949995952737, 1406.4604496759102, 1405.866891013067, 1200.6129060935154, 1372.8829980248686, 1381.3622370687067, 1563.2657380371754], "episode_lengths": [199, 141, 203, 188, 249, 183, 160, 204, 197, 181, 121, 167, 145, 147, 247, 230, 179, 281, 182, 225, 179, 203, 137, 213, 167, 191, 174, 305, 167, 204, 167, 179, 225, 188, 208, 160, 146, 190, 146, 283, 193, 133, 216, 187, 257, 196, 206, 178, 215, 160, 195, 177, 214, 184, 191, 182, 248, 147, 177, 235, 244, 220, 136, 193, 193, 199, 210, 199, 174, 204, 175, 193, 167, 221, 182, 197, 197, 166, 157, 197, 178, 172, 189, 221, 202, 167, 199, 172, 184, 196, 218, 188, 184, 177, 187, 194, 140, 197, 195, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.252609833186875, "mean_inference_ms": 0.9872364297291832, "mean_action_processing_ms": 0.08785172172835896, "mean_env_wait_ms": 0.497355918011707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 2145.800590133221, "episode_reward_min": 1192.2802295744154, "episode_reward_mean": 1502.827973690704, "episode_len_mean": 191.55, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1541.8915679076804, 1258.267978604665, 1733.8726824686541, 1628.0503559701992, 1918.8496484591867, 1265.6932953455735, 1214.2252769990084, 1554.0555359007337, 1383.0669644272923, 1397.564897819814, 1230.7970309242469, 1579.0709436338173, 1276.2373599131577, 1417.0551709995375, 1858.4774027659685, 1739.855911298859, 1526.537964775866, 2058.024044818584, 1494.851024339748, 1712.6294074401028, 1562.8671378533086, 1511.476528970853, 1252.031981770433, 1636.6991626670501, 1448.1978766002023, 1632.0304042526705, 1483.1706484772249, 2145.800590133221, 1512.830802132328, 1522.3958000557304, 1425.927974710849, 1501.1388158306522, 1591.7640315306141, 1474.6101810984433, 1676.0973980407405, 1436.0731290281099, 1387.9801227199587, 1448.4328340104198, 1192.2802295744154, 1849.349825998339, 1445.3310012102097, 1300.2921344453953, 1537.3638009759234, 1477.704128262383, 1804.1110913105083, 1674.4914430950462, 1669.4627565387914, 1553.455194553748, 1567.9572185759796, 1351.9221530380437, 1507.2834817053033, 1383.228171887263, 1677.1352153466114, 1386.8322603396596, 1487.0176273030604, 1448.6471688866864, 1871.1905694333434, 1384.408376694045, 1506.8838812830852, 1605.003769526815, 1784.2884309426747, 1670.89280263273, 1342.6054929117154, 1366.1609320305001, 1457.3207848691127, 1454.2382363417112, 1510.353253932845, 1387.3723568628425, 1445.8221709096183, 1561.159916636035, 1452.8275077724131, 1664.1317429947755, 1495.6909038578988, 1701.5084426563906, 1504.628959390622, 1390.8223924241847, 1426.5289987074004, 1378.2262844608572, 1222.2346950929336, 1413.4611122860592, 1431.0098201555427, 1324.3615048152058, 1546.7978032738283, 1464.492879266044, 1627.6391509573293, 1480.3376894464284, 1456.6416339472232, 1291.9941959689784, 1512.0619315663805, 1476.213673704695, 1478.4634508159957, 1385.1452836416597, 1335.5653296091198, 1391.3949995952737, 1406.4604496759102, 1405.866891013067, 1200.6129060935154, 1372.8829980248686, 1381.3622370687067, 1563.2657380371754], "episode_lengths": [199, 141, 203, 188, 249, 183, 160, 204, 197, 181, 121, 167, 145, 147, 247, 230, 179, 281, 182, 225, 179, 203, 137, 213, 167, 191, 174, 305, 167, 204, 167, 179, 225, 188, 208, 160, 146, 190, 146, 283, 193, 133, 216, 187, 257, 196, 206, 178, 215, 160, 195, 177, 214, 184, 191, 182, 248, 147, 177, 235, 244, 220, 136, 193, 193, 199, 210, 199, 174, 204, 175, 193, 167, 221, 182, 197, 197, 166, 157, 197, 178, 172, 189, 221, 202, 167, 199, 172, 184, 196, 218, 188, 184, 177, 187, 194, 140, 197, 195, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.252609833186875, "mean_inference_ms": 0.9872364297291832, "mean_action_processing_ms": 0.08785172172835896, "mean_env_wait_ms": 0.497355918011707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 7019.119, "sample_time_ms": 691.489, "load_time_ms": 0.405, "load_throughput": 9866048.809, "learn_time_ms": 6314.527, "learn_throughput": 633.46, "synch_weights_time_ms": 11.901}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 688, "training_iteration": 35, "trial_id": "2db34_00000", "date": "2023-04-30_17-00-09", "timestamp": 1682848809, "time_this_iter_s": 7.022798538208008, "time_total_s": 244.97747898101807, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 244.97747898101807, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 11.040000000000001, "ram_util_percent": 67.80999999999999}}
{"custom_metrics": {"dps_mean": 12426.44281832729, "dps_min": 9935.668579786794, "dps_max": 17881.671584443517}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.807228505739602, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.855927318655034, "policy_loss": -0.03518959928569334, "vf_loss": 9.887114170033446, "vf_explained_var": 0.0047274086424099505, "kl": 0.013342578236010386, "entropy": 1.090025883143948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 2145.800590133221, "episode_reward_min": 1192.2802295744154, "episode_reward_mean": 1491.1731381992743, "episode_len_mean": 190.81, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12426.44281832729, "dps_min": 9935.668579786794, "dps_max": 17881.671584443517}, "hist_stats": {"episode_reward": [1562.8671378533086, 1511.476528970853, 1252.031981770433, 1636.6991626670501, 1448.1978766002023, 1632.0304042526705, 1483.1706484772249, 2145.800590133221, 1512.830802132328, 1522.3958000557304, 1425.927974710849, 1501.1388158306522, 1591.7640315306141, 1474.6101810984433, 1676.0973980407405, 1436.0731290281099, 1387.9801227199587, 1448.4328340104198, 1192.2802295744154, 1849.349825998339, 1445.3310012102097, 1300.2921344453953, 1537.3638009759234, 1477.704128262383, 1804.1110913105083, 1674.4914430950462, 1669.4627565387914, 1553.455194553748, 1567.9572185759796, 1351.9221530380437, 1507.2834817053033, 1383.228171887263, 1677.1352153466114, 1386.8322603396596, 1487.0176273030604, 1448.6471688866864, 1871.1905694333434, 1384.408376694045, 1506.8838812830852, 1605.003769526815, 1784.2884309426747, 1670.89280263273, 1342.6054929117154, 1366.1609320305001, 1457.3207848691127, 1454.2382363417112, 1510.353253932845, 1387.3723568628425, 1445.8221709096183, 1561.159916636035, 1452.8275077724131, 1664.1317429947755, 1495.6909038578988, 1701.5084426563906, 1504.628959390622, 1390.8223924241847, 1426.5289987074004, 1378.2262844608572, 1222.2346950929336, 1413.4611122860592, 1431.0098201555427, 1324.3615048152058, 1546.7978032738283, 1464.492879266044, 1627.6391509573293, 1480.3376894464284, 1456.6416339472232, 1291.9941959689784, 1512.0619315663805, 1476.213673704695, 1478.4634508159957, 1385.1452836416597, 1335.5653296091198, 1391.3949995952737, 1406.4604496759102, 1405.866891013067, 1200.6129060935154, 1372.8829980248686, 1381.3622370687067, 1563.2657380371754, 1636.9456605785454, 1456.2031304711297, 1388.081914449977, 1489.2064515088375, 1617.9232081245132, 1700.8180385432852, 1479.9621458748709, 1383.1185112007856, 1193.469362094754, 1434.6125078746904, 1373.1771897596523, 1581.644129595144, 1543.535694853521, 1528.247430768695, 1468.9065350621468, 1619.8970812589496, 1444.5116778381025, 1417.893433773332, 1396.0004103145914, 1469.4364017241685], "episode_lengths": [179, 203, 137, 213, 167, 191, 174, 305, 167, 204, 167, 179, 225, 188, 208, 160, 146, 190, 146, 283, 193, 133, 216, 187, 257, 196, 206, 178, 215, 160, 195, 177, 214, 184, 191, 182, 248, 147, 177, 235, 244, 220, 136, 193, 193, 199, 210, 199, 174, 204, 175, 193, 167, 221, 182, 197, 197, 166, 157, 197, 178, 172, 189, 221, 202, 167, 199, 172, 184, 196, 218, 188, 184, 177, 187, 194, 140, 197, 195, 219, 225, 195, 169, 179, 190, 227, 170, 166, 132, 173, 167, 194, 218, 179, 186, 215, 198, 204, 159, 209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25245132070231313, "mean_inference_ms": 0.9865537001959227, "mean_action_processing_ms": 0.08769838567093262, "mean_env_wait_ms": 0.4970542154622485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 2145.800590133221, "episode_reward_min": 1192.2802295744154, "episode_reward_mean": 1491.1731381992743, "episode_len_mean": 190.81, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1562.8671378533086, 1511.476528970853, 1252.031981770433, 1636.6991626670501, 1448.1978766002023, 1632.0304042526705, 1483.1706484772249, 2145.800590133221, 1512.830802132328, 1522.3958000557304, 1425.927974710849, 1501.1388158306522, 1591.7640315306141, 1474.6101810984433, 1676.0973980407405, 1436.0731290281099, 1387.9801227199587, 1448.4328340104198, 1192.2802295744154, 1849.349825998339, 1445.3310012102097, 1300.2921344453953, 1537.3638009759234, 1477.704128262383, 1804.1110913105083, 1674.4914430950462, 1669.4627565387914, 1553.455194553748, 1567.9572185759796, 1351.9221530380437, 1507.2834817053033, 1383.228171887263, 1677.1352153466114, 1386.8322603396596, 1487.0176273030604, 1448.6471688866864, 1871.1905694333434, 1384.408376694045, 1506.8838812830852, 1605.003769526815, 1784.2884309426747, 1670.89280263273, 1342.6054929117154, 1366.1609320305001, 1457.3207848691127, 1454.2382363417112, 1510.353253932845, 1387.3723568628425, 1445.8221709096183, 1561.159916636035, 1452.8275077724131, 1664.1317429947755, 1495.6909038578988, 1701.5084426563906, 1504.628959390622, 1390.8223924241847, 1426.5289987074004, 1378.2262844608572, 1222.2346950929336, 1413.4611122860592, 1431.0098201555427, 1324.3615048152058, 1546.7978032738283, 1464.492879266044, 1627.6391509573293, 1480.3376894464284, 1456.6416339472232, 1291.9941959689784, 1512.0619315663805, 1476.213673704695, 1478.4634508159957, 1385.1452836416597, 1335.5653296091198, 1391.3949995952737, 1406.4604496759102, 1405.866891013067, 1200.6129060935154, 1372.8829980248686, 1381.3622370687067, 1563.2657380371754, 1636.9456605785454, 1456.2031304711297, 1388.081914449977, 1489.2064515088375, 1617.9232081245132, 1700.8180385432852, 1479.9621458748709, 1383.1185112007856, 1193.469362094754, 1434.6125078746904, 1373.1771897596523, 1581.644129595144, 1543.535694853521, 1528.247430768695, 1468.9065350621468, 1619.8970812589496, 1444.5116778381025, 1417.893433773332, 1396.0004103145914, 1469.4364017241685], "episode_lengths": [179, 203, 137, 213, 167, 191, 174, 305, 167, 204, 167, 179, 225, 188, 208, 160, 146, 190, 146, 283, 193, 133, 216, 187, 257, 196, 206, 178, 215, 160, 195, 177, 214, 184, 191, 182, 248, 147, 177, 235, 244, 220, 136, 193, 193, 199, 210, 199, 174, 204, 175, 193, 167, 221, 182, 197, 197, 166, 157, 197, 178, 172, 189, 221, 202, 167, 199, 172, 184, 196, 218, 188, 184, 177, 187, 194, 140, 197, 195, 219, 225, 195, 169, 179, 190, 227, 170, 166, 132, 173, 167, 194, 218, 179, 186, 215, 198, 204, 159, 209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25245132070231313, "mean_inference_ms": 0.9865537001959227, "mean_action_processing_ms": 0.08769838567093262, "mean_env_wait_ms": 0.4970542154622485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 7008.907, "sample_time_ms": 689.449, "load_time_ms": 0.405, "load_throughput": 9866048.809, "learn_time_ms": 6306.204, "learn_throughput": 634.296, "synch_weights_time_ms": 11.953}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 708, "training_iteration": 36, "trial_id": "2db34_00000", "date": "2023-04-30_17-00-16", "timestamp": 1682848816, "time_this_iter_s": 6.933732271194458, "time_total_s": 251.91121125221252, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 251.91121125221252, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 8.622222222222224, "ram_util_percent": 67.47777777777777}}
{"custom_metrics": {"dps_mean": 12322.526358139135, "dps_min": 9945.578017456282, "dps_max": 15593.25474527786}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.205028660130758, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.844686925539406, "policy_loss": -0.03766917848548982, "vf_loss": 9.876246211349324, "vf_explained_var": -0.00014094697531833443, "kl": 0.020366410158577094, "entropy": 1.1336756805258412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 1871.1905694333434, "episode_reward_min": 1193.469362094754, "episode_reward_mean": 1478.7031629766957, "episode_len_mean": 190.1, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12322.526358139135, "dps_min": 9945.578017456282, "dps_max": 15593.25474527786}, "hist_stats": {"episode_reward": [1537.3638009759234, 1477.704128262383, 1804.1110913105083, 1674.4914430950462, 1669.4627565387914, 1553.455194553748, 1567.9572185759796, 1351.9221530380437, 1507.2834817053033, 1383.228171887263, 1677.1352153466114, 1386.8322603396596, 1487.0176273030604, 1448.6471688866864, 1871.1905694333434, 1384.408376694045, 1506.8838812830852, 1605.003769526815, 1784.2884309426747, 1670.89280263273, 1342.6054929117154, 1366.1609320305001, 1457.3207848691127, 1454.2382363417112, 1510.353253932845, 1387.3723568628425, 1445.8221709096183, 1561.159916636035, 1452.8275077724131, 1664.1317429947755, 1495.6909038578988, 1701.5084426563906, 1504.628959390622, 1390.8223924241847, 1426.5289987074004, 1378.2262844608572, 1222.2346950929336, 1413.4611122860592, 1431.0098201555427, 1324.3615048152058, 1546.7978032738283, 1464.492879266044, 1627.6391509573293, 1480.3376894464284, 1456.6416339472232, 1291.9941959689784, 1512.0619315663805, 1476.213673704695, 1478.4634508159957, 1385.1452836416597, 1335.5653296091198, 1391.3949995952737, 1406.4604496759102, 1405.866891013067, 1200.6129060935154, 1372.8829980248686, 1381.3622370687067, 1563.2657380371754, 1636.9456605785454, 1456.2031304711297, 1388.081914449977, 1489.2064515088375, 1617.9232081245132, 1700.8180385432852, 1479.9621458748709, 1383.1185112007856, 1193.469362094754, 1434.6125078746904, 1373.1771897596523, 1581.644129595144, 1543.535694853521, 1528.247430768695, 1468.9065350621468, 1619.8970812589496, 1444.5116778381025, 1417.893433773332, 1396.0004103145914, 1469.4364017241685, 1625.4301795525328, 1652.1854589906643, 1514.8195140393154, 1321.2289570717462, 1568.5634328654576, 1332.2612648869986, 1370.9290830206764, 1468.9823635502128, 1340.3358995520177, 1386.073052017967, 1276.2764219735416, 1721.4884954810025, 1675.5447133771665, 1452.6301533054377, 1245.8318150361954, 1205.2575032651769, 1790.5281912208723, 1534.2654553513175, 1431.1229609117138, 1682.8727581027613, 1392.4986297627397, 1200.6547855178483], "episode_lengths": [216, 187, 257, 196, 206, 178, 215, 160, 195, 177, 214, 184, 191, 182, 248, 147, 177, 235, 244, 220, 136, 193, 193, 199, 210, 199, 174, 204, 175, 193, 167, 221, 182, 197, 197, 166, 157, 197, 178, 172, 189, 221, 202, 167, 199, 172, 184, 196, 218, 188, 184, 177, 187, 194, 140, 197, 195, 219, 225, 195, 169, 179, 190, 227, 170, 166, 132, 173, 167, 194, 218, 179, 186, 215, 198, 204, 159, 209, 206, 233, 180, 155, 198, 184, 162, 178, 181, 164, 154, 224, 240, 187, 169, 133, 244, 179, 183, 231, 171, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25241676773446653, "mean_inference_ms": 0.98478398112338, "mean_action_processing_ms": 0.0876952132430376, "mean_env_wait_ms": 0.4963817019736846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1871.1905694333434, "episode_reward_min": 1193.469362094754, "episode_reward_mean": 1478.7031629766957, "episode_len_mean": 190.1, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1537.3638009759234, 1477.704128262383, 1804.1110913105083, 1674.4914430950462, 1669.4627565387914, 1553.455194553748, 1567.9572185759796, 1351.9221530380437, 1507.2834817053033, 1383.228171887263, 1677.1352153466114, 1386.8322603396596, 1487.0176273030604, 1448.6471688866864, 1871.1905694333434, 1384.408376694045, 1506.8838812830852, 1605.003769526815, 1784.2884309426747, 1670.89280263273, 1342.6054929117154, 1366.1609320305001, 1457.3207848691127, 1454.2382363417112, 1510.353253932845, 1387.3723568628425, 1445.8221709096183, 1561.159916636035, 1452.8275077724131, 1664.1317429947755, 1495.6909038578988, 1701.5084426563906, 1504.628959390622, 1390.8223924241847, 1426.5289987074004, 1378.2262844608572, 1222.2346950929336, 1413.4611122860592, 1431.0098201555427, 1324.3615048152058, 1546.7978032738283, 1464.492879266044, 1627.6391509573293, 1480.3376894464284, 1456.6416339472232, 1291.9941959689784, 1512.0619315663805, 1476.213673704695, 1478.4634508159957, 1385.1452836416597, 1335.5653296091198, 1391.3949995952737, 1406.4604496759102, 1405.866891013067, 1200.6129060935154, 1372.8829980248686, 1381.3622370687067, 1563.2657380371754, 1636.9456605785454, 1456.2031304711297, 1388.081914449977, 1489.2064515088375, 1617.9232081245132, 1700.8180385432852, 1479.9621458748709, 1383.1185112007856, 1193.469362094754, 1434.6125078746904, 1373.1771897596523, 1581.644129595144, 1543.535694853521, 1528.247430768695, 1468.9065350621468, 1619.8970812589496, 1444.5116778381025, 1417.893433773332, 1396.0004103145914, 1469.4364017241685, 1625.4301795525328, 1652.1854589906643, 1514.8195140393154, 1321.2289570717462, 1568.5634328654576, 1332.2612648869986, 1370.9290830206764, 1468.9823635502128, 1340.3358995520177, 1386.073052017967, 1276.2764219735416, 1721.4884954810025, 1675.5447133771665, 1452.6301533054377, 1245.8318150361954, 1205.2575032651769, 1790.5281912208723, 1534.2654553513175, 1431.1229609117138, 1682.8727581027613, 1392.4986297627397, 1200.6547855178483], "episode_lengths": [216, 187, 257, 196, 206, 178, 215, 160, 195, 177, 214, 184, 191, 182, 248, 147, 177, 235, 244, 220, 136, 193, 193, 199, 210, 199, 174, 204, 175, 193, 167, 221, 182, 197, 197, 166, 157, 197, 178, 172, 189, 221, 202, 167, 199, 172, 184, 196, 218, 188, 184, 177, 187, 194, 140, 197, 195, 219, 225, 195, 169, 179, 190, 227, 170, 166, 132, 173, 167, 194, 218, 179, 186, 215, 198, 204, 159, 209, 206, 233, 180, 155, 198, 184, 162, 178, 181, 164, 154, 224, 240, 187, 169, 133, 244, 179, 183, 231, 171, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25241676773446653, "mean_inference_ms": 0.98478398112338, "mean_action_processing_ms": 0.0876952132430376, "mean_env_wait_ms": 0.4963817019736846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 6985.513, "sample_time_ms": 684.122, "load_time_ms": 0.405, "load_throughput": 9866048.809, "learn_time_ms": 6288.037, "learn_throughput": 636.129, "synch_weights_time_ms": 12.053}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 730, "training_iteration": 37, "trial_id": "2db34_00000", "date": "2023-04-30_17-00-23", "timestamp": 1682848823, "time_this_iter_s": 6.913452625274658, "time_total_s": 258.8246638774872, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 258.8246638774872, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 8.15, "ram_util_percent": 67.83000000000001}}
{"custom_metrics": {"dps_mean": 12113.907850749622, "dps_min": 9931.664316672108, "dps_max": 14921.068260173948}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.211050050489366, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.817230883977746, "policy_loss": -0.030541269161728442, "vf_loss": 9.842499443792528, "vf_explained_var": 0.004973929479557981, "kl": 0.01171716733359746, "entropy": 1.1493165494293296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 1790.5281912208723, "episode_reward_min": 1191.7997180006532, "episode_reward_mean": 1453.6689420899543, "episode_len_mean": 184.82, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12113.907850749622, "dps_min": 9931.664316672108, "dps_max": 14921.068260173948}, "hist_stats": {"episode_reward": [1454.2382363417112, 1510.353253932845, 1387.3723568628425, 1445.8221709096183, 1561.159916636035, 1452.8275077724131, 1664.1317429947755, 1495.6909038578988, 1701.5084426563906, 1504.628959390622, 1390.8223924241847, 1426.5289987074004, 1378.2262844608572, 1222.2346950929336, 1413.4611122860592, 1431.0098201555427, 1324.3615048152058, 1546.7978032738283, 1464.492879266044, 1627.6391509573293, 1480.3376894464284, 1456.6416339472232, 1291.9941959689784, 1512.0619315663805, 1476.213673704695, 1478.4634508159957, 1385.1452836416597, 1335.5653296091198, 1391.3949995952737, 1406.4604496759102, 1405.866891013067, 1200.6129060935154, 1372.8829980248686, 1381.3622370687067, 1563.2657380371754, 1636.9456605785454, 1456.2031304711297, 1388.081914449977, 1489.2064515088375, 1617.9232081245132, 1700.8180385432852, 1479.9621458748709, 1383.1185112007856, 1193.469362094754, 1434.6125078746904, 1373.1771897596523, 1581.644129595144, 1543.535694853521, 1528.247430768695, 1468.9065350621468, 1619.8970812589496, 1444.5116778381025, 1417.893433773332, 1396.0004103145914, 1469.4364017241685, 1625.4301795525328, 1652.1854589906643, 1514.8195140393154, 1321.2289570717462, 1568.5634328654576, 1332.2612648869986, 1370.9290830206764, 1468.9823635502128, 1340.3358995520177, 1386.073052017967, 1276.2764219735416, 1721.4884954810025, 1675.5447133771665, 1452.6301533054377, 1245.8318150361954, 1205.2575032651769, 1790.5281912208723, 1534.2654553513175, 1431.1229609117138, 1682.8727581027613, 1392.4986297627397, 1200.6547855178483, 1694.2777656170063, 1380.8234207152695, 1374.740132034484, 1476.7201524799802, 1267.2482422118692, 1761.0326595619633, 1573.1387777678453, 1302.9628337210922, 1485.7236042700579, 1365.6224955571388, 1384.349533895013, 1519.0410312380466, 1334.4343572121754, 1369.7254968037125, 1420.1974426388704, 1338.2453121251065, 1449.3400750725202, 1191.7997180006532, 1365.1155056847113, 1644.678664566066, 1341.3882182568486, 1557.349623523022, 1413.9896005153964], "episode_lengths": [199, 210, 199, 174, 204, 175, 193, 167, 221, 182, 197, 197, 166, 157, 197, 178, 172, 189, 221, 202, 167, 199, 172, 184, 196, 218, 188, 184, 177, 187, 194, 140, 197, 195, 219, 225, 195, 169, 179, 190, 227, 170, 166, 132, 173, 167, 194, 218, 179, 186, 215, 198, 204, 159, 209, 206, 233, 180, 155, 198, 184, 162, 178, 181, 164, 154, 224, 240, 187, 169, 133, 244, 179, 183, 231, 171, 131, 210, 183, 164, 183, 162, 224, 209, 132, 194, 192, 157, 190, 167, 187, 143, 161, 155, 122, 177, 217, 153, 191, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2523072243744762, "mean_inference_ms": 0.9838807948273327, "mean_action_processing_ms": 0.0876111146683809, "mean_env_wait_ms": 0.49588578729916344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1790.5281912208723, "episode_reward_min": 1191.7997180006532, "episode_reward_mean": 1453.6689420899543, "episode_len_mean": 184.82, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1454.2382363417112, 1510.353253932845, 1387.3723568628425, 1445.8221709096183, 1561.159916636035, 1452.8275077724131, 1664.1317429947755, 1495.6909038578988, 1701.5084426563906, 1504.628959390622, 1390.8223924241847, 1426.5289987074004, 1378.2262844608572, 1222.2346950929336, 1413.4611122860592, 1431.0098201555427, 1324.3615048152058, 1546.7978032738283, 1464.492879266044, 1627.6391509573293, 1480.3376894464284, 1456.6416339472232, 1291.9941959689784, 1512.0619315663805, 1476.213673704695, 1478.4634508159957, 1385.1452836416597, 1335.5653296091198, 1391.3949995952737, 1406.4604496759102, 1405.866891013067, 1200.6129060935154, 1372.8829980248686, 1381.3622370687067, 1563.2657380371754, 1636.9456605785454, 1456.2031304711297, 1388.081914449977, 1489.2064515088375, 1617.9232081245132, 1700.8180385432852, 1479.9621458748709, 1383.1185112007856, 1193.469362094754, 1434.6125078746904, 1373.1771897596523, 1581.644129595144, 1543.535694853521, 1528.247430768695, 1468.9065350621468, 1619.8970812589496, 1444.5116778381025, 1417.893433773332, 1396.0004103145914, 1469.4364017241685, 1625.4301795525328, 1652.1854589906643, 1514.8195140393154, 1321.2289570717462, 1568.5634328654576, 1332.2612648869986, 1370.9290830206764, 1468.9823635502128, 1340.3358995520177, 1386.073052017967, 1276.2764219735416, 1721.4884954810025, 1675.5447133771665, 1452.6301533054377, 1245.8318150361954, 1205.2575032651769, 1790.5281912208723, 1534.2654553513175, 1431.1229609117138, 1682.8727581027613, 1392.4986297627397, 1200.6547855178483, 1694.2777656170063, 1380.8234207152695, 1374.740132034484, 1476.7201524799802, 1267.2482422118692, 1761.0326595619633, 1573.1387777678453, 1302.9628337210922, 1485.7236042700579, 1365.6224955571388, 1384.349533895013, 1519.0410312380466, 1334.4343572121754, 1369.7254968037125, 1420.1974426388704, 1338.2453121251065, 1449.3400750725202, 1191.7997180006532, 1365.1155056847113, 1644.678664566066, 1341.3882182568486, 1557.349623523022, 1413.9896005153964], "episode_lengths": [199, 210, 199, 174, 204, 175, 193, 167, 221, 182, 197, 197, 166, 157, 197, 178, 172, 189, 221, 202, 167, 199, 172, 184, 196, 218, 188, 184, 177, 187, 194, 140, 197, 195, 219, 225, 195, 169, 179, 190, 227, 170, 166, 132, 173, 167, 194, 218, 179, 186, 215, 198, 204, 159, 209, 206, 233, 180, 155, 198, 184, 162, 178, 181, 164, 154, 224, 240, 187, 169, 133, 244, 179, 183, 231, 171, 131, 210, 183, 164, 183, 162, 224, 209, 132, 194, 192, 157, 190, 167, 187, 143, 161, 155, 122, 177, 217, 153, 191, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2523072243744762, "mean_inference_ms": 0.9838807948273327, "mean_action_processing_ms": 0.0876111146683809, "mean_env_wait_ms": 0.49588578729916344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 6989.775, "sample_time_ms": 678.463, "load_time_ms": 0.404, "load_throughput": 9908584.928, "learn_time_ms": 6297.774, "learn_throughput": 635.145, "synch_weights_time_ms": 12.238}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 753, "training_iteration": 38, "trial_id": "2db34_00000", "date": "2023-04-30_17-00-30", "timestamp": 1682848830, "time_this_iter_s": 6.936852931976318, "time_total_s": 265.7615168094635, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 265.7615168094635, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 8.11, "ram_util_percent": 67.49}}
{"custom_metrics": {"dps_mean": 12081.309973684998, "dps_min": 9931.664316672108, "dps_max": 14921.068260173948}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.402337915442324, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.851271326823902, "policy_loss": -0.029519284346331193, "vf_loss": 9.876443032295473, "vf_explained_var": 0.0021879301276258242, "kl": 0.009661241168495795, "entropy": 1.0679186162769154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 1790.5281912208723, "episode_reward_min": 1191.7997180006532, "episode_reward_mean": 1449.7571968421998, "episode_len_mean": 184.21, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12081.309973684998, "dps_min": 9931.664316672108, "dps_max": 14921.068260173948}, "hist_stats": {"episode_reward": [1291.9941959689784, 1512.0619315663805, 1476.213673704695, 1478.4634508159957, 1385.1452836416597, 1335.5653296091198, 1391.3949995952737, 1406.4604496759102, 1405.866891013067, 1200.6129060935154, 1372.8829980248686, 1381.3622370687067, 1563.2657380371754, 1636.9456605785454, 1456.2031304711297, 1388.081914449977, 1489.2064515088375, 1617.9232081245132, 1700.8180385432852, 1479.9621458748709, 1383.1185112007856, 1193.469362094754, 1434.6125078746904, 1373.1771897596523, 1581.644129595144, 1543.535694853521, 1528.247430768695, 1468.9065350621468, 1619.8970812589496, 1444.5116778381025, 1417.893433773332, 1396.0004103145914, 1469.4364017241685, 1625.4301795525328, 1652.1854589906643, 1514.8195140393154, 1321.2289570717462, 1568.5634328654576, 1332.2612648869986, 1370.9290830206764, 1468.9823635502128, 1340.3358995520177, 1386.073052017967, 1276.2764219735416, 1721.4884954810025, 1675.5447133771665, 1452.6301533054377, 1245.8318150361954, 1205.2575032651769, 1790.5281912208723, 1534.2654553513175, 1431.1229609117138, 1682.8727581027613, 1392.4986297627397, 1200.6547855178483, 1694.2777656170063, 1380.8234207152695, 1374.740132034484, 1476.7201524799802, 1267.2482422118692, 1761.0326595619633, 1573.1387777678453, 1302.9628337210922, 1485.7236042700579, 1365.6224955571388, 1384.349533895013, 1519.0410312380466, 1334.4343572121754, 1369.7254968037125, 1420.1974426388704, 1338.2453121251065, 1449.3400750725202, 1191.7997180006532, 1365.1155056847113, 1644.678664566066, 1341.3882182568486, 1557.349623523022, 1413.9896005153964, 1369.236184838918, 1427.5681203525967, 1318.789807872833, 1237.6706621511942, 1327.7876474710883, 1498.1441099146218, 1638.540778587572, 1504.4167317154709, 1759.579503092203, 1413.1514944272367, 1443.675732404267, 1501.3674583710156, 1397.6692717024453, 1305.98932817785, 1538.0661008540021, 1358.4277288265405, 1299.2195368960047, 1485.3742201675411, 1529.9615917919325, 1453.590024706812, 1632.4130600462568, 1508.473837044312], "episode_lengths": [172, 184, 196, 218, 188, 184, 177, 187, 194, 140, 197, 195, 219, 225, 195, 169, 179, 190, 227, 170, 166, 132, 173, 167, 194, 218, 179, 186, 215, 198, 204, 159, 209, 206, 233, 180, 155, 198, 184, 162, 178, 181, 164, 154, 224, 240, 187, 169, 133, 244, 179, 183, 231, 171, 131, 210, 183, 164, 183, 162, 224, 209, 132, 194, 192, 157, 190, 167, 187, 143, 161, 155, 122, 177, 217, 153, 191, 150, 165, 165, 133, 152, 152, 220, 231, 188, 261, 201, 193, 200, 167, 166, 204, 176, 140, 191, 216, 199, 190, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25216486725608644, "mean_inference_ms": 0.9829572657519074, "mean_action_processing_ms": 0.08749118173459314, "mean_env_wait_ms": 0.4957426378053081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1790.5281912208723, "episode_reward_min": 1191.7997180006532, "episode_reward_mean": 1449.7571968421998, "episode_len_mean": 184.21, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1291.9941959689784, 1512.0619315663805, 1476.213673704695, 1478.4634508159957, 1385.1452836416597, 1335.5653296091198, 1391.3949995952737, 1406.4604496759102, 1405.866891013067, 1200.6129060935154, 1372.8829980248686, 1381.3622370687067, 1563.2657380371754, 1636.9456605785454, 1456.2031304711297, 1388.081914449977, 1489.2064515088375, 1617.9232081245132, 1700.8180385432852, 1479.9621458748709, 1383.1185112007856, 1193.469362094754, 1434.6125078746904, 1373.1771897596523, 1581.644129595144, 1543.535694853521, 1528.247430768695, 1468.9065350621468, 1619.8970812589496, 1444.5116778381025, 1417.893433773332, 1396.0004103145914, 1469.4364017241685, 1625.4301795525328, 1652.1854589906643, 1514.8195140393154, 1321.2289570717462, 1568.5634328654576, 1332.2612648869986, 1370.9290830206764, 1468.9823635502128, 1340.3358995520177, 1386.073052017967, 1276.2764219735416, 1721.4884954810025, 1675.5447133771665, 1452.6301533054377, 1245.8318150361954, 1205.2575032651769, 1790.5281912208723, 1534.2654553513175, 1431.1229609117138, 1682.8727581027613, 1392.4986297627397, 1200.6547855178483, 1694.2777656170063, 1380.8234207152695, 1374.740132034484, 1476.7201524799802, 1267.2482422118692, 1761.0326595619633, 1573.1387777678453, 1302.9628337210922, 1485.7236042700579, 1365.6224955571388, 1384.349533895013, 1519.0410312380466, 1334.4343572121754, 1369.7254968037125, 1420.1974426388704, 1338.2453121251065, 1449.3400750725202, 1191.7997180006532, 1365.1155056847113, 1644.678664566066, 1341.3882182568486, 1557.349623523022, 1413.9896005153964, 1369.236184838918, 1427.5681203525967, 1318.789807872833, 1237.6706621511942, 1327.7876474710883, 1498.1441099146218, 1638.540778587572, 1504.4167317154709, 1759.579503092203, 1413.1514944272367, 1443.675732404267, 1501.3674583710156, 1397.6692717024453, 1305.98932817785, 1538.0661008540021, 1358.4277288265405, 1299.2195368960047, 1485.3742201675411, 1529.9615917919325, 1453.590024706812, 1632.4130600462568, 1508.473837044312], "episode_lengths": [172, 184, 196, 218, 188, 184, 177, 187, 194, 140, 197, 195, 219, 225, 195, 169, 179, 190, 227, 170, 166, 132, 173, 167, 194, 218, 179, 186, 215, 198, 204, 159, 209, 206, 233, 180, 155, 198, 184, 162, 178, 181, 164, 154, 224, 240, 187, 169, 133, 244, 179, 183, 231, 171, 131, 210, 183, 164, 183, 162, 224, 209, 132, 194, 192, 157, 190, 167, 187, 143, 161, 155, 122, 177, 217, 153, 191, 150, 165, 165, 133, 152, 152, 220, 231, 188, 261, 201, 193, 200, 167, 166, 204, 176, 140, 191, 216, 199, 190, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25216486725608644, "mean_inference_ms": 0.9829572657519074, "mean_action_processing_ms": 0.08749118173459314, "mean_env_wait_ms": 0.4957426378053081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 6992.325, "sample_time_ms": 676.527, "load_time_ms": 0.304, "load_throughput": 13176169.01, "learn_time_ms": 6302.364, "learn_throughput": 634.682, "synch_weights_time_ms": 12.234}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 775, "training_iteration": 39, "trial_id": "2db34_00000", "date": "2023-04-30_17-00-37", "timestamp": 1682848837, "time_this_iter_s": 7.069303274154663, "time_total_s": 272.83082008361816, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 272.83082008361816, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 11.03, "ram_util_percent": 68.10999999999999}}
{"custom_metrics": {"dps_mean": 12089.104954612674, "dps_min": 9931.664316672108, "dps_max": 14921.068260173948}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.970463743164974, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.842960811943136, "policy_loss": -0.033097672746867264, "vf_loss": 9.870573416063863, "vf_explained_var": 0.015394914919330227, "kl": 0.012189029169639242, "entropy": 1.0693851232368459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 1790.5281912208723, "episode_reward_min": 1191.7997180006532, "episode_reward_mean": 1450.6925945535213, "episode_len_mean": 181.78, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12089.104954612674, "dps_min": 9931.664316672108, "dps_max": 14921.068260173948}, "hist_stats": {"episode_reward": [1581.644129595144, 1543.535694853521, 1528.247430768695, 1468.9065350621468, 1619.8970812589496, 1444.5116778381025, 1417.893433773332, 1396.0004103145914, 1469.4364017241685, 1625.4301795525328, 1652.1854589906643, 1514.8195140393154, 1321.2289570717462, 1568.5634328654576, 1332.2612648869986, 1370.9290830206764, 1468.9823635502128, 1340.3358995520177, 1386.073052017967, 1276.2764219735416, 1721.4884954810025, 1675.5447133771665, 1452.6301533054377, 1245.8318150361954, 1205.2575032651769, 1790.5281912208723, 1534.2654553513175, 1431.1229609117138, 1682.8727581027613, 1392.4986297627397, 1200.6547855178483, 1694.2777656170063, 1380.8234207152695, 1374.740132034484, 1476.7201524799802, 1267.2482422118692, 1761.0326595619633, 1573.1387777678453, 1302.9628337210922, 1485.7236042700579, 1365.6224955571388, 1384.349533895013, 1519.0410312380466, 1334.4343572121754, 1369.7254968037125, 1420.1974426388704, 1338.2453121251065, 1449.3400750725202, 1191.7997180006532, 1365.1155056847113, 1644.678664566066, 1341.3882182568486, 1557.349623523022, 1413.9896005153964, 1369.236184838918, 1427.5681203525967, 1318.789807872833, 1237.6706621511942, 1327.7876474710883, 1498.1441099146218, 1638.540778587572, 1504.4167317154709, 1759.579503092203, 1413.1514944272367, 1443.675732404267, 1501.3674583710156, 1397.6692717024453, 1305.98932817785, 1538.0661008540021, 1358.4277288265405, 1299.2195368960047, 1485.3742201675411, 1529.9615917919325, 1453.590024706812, 1632.4130600462568, 1508.473837044312, 1394.8698220687738, 1589.406181280329, 1532.019307768354, 1379.3294990140573, 1511.1989006696913, 1564.6870299563086, 1518.2994415956096, 1401.4051813014448, 1327.4734528185804, 1420.8071267933938, 1391.0755907849825, 1361.750748221227, 1294.7398212420048, 1575.4812581430854, 1408.9522784433682, 1420.9644894718178, 1233.82880817912, 1416.0486610477942, 1253.2601039496956, 1550.5723503375038, 1390.9991289900208, 1606.0817727299811, 1408.5864614941763, 1496.5105601272212], "episode_lengths": [194, 218, 179, 186, 215, 198, 204, 159, 209, 206, 233, 180, 155, 198, 184, 162, 178, 181, 164, 154, 224, 240, 187, 169, 133, 244, 179, 183, 231, 171, 131, 210, 183, 164, 183, 162, 224, 209, 132, 194, 192, 157, 190, 167, 187, 143, 161, 155, 122, 177, 217, 153, 191, 150, 165, 165, 133, 152, 152, 220, 231, 188, 261, 201, 193, 200, 167, 166, 204, 176, 140, 191, 216, 199, 190, 195, 177, 181, 198, 173, 183, 184, 185, 174, 164, 145, 188, 165, 164, 210, 179, 179, 130, 162, 150, 188, 171, 196, 176, 179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25192707521761876, "mean_inference_ms": 0.9812730851539453, "mean_action_processing_ms": 0.08734107284765383, "mean_env_wait_ms": 0.49540230362176785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1790.5281912208723, "episode_reward_min": 1191.7997180006532, "episode_reward_mean": 1450.6925945535213, "episode_len_mean": 181.78, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1581.644129595144, 1543.535694853521, 1528.247430768695, 1468.9065350621468, 1619.8970812589496, 1444.5116778381025, 1417.893433773332, 1396.0004103145914, 1469.4364017241685, 1625.4301795525328, 1652.1854589906643, 1514.8195140393154, 1321.2289570717462, 1568.5634328654576, 1332.2612648869986, 1370.9290830206764, 1468.9823635502128, 1340.3358995520177, 1386.073052017967, 1276.2764219735416, 1721.4884954810025, 1675.5447133771665, 1452.6301533054377, 1245.8318150361954, 1205.2575032651769, 1790.5281912208723, 1534.2654553513175, 1431.1229609117138, 1682.8727581027613, 1392.4986297627397, 1200.6547855178483, 1694.2777656170063, 1380.8234207152695, 1374.740132034484, 1476.7201524799802, 1267.2482422118692, 1761.0326595619633, 1573.1387777678453, 1302.9628337210922, 1485.7236042700579, 1365.6224955571388, 1384.349533895013, 1519.0410312380466, 1334.4343572121754, 1369.7254968037125, 1420.1974426388704, 1338.2453121251065, 1449.3400750725202, 1191.7997180006532, 1365.1155056847113, 1644.678664566066, 1341.3882182568486, 1557.349623523022, 1413.9896005153964, 1369.236184838918, 1427.5681203525967, 1318.789807872833, 1237.6706621511942, 1327.7876474710883, 1498.1441099146218, 1638.540778587572, 1504.4167317154709, 1759.579503092203, 1413.1514944272367, 1443.675732404267, 1501.3674583710156, 1397.6692717024453, 1305.98932817785, 1538.0661008540021, 1358.4277288265405, 1299.2195368960047, 1485.3742201675411, 1529.9615917919325, 1453.590024706812, 1632.4130600462568, 1508.473837044312, 1394.8698220687738, 1589.406181280329, 1532.019307768354, 1379.3294990140573, 1511.1989006696913, 1564.6870299563086, 1518.2994415956096, 1401.4051813014448, 1327.4734528185804, 1420.8071267933938, 1391.0755907849825, 1361.750748221227, 1294.7398212420048, 1575.4812581430854, 1408.9522784433682, 1420.9644894718178, 1233.82880817912, 1416.0486610477942, 1253.2601039496956, 1550.5723503375038, 1390.9991289900208, 1606.0817727299811, 1408.5864614941763, 1496.5105601272212], "episode_lengths": [194, 218, 179, 186, 215, 198, 204, 159, 209, 206, 233, 180, 155, 198, 184, 162, 178, 181, 164, 154, 224, 240, 187, 169, 133, 244, 179, 183, 231, 171, 131, 210, 183, 164, 183, 162, 224, 209, 132, 194, 192, 157, 190, 167, 187, 143, 161, 155, 122, 177, 217, 153, 191, 150, 165, 165, 133, 152, 152, 220, 231, 188, 261, 201, 193, 200, 167, 166, 204, 176, 140, 191, 216, 199, 190, 195, 177, 181, 198, 173, 183, 184, 185, 174, 164, 145, 188, 165, 164, 210, 179, 179, 130, 162, 150, 188, 171, 196, 176, 179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25192707521761876, "mean_inference_ms": 0.9812730851539453, "mean_action_processing_ms": 0.08734107284765383, "mean_env_wait_ms": 0.49540230362176785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 6977.4, "sample_time_ms": 670.665, "load_time_ms": 0.358, "load_throughput": 11183319.557, "learn_time_ms": 6293.379, "learn_throughput": 635.589, "synch_weights_time_ms": 12.203}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 799, "training_iteration": 40, "trial_id": "2db34_00000", "date": "2023-04-30_17-00-44", "timestamp": 1682848844, "time_this_iter_s": 6.787713050842285, "time_total_s": 279.61853313446045, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 279.61853313446045, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 8.977777777777778, "ram_util_percent": 68.27777777777777}}
{"custom_metrics": {"dps_mean": 12137.32038742922, "dps_min": 9931.664316672108, "dps_max": 15949.267706437682}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.563945424108095, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.884609338288666, "policy_loss": -0.03497951484976276, "vf_loss": 9.91459493637085, "vf_explained_var": 0.0002757291640004804, "kl": 0.01109757056044345, "entropy": 1.077397156530811, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 1913.9121247725202, "episode_reward_min": 1191.7997180006532, "episode_reward_mean": 1456.4784464915065, "episode_len_mean": 182.68, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12137.32038742922, "dps_min": 9931.664316672108, "dps_max": 15949.267706437682}, "hist_stats": {"episode_reward": [1370.9290830206764, 1468.9823635502128, 1340.3358995520177, 1386.073052017967, 1276.2764219735416, 1721.4884954810025, 1675.5447133771665, 1452.6301533054377, 1245.8318150361954, 1205.2575032651769, 1790.5281912208723, 1534.2654553513175, 1431.1229609117138, 1682.8727581027613, 1392.4986297627397, 1200.6547855178483, 1694.2777656170063, 1380.8234207152695, 1374.740132034484, 1476.7201524799802, 1267.2482422118692, 1761.0326595619633, 1573.1387777678453, 1302.9628337210922, 1485.7236042700579, 1365.6224955571388, 1384.349533895013, 1519.0410312380466, 1334.4343572121754, 1369.7254968037125, 1420.1974426388704, 1338.2453121251065, 1449.3400750725202, 1191.7997180006532, 1365.1155056847113, 1644.678664566066, 1341.3882182568486, 1557.349623523022, 1413.9896005153964, 1369.236184838918, 1427.5681203525967, 1318.789807872833, 1237.6706621511942, 1327.7876474710883, 1498.1441099146218, 1638.540778587572, 1504.4167317154709, 1759.579503092203, 1413.1514944272367, 1443.675732404267, 1501.3674583710156, 1397.6692717024453, 1305.98932817785, 1538.0661008540021, 1358.4277288265405, 1299.2195368960047, 1485.3742201675411, 1529.9615917919325, 1453.590024706812, 1632.4130600462568, 1508.473837044312, 1394.8698220687738, 1589.406181280329, 1532.019307768354, 1379.3294990140573, 1511.1989006696913, 1564.6870299563086, 1518.2994415956096, 1401.4051813014448, 1327.4734528185804, 1420.8071267933938, 1391.0755907849825, 1361.750748221227, 1294.7398212420048, 1575.4812581430854, 1408.9522784433682, 1420.9644894718178, 1233.82880817912, 1416.0486610477942, 1253.2601039496956, 1550.5723503375038, 1390.9991289900208, 1606.0817727299811, 1408.5864614941763, 1496.5105601272212, 1850.521901799945, 1410.0525699375307, 1304.6131865738803, 1621.4782987729745, 1759.80626034396, 1305.9278157988495, 1812.049478636663, 1913.9121247725202, 1393.1970275321025, 1408.350600002866, 1366.6630398313341, 1479.7369319699783, 1475.511738248214, 1537.6440939514139, 1423.6817282216523], "episode_lengths": [162, 178, 181, 164, 154, 224, 240, 187, 169, 133, 244, 179, 183, 231, 171, 131, 210, 183, 164, 183, 162, 224, 209, 132, 194, 192, 157, 190, 167, 187, 143, 161, 155, 122, 177, 217, 153, 191, 150, 165, 165, 133, 152, 152, 220, 231, 188, 261, 201, 193, 200, 167, 166, 204, 176, 140, 191, 216, 199, 190, 195, 177, 181, 198, 173, 183, 184, 185, 174, 164, 145, 188, 165, 164, 210, 179, 179, 130, 162, 150, 188, 171, 196, 176, 179, 254, 192, 160, 214, 236, 192, 259, 271, 175, 184, 142, 180, 164, 204, 181]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2517528059060879, "mean_inference_ms": 0.9809027217355912, "mean_action_processing_ms": 0.0872081947206589, "mean_env_wait_ms": 0.4951340503200843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1913.9121247725202, "episode_reward_min": 1191.7997180006532, "episode_reward_mean": 1456.4784464915065, "episode_len_mean": 182.68, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1370.9290830206764, 1468.9823635502128, 1340.3358995520177, 1386.073052017967, 1276.2764219735416, 1721.4884954810025, 1675.5447133771665, 1452.6301533054377, 1245.8318150361954, 1205.2575032651769, 1790.5281912208723, 1534.2654553513175, 1431.1229609117138, 1682.8727581027613, 1392.4986297627397, 1200.6547855178483, 1694.2777656170063, 1380.8234207152695, 1374.740132034484, 1476.7201524799802, 1267.2482422118692, 1761.0326595619633, 1573.1387777678453, 1302.9628337210922, 1485.7236042700579, 1365.6224955571388, 1384.349533895013, 1519.0410312380466, 1334.4343572121754, 1369.7254968037125, 1420.1974426388704, 1338.2453121251065, 1449.3400750725202, 1191.7997180006532, 1365.1155056847113, 1644.678664566066, 1341.3882182568486, 1557.349623523022, 1413.9896005153964, 1369.236184838918, 1427.5681203525967, 1318.789807872833, 1237.6706621511942, 1327.7876474710883, 1498.1441099146218, 1638.540778587572, 1504.4167317154709, 1759.579503092203, 1413.1514944272367, 1443.675732404267, 1501.3674583710156, 1397.6692717024453, 1305.98932817785, 1538.0661008540021, 1358.4277288265405, 1299.2195368960047, 1485.3742201675411, 1529.9615917919325, 1453.590024706812, 1632.4130600462568, 1508.473837044312, 1394.8698220687738, 1589.406181280329, 1532.019307768354, 1379.3294990140573, 1511.1989006696913, 1564.6870299563086, 1518.2994415956096, 1401.4051813014448, 1327.4734528185804, 1420.8071267933938, 1391.0755907849825, 1361.750748221227, 1294.7398212420048, 1575.4812581430854, 1408.9522784433682, 1420.9644894718178, 1233.82880817912, 1416.0486610477942, 1253.2601039496956, 1550.5723503375038, 1390.9991289900208, 1606.0817727299811, 1408.5864614941763, 1496.5105601272212, 1850.521901799945, 1410.0525699375307, 1304.6131865738803, 1621.4782987729745, 1759.80626034396, 1305.9278157988495, 1812.049478636663, 1913.9121247725202, 1393.1970275321025, 1408.350600002866, 1366.6630398313341, 1479.7369319699783, 1475.511738248214, 1537.6440939514139, 1423.6817282216523], "episode_lengths": [162, 178, 181, 164, 154, 224, 240, 187, 169, 133, 244, 179, 183, 231, 171, 131, 210, 183, 164, 183, 162, 224, 209, 132, 194, 192, 157, 190, 167, 187, 143, 161, 155, 122, 177, 217, 153, 191, 150, 165, 165, 133, 152, 152, 220, 231, 188, 261, 201, 193, 200, 167, 166, 204, 176, 140, 191, 216, 199, 190, 195, 177, 181, 198, 173, 183, 184, 185, 174, 164, 145, 188, 165, 164, 210, 179, 179, 130, 162, 150, 188, 171, 196, 176, 179, 254, 192, 160, 214, 236, 192, 259, 271, 175, 184, 142, 180, 164, 204, 181]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2517528059060879, "mean_inference_ms": 0.9809027217355912, "mean_action_processing_ms": 0.0872081947206589, "mean_env_wait_ms": 0.4951340503200843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 6956.934, "sample_time_ms": 673.21, "load_time_ms": 0.258, "load_throughput": 15524397.15, "learn_time_ms": 6270.415, "learn_throughput": 637.916, "synch_weights_time_ms": 12.346}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 814, "training_iteration": 41, "trial_id": "2db34_00000", "date": "2023-04-30_17-00-51", "timestamp": 1682848851, "time_this_iter_s": 6.931478023529053, "time_total_s": 286.5500111579895, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 286.5500111579895, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 10.62, "ram_util_percent": 67.39999999999999}}
{"custom_metrics": {"dps_mean": 12363.694699463951, "dps_min": 9931.664316672108, "dps_max": 15949.267706437682}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.773742638800734, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.817378707598614, "policy_loss": -0.03425273490989561, "vf_loss": 9.847036125839397, "vf_explained_var": 0.010742709969961515, "kl": 0.010211763707110981, "entropy": 1.0588740975305597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 1913.9121247725202, "episode_reward_min": 1191.7997180006532, "episode_reward_mean": 1483.6433639356735, "episode_len_mean": 188.89, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12363.694699463951, "dps_min": 9931.664316672108, "dps_max": 15949.267706437682}, "hist_stats": {"episode_reward": [1573.1387777678453, 1302.9628337210922, 1485.7236042700579, 1365.6224955571388, 1384.349533895013, 1519.0410312380466, 1334.4343572121754, 1369.7254968037125, 1420.1974426388704, 1338.2453121251065, 1449.3400750725202, 1191.7997180006532, 1365.1155056847113, 1644.678664566066, 1341.3882182568486, 1557.349623523022, 1413.9896005153964, 1369.236184838918, 1427.5681203525967, 1318.789807872833, 1237.6706621511942, 1327.7876474710883, 1498.1441099146218, 1638.540778587572, 1504.4167317154709, 1759.579503092203, 1413.1514944272367, 1443.675732404267, 1501.3674583710156, 1397.6692717024453, 1305.98932817785, 1538.0661008540021, 1358.4277288265405, 1299.2195368960047, 1485.3742201675411, 1529.9615917919325, 1453.590024706812, 1632.4130600462568, 1508.473837044312, 1394.8698220687738, 1589.406181280329, 1532.019307768354, 1379.3294990140573, 1511.1989006696913, 1564.6870299563086, 1518.2994415956096, 1401.4051813014448, 1327.4734528185804, 1420.8071267933938, 1391.0755907849825, 1361.750748221227, 1294.7398212420048, 1575.4812581430854, 1408.9522784433682, 1420.9644894718178, 1233.82880817912, 1416.0486610477942, 1253.2601039496956, 1550.5723503375038, 1390.9991289900208, 1606.0817727299811, 1408.5864614941763, 1496.5105601272212, 1850.521901799945, 1410.0525699375307, 1304.6131865738803, 1621.4782987729745, 1759.80626034396, 1305.9278157988495, 1812.049478636663, 1913.9121247725202, 1393.1970275321025, 1408.350600002866, 1366.6630398313341, 1479.7369319699783, 1475.511738248214, 1537.6440939514139, 1423.6817282216523, 1459.1308274340772, 1843.0190277271438, 1573.6050431647582, 1745.5807750966746, 1447.817740546509, 1623.644466858084, 1481.0921210996758, 1531.9019753893015, 1428.4435494478635, 1502.588802808354, 1597.1610927145111, 1446.137215411914, 1543.223712162916, 1816.5249109262595, 1333.0025749056888, 1460.6312857899343, 1761.7266491627313, 1644.8308102733147, 1600.6207253313353, 1796.018191949557, 1825.1779652206023, 1384.7469350627837], "episode_lengths": [209, 132, 194, 192, 157, 190, 167, 187, 143, 161, 155, 122, 177, 217, 153, 191, 150, 165, 165, 133, 152, 152, 220, 231, 188, 261, 201, 193, 200, 167, 166, 204, 176, 140, 191, 216, 199, 190, 195, 177, 181, 198, 173, 183, 184, 185, 174, 164, 145, 188, 165, 164, 210, 179, 179, 130, 162, 150, 188, 171, 196, 176, 179, 254, 192, 160, 214, 236, 192, 259, 271, 175, 184, 142, 180, 164, 204, 181, 175, 274, 197, 235, 194, 229, 184, 190, 193, 195, 215, 184, 219, 272, 155, 171, 249, 196, 230, 246, 282, 193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25161840754741194, "mean_inference_ms": 0.9803105140451754, "mean_action_processing_ms": 0.08698439021906086, "mean_env_wait_ms": 0.49493893963829394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1913.9121247725202, "episode_reward_min": 1191.7997180006532, "episode_reward_mean": 1483.6433639356735, "episode_len_mean": 188.89, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1573.1387777678453, 1302.9628337210922, 1485.7236042700579, 1365.6224955571388, 1384.349533895013, 1519.0410312380466, 1334.4343572121754, 1369.7254968037125, 1420.1974426388704, 1338.2453121251065, 1449.3400750725202, 1191.7997180006532, 1365.1155056847113, 1644.678664566066, 1341.3882182568486, 1557.349623523022, 1413.9896005153964, 1369.236184838918, 1427.5681203525967, 1318.789807872833, 1237.6706621511942, 1327.7876474710883, 1498.1441099146218, 1638.540778587572, 1504.4167317154709, 1759.579503092203, 1413.1514944272367, 1443.675732404267, 1501.3674583710156, 1397.6692717024453, 1305.98932817785, 1538.0661008540021, 1358.4277288265405, 1299.2195368960047, 1485.3742201675411, 1529.9615917919325, 1453.590024706812, 1632.4130600462568, 1508.473837044312, 1394.8698220687738, 1589.406181280329, 1532.019307768354, 1379.3294990140573, 1511.1989006696913, 1564.6870299563086, 1518.2994415956096, 1401.4051813014448, 1327.4734528185804, 1420.8071267933938, 1391.0755907849825, 1361.750748221227, 1294.7398212420048, 1575.4812581430854, 1408.9522784433682, 1420.9644894718178, 1233.82880817912, 1416.0486610477942, 1253.2601039496956, 1550.5723503375038, 1390.9991289900208, 1606.0817727299811, 1408.5864614941763, 1496.5105601272212, 1850.521901799945, 1410.0525699375307, 1304.6131865738803, 1621.4782987729745, 1759.80626034396, 1305.9278157988495, 1812.049478636663, 1913.9121247725202, 1393.1970275321025, 1408.350600002866, 1366.6630398313341, 1479.7369319699783, 1475.511738248214, 1537.6440939514139, 1423.6817282216523, 1459.1308274340772, 1843.0190277271438, 1573.6050431647582, 1745.5807750966746, 1447.817740546509, 1623.644466858084, 1481.0921210996758, 1531.9019753893015, 1428.4435494478635, 1502.588802808354, 1597.1610927145111, 1446.137215411914, 1543.223712162916, 1816.5249109262595, 1333.0025749056888, 1460.6312857899343, 1761.7266491627313, 1644.8308102733147, 1600.6207253313353, 1796.018191949557, 1825.1779652206023, 1384.7469350627837], "episode_lengths": [209, 132, 194, 192, 157, 190, 167, 187, 143, 161, 155, 122, 177, 217, 153, 191, 150, 165, 165, 133, 152, 152, 220, 231, 188, 261, 201, 193, 200, 167, 166, 204, 176, 140, 191, 216, 199, 190, 195, 177, 181, 198, 173, 183, 184, 185, 174, 164, 145, 188, 165, 164, 210, 179, 179, 130, 162, 150, 188, 171, 196, 176, 179, 254, 192, 160, 214, 236, 192, 259, 271, 175, 184, 142, 180, 164, 204, 181, 175, 274, 197, 235, 194, 229, 184, 190, 193, 195, 215, 184, 219, 272, 155, 171, 249, 196, 230, 246, 282, 193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25161840754741194, "mean_inference_ms": 0.9803105140451754, "mean_action_processing_ms": 0.08698439021906086, "mean_env_wait_ms": 0.49493893963829394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 6957.604, "sample_time_ms": 667.696, "load_time_ms": 0.157, "load_throughput": 25408474.936, "learn_time_ms": 6276.598, "learn_throughput": 637.288, "synch_weights_time_ms": 12.448}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 836, "training_iteration": 42, "trial_id": "2db34_00000", "date": "2023-04-30_17-00-58", "timestamp": 1682848858, "time_this_iter_s": 7.179110050201416, "time_total_s": 293.7291212081909, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 293.7291212081909, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 8.629999999999999, "ram_util_percent": 67.54}}
{"custom_metrics": {"dps_mean": 12337.047169722524, "dps_min": 9895.374349619477, "dps_max": 15949.267706437682}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.023114240682254, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.835471669063773, "policy_loss": -0.033042015769689154, "vf_loss": 9.863831341651178, "vf_explained_var": 0.0054316562990988455, "kl": 0.010405192459231702, "entropy": 1.2022108288862372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 1913.9121247725202, "episode_reward_min": 1187.4449219543376, "episode_reward_mean": 1480.4456603667024, "episode_len_mean": 188.82, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12337.047169722524, "dps_min": 9895.374349619477, "dps_max": 15949.267706437682}, "hist_stats": {"episode_reward": [1638.540778587572, 1504.4167317154709, 1759.579503092203, 1413.1514944272367, 1443.675732404267, 1501.3674583710156, 1397.6692717024453, 1305.98932817785, 1538.0661008540021, 1358.4277288265405, 1299.2195368960047, 1485.3742201675411, 1529.9615917919325, 1453.590024706812, 1632.4130600462568, 1508.473837044312, 1394.8698220687738, 1589.406181280329, 1532.019307768354, 1379.3294990140573, 1511.1989006696913, 1564.6870299563086, 1518.2994415956096, 1401.4051813014448, 1327.4734528185804, 1420.8071267933938, 1391.0755907849825, 1361.750748221227, 1294.7398212420048, 1575.4812581430854, 1408.9522784433682, 1420.9644894718178, 1233.82880817912, 1416.0486610477942, 1253.2601039496956, 1550.5723503375038, 1390.9991289900208, 1606.0817727299811, 1408.5864614941763, 1496.5105601272212, 1850.521901799945, 1410.0525699375307, 1304.6131865738803, 1621.4782987729745, 1759.80626034396, 1305.9278157988495, 1812.049478636663, 1913.9121247725202, 1393.1970275321025, 1408.350600002866, 1366.6630398313341, 1479.7369319699783, 1475.511738248214, 1537.6440939514139, 1423.6817282216523, 1459.1308274340772, 1843.0190277271438, 1573.6050431647582, 1745.5807750966746, 1447.817740546509, 1623.644466858084, 1481.0921210996758, 1531.9019753893015, 1428.4435494478635, 1502.588802808354, 1597.1610927145111, 1446.137215411914, 1543.223712162916, 1816.5249109262595, 1333.0025749056888, 1460.6312857899343, 1761.7266491627313, 1644.8308102733147, 1600.6207253313353, 1796.018191949557, 1825.1779652206023, 1384.7469350627837, 1249.887048554213, 1515.3546247171369, 1423.8067651572928, 1477.5537890750172, 1265.3508379864413, 1588.919754649937, 1571.4461112468948, 1490.774138719465, 1343.5620438328413, 1544.6986108902338, 1389.3094666789534, 1243.0309155754248, 1323.8899122035198, 1476.6724140383617, 1322.907782165987, 1349.8360010067902, 1412.5538646081236, 1290.9068785898767, 1398.7819698620547, 1377.4832558347211, 1271.7541779461308, 1400.603181258636, 1187.4449219543376], "episode_lengths": [231, 188, 261, 201, 193, 200, 167, 166, 204, 176, 140, 191, 216, 199, 190, 195, 177, 181, 198, 173, 183, 184, 185, 174, 164, 145, 188, 165, 164, 210, 179, 179, 130, 162, 150, 188, 171, 196, 176, 179, 254, 192, 160, 214, 236, 192, 259, 271, 175, 184, 142, 180, 164, 204, 181, 175, 274, 197, 235, 194, 229, 184, 190, 193, 195, 215, 184, 219, 272, 155, 171, 249, 196, 230, 246, 282, 193, 144, 180, 149, 181, 176, 181, 177, 188, 174, 206, 174, 142, 179, 184, 162, 165, 164, 149, 162, 180, 141, 176, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25149233665061405, "mean_inference_ms": 0.9792115219028793, "mean_action_processing_ms": 0.08700512914913773, "mean_env_wait_ms": 0.4948012922008068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1913.9121247725202, "episode_reward_min": 1187.4449219543376, "episode_reward_mean": 1480.4456603667024, "episode_len_mean": 188.82, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1638.540778587572, 1504.4167317154709, 1759.579503092203, 1413.1514944272367, 1443.675732404267, 1501.3674583710156, 1397.6692717024453, 1305.98932817785, 1538.0661008540021, 1358.4277288265405, 1299.2195368960047, 1485.3742201675411, 1529.9615917919325, 1453.590024706812, 1632.4130600462568, 1508.473837044312, 1394.8698220687738, 1589.406181280329, 1532.019307768354, 1379.3294990140573, 1511.1989006696913, 1564.6870299563086, 1518.2994415956096, 1401.4051813014448, 1327.4734528185804, 1420.8071267933938, 1391.0755907849825, 1361.750748221227, 1294.7398212420048, 1575.4812581430854, 1408.9522784433682, 1420.9644894718178, 1233.82880817912, 1416.0486610477942, 1253.2601039496956, 1550.5723503375038, 1390.9991289900208, 1606.0817727299811, 1408.5864614941763, 1496.5105601272212, 1850.521901799945, 1410.0525699375307, 1304.6131865738803, 1621.4782987729745, 1759.80626034396, 1305.9278157988495, 1812.049478636663, 1913.9121247725202, 1393.1970275321025, 1408.350600002866, 1366.6630398313341, 1479.7369319699783, 1475.511738248214, 1537.6440939514139, 1423.6817282216523, 1459.1308274340772, 1843.0190277271438, 1573.6050431647582, 1745.5807750966746, 1447.817740546509, 1623.644466858084, 1481.0921210996758, 1531.9019753893015, 1428.4435494478635, 1502.588802808354, 1597.1610927145111, 1446.137215411914, 1543.223712162916, 1816.5249109262595, 1333.0025749056888, 1460.6312857899343, 1761.7266491627313, 1644.8308102733147, 1600.6207253313353, 1796.018191949557, 1825.1779652206023, 1384.7469350627837, 1249.887048554213, 1515.3546247171369, 1423.8067651572928, 1477.5537890750172, 1265.3508379864413, 1588.919754649937, 1571.4461112468948, 1490.774138719465, 1343.5620438328413, 1544.6986108902338, 1389.3094666789534, 1243.0309155754248, 1323.8899122035198, 1476.6724140383617, 1322.907782165987, 1349.8360010067902, 1412.5538646081236, 1290.9068785898767, 1398.7819698620547, 1377.4832558347211, 1271.7541779461308, 1400.603181258636, 1187.4449219543376], "episode_lengths": [231, 188, 261, 201, 193, 200, 167, 166, 204, 176, 140, 191, 216, 199, 190, 195, 177, 181, 198, 173, 183, 184, 185, 174, 164, 145, 188, 165, 164, 210, 179, 179, 130, 162, 150, 188, 171, 196, 176, 179, 254, 192, 160, 214, 236, 192, 259, 271, 175, 184, 142, 180, 164, 204, 181, 175, 274, 197, 235, 194, 229, 184, 190, 193, 195, 215, 184, 219, 272, 155, 171, 249, 196, 230, 246, 282, 193, 144, 180, 149, 181, 176, 181, 177, 188, 174, 206, 174, 142, 179, 184, 162, 165, 164, 149, 162, 180, 141, 176, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25149233665061405, "mean_inference_ms": 0.9792115219028793, "mean_action_processing_ms": 0.08700512914913773, "mean_env_wait_ms": 0.4948012922008068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 6965.219, "sample_time_ms": 669.802, "load_time_ms": 0.16, "load_throughput": 24925294.904, "learn_time_ms": 6282.02, "learn_throughput": 636.738, "synch_weights_time_ms": 12.532}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 859, "training_iteration": 43, "trial_id": "2db34_00000", "date": "2023-04-30_17-01-05", "timestamp": 1682848865, "time_this_iter_s": 6.957230806350708, "time_total_s": 300.6863520145416, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 300.6863520145416, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 8.63, "ram_util_percent": 67.76999999999998}}
{"custom_metrics": {"dps_mean": 12302.982785171573, "dps_min": 9895.374349619477, "dps_max": 15949.267706437682}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.58480948921173, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.781351577594716, "policy_loss": -0.029271468871663656, "vf_loss": 9.806596463726413, "vf_explained_var": 0.003537027682027509, "kl": 0.008948004581886961, "entropy": 1.1266275035758173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 1913.9121247725202, "episode_reward_min": 1187.4449219543376, "episode_reward_mean": 1476.3579342205883, "episode_len_mean": 186.29, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12302.982785171573, "dps_min": 9895.374349619477, "dps_max": 15949.267706437682}, "hist_stats": {"episode_reward": [1391.0755907849825, 1361.750748221227, 1294.7398212420048, 1575.4812581430854, 1408.9522784433682, 1420.9644894718178, 1233.82880817912, 1416.0486610477942, 1253.2601039496956, 1550.5723503375038, 1390.9991289900208, 1606.0817727299811, 1408.5864614941763, 1496.5105601272212, 1850.521901799945, 1410.0525699375307, 1304.6131865738803, 1621.4782987729745, 1759.80626034396, 1305.9278157988495, 1812.049478636663, 1913.9121247725202, 1393.1970275321025, 1408.350600002866, 1366.6630398313341, 1479.7369319699783, 1475.511738248214, 1537.6440939514139, 1423.6817282216523, 1459.1308274340772, 1843.0190277271438, 1573.6050431647582, 1745.5807750966746, 1447.817740546509, 1623.644466858084, 1481.0921210996758, 1531.9019753893015, 1428.4435494478635, 1502.588802808354, 1597.1610927145111, 1446.137215411914, 1543.223712162916, 1816.5249109262595, 1333.0025749056888, 1460.6312857899343, 1761.7266491627313, 1644.8308102733147, 1600.6207253313353, 1796.018191949557, 1825.1779652206023, 1384.7469350627837, 1249.887048554213, 1515.3546247171369, 1423.8067651572928, 1477.5537890750172, 1265.3508379864413, 1588.919754649937, 1571.4461112468948, 1490.774138719465, 1343.5620438328413, 1544.6986108902338, 1389.3094666789534, 1243.0309155754248, 1323.8899122035198, 1476.6724140383617, 1322.907782165987, 1349.8360010067902, 1412.5538646081236, 1290.9068785898767, 1398.7819698620547, 1377.4832558347211, 1271.7541779461308, 1400.603181258636, 1187.4449219543376, 1450.7088900537015, 1420.5577574092888, 1457.6939907547373, 1710.3731024006734, 1402.6324401271777, 1461.441186920736, 1307.7842588356839, 1629.975707383159, 1698.88342519166, 1361.1440795218066, 1471.061923581007, 1640.205705494211, 1431.6916531777133, 1454.370800807884, 1354.7099761215, 1412.3351461617917, 1320.8919446997177, 1498.9053474221214, 1504.8928974497746, 1383.9739623597432, 1369.5324036282034, 1412.8498817675504, 1469.4167217167335, 1432.6108162003034, 1374.401204505289, 1567.594503774425], "episode_lengths": [188, 165, 164, 210, 179, 179, 130, 162, 150, 188, 171, 196, 176, 179, 254, 192, 160, 214, 236, 192, 259, 271, 175, 184, 142, 180, 164, 204, 181, 175, 274, 197, 235, 194, 229, 184, 190, 193, 195, 215, 184, 219, 272, 155, 171, 249, 196, 230, 246, 282, 193, 144, 180, 149, 181, 176, 181, 177, 188, 174, 206, 174, 142, 179, 184, 162, 165, 164, 149, 162, 180, 141, 176, 143, 167, 189, 172, 217, 174, 194, 152, 208, 225, 162, 196, 212, 181, 186, 130, 165, 162, 201, 172, 167, 154, 160, 171, 169, 149, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25157562603700806, "mean_inference_ms": 0.9784958587293169, "mean_action_processing_ms": 0.08708934364936406, "mean_env_wait_ms": 0.4947623728257441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1913.9121247725202, "episode_reward_min": 1187.4449219543376, "episode_reward_mean": 1476.3579342205883, "episode_len_mean": 186.29, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1391.0755907849825, 1361.750748221227, 1294.7398212420048, 1575.4812581430854, 1408.9522784433682, 1420.9644894718178, 1233.82880817912, 1416.0486610477942, 1253.2601039496956, 1550.5723503375038, 1390.9991289900208, 1606.0817727299811, 1408.5864614941763, 1496.5105601272212, 1850.521901799945, 1410.0525699375307, 1304.6131865738803, 1621.4782987729745, 1759.80626034396, 1305.9278157988495, 1812.049478636663, 1913.9121247725202, 1393.1970275321025, 1408.350600002866, 1366.6630398313341, 1479.7369319699783, 1475.511738248214, 1537.6440939514139, 1423.6817282216523, 1459.1308274340772, 1843.0190277271438, 1573.6050431647582, 1745.5807750966746, 1447.817740546509, 1623.644466858084, 1481.0921210996758, 1531.9019753893015, 1428.4435494478635, 1502.588802808354, 1597.1610927145111, 1446.137215411914, 1543.223712162916, 1816.5249109262595, 1333.0025749056888, 1460.6312857899343, 1761.7266491627313, 1644.8308102733147, 1600.6207253313353, 1796.018191949557, 1825.1779652206023, 1384.7469350627837, 1249.887048554213, 1515.3546247171369, 1423.8067651572928, 1477.5537890750172, 1265.3508379864413, 1588.919754649937, 1571.4461112468948, 1490.774138719465, 1343.5620438328413, 1544.6986108902338, 1389.3094666789534, 1243.0309155754248, 1323.8899122035198, 1476.6724140383617, 1322.907782165987, 1349.8360010067902, 1412.5538646081236, 1290.9068785898767, 1398.7819698620547, 1377.4832558347211, 1271.7541779461308, 1400.603181258636, 1187.4449219543376, 1450.7088900537015, 1420.5577574092888, 1457.6939907547373, 1710.3731024006734, 1402.6324401271777, 1461.441186920736, 1307.7842588356839, 1629.975707383159, 1698.88342519166, 1361.1440795218066, 1471.061923581007, 1640.205705494211, 1431.6916531777133, 1454.370800807884, 1354.7099761215, 1412.3351461617917, 1320.8919446997177, 1498.9053474221214, 1504.8928974497746, 1383.9739623597432, 1369.5324036282034, 1412.8498817675504, 1469.4167217167335, 1432.6108162003034, 1374.401204505289, 1567.594503774425], "episode_lengths": [188, 165, 164, 210, 179, 179, 130, 162, 150, 188, 171, 196, 176, 179, 254, 192, 160, 214, 236, 192, 259, 271, 175, 184, 142, 180, 164, 204, 181, 175, 274, 197, 235, 194, 229, 184, 190, 193, 195, 215, 184, 219, 272, 155, 171, 249, 196, 230, 246, 282, 193, 144, 180, 149, 181, 176, 181, 177, 188, 174, 206, 174, 142, 179, 184, 162, 165, 164, 149, 162, 180, 141, 176, 143, 167, 189, 172, 217, 174, 194, 152, 208, 225, 162, 196, 212, 181, 186, 130, 165, 162, 201, 172, 167, 154, 160, 171, 169, 149, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25157562603700806, "mean_inference_ms": 0.9784958587293169, "mean_action_processing_ms": 0.08708934364936406, "mean_env_wait_ms": 0.4947623728257441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 6970.273, "sample_time_ms": 677.666, "load_time_ms": 0.16, "load_throughput": 24925294.904, "learn_time_ms": 6279.217, "learn_throughput": 637.022, "synch_weights_time_ms": 12.425}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 885, "training_iteration": 44, "trial_id": "2db34_00000", "date": "2023-04-30_17-01-12", "timestamp": 1682848872, "time_this_iter_s": 7.028879165649414, "time_total_s": 307.71523118019104, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 307.71523118019104, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 10.7, "ram_util_percent": 67.74999999999999}}
{"custom_metrics": {"dps_mean": 12191.672782685955, "dps_min": 9895.374349619477, "dps_max": 15949.267706437682}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.787491636250607, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.787465918961392, "policy_loss": -0.028484764117346975, "vf_loss": 9.811857603955012, "vf_explained_var": 0.011682071288426717, "kl": 0.00909573174194431, "entropy": 1.0915429788891988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 1913.9121247725202, "episode_reward_min": 1187.4449219543376, "episode_reward_mean": 1463.0007339223148, "episode_len_mean": 184.26, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12191.672782685955, "dps_min": 9895.374349619477, "dps_max": 15949.267706437682}, "hist_stats": {"episode_reward": [1913.9121247725202, 1393.1970275321025, 1408.350600002866, 1366.6630398313341, 1479.7369319699783, 1475.511738248214, 1537.6440939514139, 1423.6817282216523, 1459.1308274340772, 1843.0190277271438, 1573.6050431647582, 1745.5807750966746, 1447.817740546509, 1623.644466858084, 1481.0921210996758, 1531.9019753893015, 1428.4435494478635, 1502.588802808354, 1597.1610927145111, 1446.137215411914, 1543.223712162916, 1816.5249109262595, 1333.0025749056888, 1460.6312857899343, 1761.7266491627313, 1644.8308102733147, 1600.6207253313353, 1796.018191949557, 1825.1779652206023, 1384.7469350627837, 1249.887048554213, 1515.3546247171369, 1423.8067651572928, 1477.5537890750172, 1265.3508379864413, 1588.919754649937, 1571.4461112468948, 1490.774138719465, 1343.5620438328413, 1544.6986108902338, 1389.3094666789534, 1243.0309155754248, 1323.8899122035198, 1476.6724140383617, 1322.907782165987, 1349.8360010067902, 1412.5538646081236, 1290.9068785898767, 1398.7819698620547, 1377.4832558347211, 1271.7541779461308, 1400.603181258636, 1187.4449219543376, 1450.7088900537015, 1420.5577574092888, 1457.6939907547373, 1710.3731024006734, 1402.6324401271777, 1461.441186920736, 1307.7842588356839, 1629.975707383159, 1698.88342519166, 1361.1440795218066, 1471.061923581007, 1640.205705494211, 1431.6916531777133, 1454.370800807884, 1354.7099761215, 1412.3351461617917, 1320.8919446997177, 1498.9053474221214, 1504.8928974497746, 1383.9739623597432, 1369.5324036282034, 1412.8498817675504, 1469.4167217167335, 1432.6108162003034, 1374.401204505289, 1567.594503774425, 1291.1795118512694, 1656.4914657689299, 1411.3123043987048, 1523.3342260658571, 1395.2529129696397, 1496.5214024912764, 1385.865035669736, 1416.4658422715595, 1381.441459297317, 1290.7666500777675, 1374.2590222001281, 1197.1686330433138, 1644.3544790141148, 1430.3867013934714, 1272.7728899449878, 1472.4282334919044, 1336.6928957463144, 1420.7524386884338, 1375.6994843404023, 1327.4916981571266, 1436.9442283161582], "episode_lengths": [271, 175, 184, 142, 180, 164, 204, 181, 175, 274, 197, 235, 194, 229, 184, 190, 193, 195, 215, 184, 219, 272, 155, 171, 249, 196, 230, 246, 282, 193, 144, 180, 149, 181, 176, 181, 177, 188, 174, 206, 174, 142, 179, 184, 162, 165, 164, 149, 162, 180, 141, 176, 143, 167, 189, 172, 217, 174, 194, 152, 208, 225, 162, 196, 212, 181, 186, 130, 165, 162, 201, 172, 167, 154, 160, 171, 169, 149, 194, 154, 222, 158, 203, 175, 173, 175, 157, 200, 150, 170, 143, 253, 159, 159, 221, 163, 202, 165, 173, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516128222092029, "mean_inference_ms": 0.9780947374404844, "mean_action_processing_ms": 0.08700403573419745, "mean_env_wait_ms": 0.4946955462250985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1913.9121247725202, "episode_reward_min": 1187.4449219543376, "episode_reward_mean": 1463.0007339223148, "episode_len_mean": 184.26, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1913.9121247725202, 1393.1970275321025, 1408.350600002866, 1366.6630398313341, 1479.7369319699783, 1475.511738248214, 1537.6440939514139, 1423.6817282216523, 1459.1308274340772, 1843.0190277271438, 1573.6050431647582, 1745.5807750966746, 1447.817740546509, 1623.644466858084, 1481.0921210996758, 1531.9019753893015, 1428.4435494478635, 1502.588802808354, 1597.1610927145111, 1446.137215411914, 1543.223712162916, 1816.5249109262595, 1333.0025749056888, 1460.6312857899343, 1761.7266491627313, 1644.8308102733147, 1600.6207253313353, 1796.018191949557, 1825.1779652206023, 1384.7469350627837, 1249.887048554213, 1515.3546247171369, 1423.8067651572928, 1477.5537890750172, 1265.3508379864413, 1588.919754649937, 1571.4461112468948, 1490.774138719465, 1343.5620438328413, 1544.6986108902338, 1389.3094666789534, 1243.0309155754248, 1323.8899122035198, 1476.6724140383617, 1322.907782165987, 1349.8360010067902, 1412.5538646081236, 1290.9068785898767, 1398.7819698620547, 1377.4832558347211, 1271.7541779461308, 1400.603181258636, 1187.4449219543376, 1450.7088900537015, 1420.5577574092888, 1457.6939907547373, 1710.3731024006734, 1402.6324401271777, 1461.441186920736, 1307.7842588356839, 1629.975707383159, 1698.88342519166, 1361.1440795218066, 1471.061923581007, 1640.205705494211, 1431.6916531777133, 1454.370800807884, 1354.7099761215, 1412.3351461617917, 1320.8919446997177, 1498.9053474221214, 1504.8928974497746, 1383.9739623597432, 1369.5324036282034, 1412.8498817675504, 1469.4167217167335, 1432.6108162003034, 1374.401204505289, 1567.594503774425, 1291.1795118512694, 1656.4914657689299, 1411.3123043987048, 1523.3342260658571, 1395.2529129696397, 1496.5214024912764, 1385.865035669736, 1416.4658422715595, 1381.441459297317, 1290.7666500777675, 1374.2590222001281, 1197.1686330433138, 1644.3544790141148, 1430.3867013934714, 1272.7728899449878, 1472.4282334919044, 1336.6928957463144, 1420.7524386884338, 1375.6994843404023, 1327.4916981571266, 1436.9442283161582], "episode_lengths": [271, 175, 184, 142, 180, 164, 204, 181, 175, 274, 197, 235, 194, 229, 184, 190, 193, 195, 215, 184, 219, 272, 155, 171, 249, 196, 230, 246, 282, 193, 144, 180, 149, 181, 176, 181, 177, 188, 174, 206, 174, 142, 179, 184, 162, 165, 164, 149, 162, 180, 141, 176, 143, 167, 189, 172, 217, 174, 194, 152, 208, 225, 162, 196, 212, 181, 186, 130, 165, 162, 201, 172, 167, 154, 160, 171, 169, 149, 194, 154, 222, 158, 203, 175, 173, 175, 157, 200, 150, 170, 143, 253, 159, 159, 221, 163, 202, 165, 173, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516128222092029, "mean_inference_ms": 0.9780947374404844, "mean_action_processing_ms": 0.08700403573419745, "mean_env_wait_ms": 0.4946955462250985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 6961.843, "sample_time_ms": 669.307, "load_time_ms": 0.16, "load_throughput": 24925294.904, "learn_time_ms": 6279.084, "learn_throughput": 637.036, "synch_weights_time_ms": 12.486}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 906, "training_iteration": 45, "trial_id": "2db34_00000", "date": "2023-04-30_17-01-19", "timestamp": 1682848879, "time_this_iter_s": 6.938496112823486, "time_total_s": 314.6537272930145, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 314.6537272930145, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 7.269999999999999, "ram_util_percent": 67.85999999999999}}
{"custom_metrics": {"dps_mean": 12124.168377370972, "dps_min": 9895.374349619477, "dps_max": 16096.77182740057}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.17762970450104, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.797936281593897, "policy_loss": -0.0316505153057596, "vf_loss": 9.82533522677678, "vf_explained_var": 0.0054509569239872754, "kl": 0.009447846770752699, "entropy": 1.064814845720927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 1931.6126192880686, "episode_reward_min": 1187.4449219543376, "episode_reward_mean": 1454.9002052845165, "episode_len_mean": 181.79, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12124.168377370972, "dps_min": 9895.374349619477, "dps_max": 16096.77182740057}, "hist_stats": {"episode_reward": [1816.5249109262595, 1333.0025749056888, 1460.6312857899343, 1761.7266491627313, 1644.8308102733147, 1600.6207253313353, 1796.018191949557, 1825.1779652206023, 1384.7469350627837, 1249.887048554213, 1515.3546247171369, 1423.8067651572928, 1477.5537890750172, 1265.3508379864413, 1588.919754649937, 1571.4461112468948, 1490.774138719465, 1343.5620438328413, 1544.6986108902338, 1389.3094666789534, 1243.0309155754248, 1323.8899122035198, 1476.6724140383617, 1322.907782165987, 1349.8360010067902, 1412.5538646081236, 1290.9068785898767, 1398.7819698620547, 1377.4832558347211, 1271.7541779461308, 1400.603181258636, 1187.4449219543376, 1450.7088900537015, 1420.5577574092888, 1457.6939907547373, 1710.3731024006734, 1402.6324401271777, 1461.441186920736, 1307.7842588356839, 1629.975707383159, 1698.88342519166, 1361.1440795218066, 1471.061923581007, 1640.205705494211, 1431.6916531777133, 1454.370800807884, 1354.7099761215, 1412.3351461617917, 1320.8919446997177, 1498.9053474221214, 1504.8928974497746, 1383.9739623597432, 1369.5324036282034, 1412.8498817675504, 1469.4167217167335, 1432.6108162003034, 1374.401204505289, 1567.594503774425, 1291.1795118512694, 1656.4914657689299, 1411.3123043987048, 1523.3342260658571, 1395.2529129696397, 1496.5214024912764, 1385.865035669736, 1416.4658422715595, 1381.441459297317, 1290.7666500777675, 1374.2590222001281, 1197.1686330433138, 1644.3544790141148, 1430.3867013934714, 1272.7728899449878, 1472.4282334919044, 1336.6928957463144, 1420.7524386884338, 1375.6994843404023, 1327.4916981571266, 1436.9442283161582, 1316.1785265139822, 1454.9510588161556, 1490.1580676518556, 1443.4678754099841, 1285.5627514146674, 1467.9671020964383, 1485.4643731564624, 1602.6755081653334, 1492.5422256938036, 1516.1071929793122, 1641.6589634508196, 1318.1113570548193, 1386.5386987851011, 1469.333881142497, 1697.9645759316306, 1550.6038664832704, 1498.1621947074389, 1404.9514170770008, 1431.2787181586355, 1526.6997966347653, 1931.6126192880686], "episode_lengths": [272, 155, 171, 249, 196, 230, 246, 282, 193, 144, 180, 149, 181, 176, 181, 177, 188, 174, 206, 174, 142, 179, 184, 162, 165, 164, 149, 162, 180, 141, 176, 143, 167, 189, 172, 217, 174, 194, 152, 208, 225, 162, 196, 212, 181, 186, 130, 165, 162, 201, 172, 167, 154, 160, 171, 169, 149, 194, 154, 222, 158, 203, 175, 173, 175, 157, 200, 150, 170, 143, 253, 159, 159, 221, 163, 202, 165, 173, 166, 162, 184, 228, 165, 157, 203, 199, 211, 167, 199, 195, 183, 176, 196, 203, 182, 176, 179, 174, 178, 221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25179270760994565, "mean_inference_ms": 0.9770276884137843, "mean_action_processing_ms": 0.08689467162516279, "mean_env_wait_ms": 0.4943986029363522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1931.6126192880686, "episode_reward_min": 1187.4449219543376, "episode_reward_mean": 1454.9002052845165, "episode_len_mean": 181.79, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1816.5249109262595, 1333.0025749056888, 1460.6312857899343, 1761.7266491627313, 1644.8308102733147, 1600.6207253313353, 1796.018191949557, 1825.1779652206023, 1384.7469350627837, 1249.887048554213, 1515.3546247171369, 1423.8067651572928, 1477.5537890750172, 1265.3508379864413, 1588.919754649937, 1571.4461112468948, 1490.774138719465, 1343.5620438328413, 1544.6986108902338, 1389.3094666789534, 1243.0309155754248, 1323.8899122035198, 1476.6724140383617, 1322.907782165987, 1349.8360010067902, 1412.5538646081236, 1290.9068785898767, 1398.7819698620547, 1377.4832558347211, 1271.7541779461308, 1400.603181258636, 1187.4449219543376, 1450.7088900537015, 1420.5577574092888, 1457.6939907547373, 1710.3731024006734, 1402.6324401271777, 1461.441186920736, 1307.7842588356839, 1629.975707383159, 1698.88342519166, 1361.1440795218066, 1471.061923581007, 1640.205705494211, 1431.6916531777133, 1454.370800807884, 1354.7099761215, 1412.3351461617917, 1320.8919446997177, 1498.9053474221214, 1504.8928974497746, 1383.9739623597432, 1369.5324036282034, 1412.8498817675504, 1469.4167217167335, 1432.6108162003034, 1374.401204505289, 1567.594503774425, 1291.1795118512694, 1656.4914657689299, 1411.3123043987048, 1523.3342260658571, 1395.2529129696397, 1496.5214024912764, 1385.865035669736, 1416.4658422715595, 1381.441459297317, 1290.7666500777675, 1374.2590222001281, 1197.1686330433138, 1644.3544790141148, 1430.3867013934714, 1272.7728899449878, 1472.4282334919044, 1336.6928957463144, 1420.7524386884338, 1375.6994843404023, 1327.4916981571266, 1436.9442283161582, 1316.1785265139822, 1454.9510588161556, 1490.1580676518556, 1443.4678754099841, 1285.5627514146674, 1467.9671020964383, 1485.4643731564624, 1602.6755081653334, 1492.5422256938036, 1516.1071929793122, 1641.6589634508196, 1318.1113570548193, 1386.5386987851011, 1469.333881142497, 1697.9645759316306, 1550.6038664832704, 1498.1621947074389, 1404.9514170770008, 1431.2787181586355, 1526.6997966347653, 1931.6126192880686], "episode_lengths": [272, 155, 171, 249, 196, 230, 246, 282, 193, 144, 180, 149, 181, 176, 181, 177, 188, 174, 206, 174, 142, 179, 184, 162, 165, 164, 149, 162, 180, 141, 176, 143, 167, 189, 172, 217, 174, 194, 152, 208, 225, 162, 196, 212, 181, 186, 130, 165, 162, 201, 172, 167, 154, 160, 171, 169, 149, 194, 154, 222, 158, 203, 175, 173, 175, 157, 200, 150, 170, 143, 253, 159, 159, 221, 163, 202, 165, 173, 166, 162, 184, 228, 165, 157, 203, 199, 211, 167, 199, 195, 183, 176, 196, 203, 182, 176, 179, 174, 178, 221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25179270760994565, "mean_inference_ms": 0.9770276884137843, "mean_action_processing_ms": 0.08689467162516279, "mean_env_wait_ms": 0.4943986029363522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 6952.36, "sample_time_ms": 670.702, "load_time_ms": 0.26, "load_throughput": 15356719.451, "learn_time_ms": 6268.056, "learn_throughput": 638.156, "synch_weights_time_ms": 12.536}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 927, "training_iteration": 46, "trial_id": "2db34_00000", "date": "2023-04-30_17-01-26", "timestamp": 1682848886, "time_this_iter_s": 6.838416576385498, "time_total_s": 321.4921438694, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 321.4921438694, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 7.955555555555557, "ram_util_percent": 67.83333333333333}}
{"custom_metrics": {"dps_mean": 12337.70613419899, "dps_min": 9895.374349619477, "dps_max": 17690.22731977506}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.744099550670192, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.867342099835795, "policy_loss": -0.031510680867859756, "vf_loss": 9.894948003625357, "vf_explained_var": 0.013482077147371025, "kl": 0.008677270638606084, "entropy": 0.8552712756699772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 2122.8272783730063, "episode_reward_min": 1187.4449219543376, "episode_reward_mean": 1480.5247361038791, "episode_len_mean": 185.5, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12337.70613419899, "dps_min": 9895.374349619477, "dps_max": 17690.22731977506}, "hist_stats": {"episode_reward": [1343.5620438328413, 1544.6986108902338, 1389.3094666789534, 1243.0309155754248, 1323.8899122035198, 1476.6724140383617, 1322.907782165987, 1349.8360010067902, 1412.5538646081236, 1290.9068785898767, 1398.7819698620547, 1377.4832558347211, 1271.7541779461308, 1400.603181258636, 1187.4449219543376, 1450.7088900537015, 1420.5577574092888, 1457.6939907547373, 1710.3731024006734, 1402.6324401271777, 1461.441186920736, 1307.7842588356839, 1629.975707383159, 1698.88342519166, 1361.1440795218066, 1471.061923581007, 1640.205705494211, 1431.6916531777133, 1454.370800807884, 1354.7099761215, 1412.3351461617917, 1320.8919446997177, 1498.9053474221214, 1504.8928974497746, 1383.9739623597432, 1369.5324036282034, 1412.8498817675504, 1469.4167217167335, 1432.6108162003034, 1374.401204505289, 1567.594503774425, 1291.1795118512694, 1656.4914657689299, 1411.3123043987048, 1523.3342260658571, 1395.2529129696397, 1496.5214024912764, 1385.865035669736, 1416.4658422715595, 1381.441459297317, 1290.7666500777675, 1374.2590222001281, 1197.1686330433138, 1644.3544790141148, 1430.3867013934714, 1272.7728899449878, 1472.4282334919044, 1336.6928957463144, 1420.7524386884338, 1375.6994843404023, 1327.4916981571266, 1436.9442283161582, 1316.1785265139822, 1454.9510588161556, 1490.1580676518556, 1443.4678754099841, 1285.5627514146674, 1467.9671020964383, 1485.4643731564624, 1602.6755081653334, 1492.5422256938036, 1516.1071929793122, 1641.6589634508196, 1318.1113570548193, 1386.5386987851011, 1469.333881142497, 1697.9645759316306, 1550.6038664832704, 1498.1621947074389, 1404.9514170770008, 1431.2787181586355, 1526.6997966347653, 1931.6126192880686, 1460.5869012291423, 1427.799666760257, 1634.268370848231, 1464.3250544539233, 1573.5401211086817, 1506.0058046493034, 1683.2150422575921, 1552.0254905092206, 1667.7556372531333, 1962.825663262258, 1542.8891943312294, 1428.6950557808564, 2122.8272783730063, 1939.3356604698113, 1881.7131762453967, 1925.6575891778084, 1995.360493955038], "episode_lengths": [174, 206, 174, 142, 179, 184, 162, 165, 164, 149, 162, 180, 141, 176, 143, 167, 189, 172, 217, 174, 194, 152, 208, 225, 162, 196, 212, 181, 186, 130, 165, 162, 201, 172, 167, 154, 160, 171, 169, 149, 194, 154, 222, 158, 203, 175, 173, 175, 157, 200, 150, 170, 143, 253, 159, 159, 221, 163, 202, 165, 173, 166, 162, 184, 228, 165, 157, 203, 199, 211, 167, 199, 195, 183, 176, 196, 203, 182, 176, 179, 174, 178, 221, 167, 156, 189, 144, 184, 195, 216, 192, 228, 286, 208, 172, 286, 270, 288, 275, 285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2515009606212549, "mean_inference_ms": 0.976728381943352, "mean_action_processing_ms": 0.0869688765199728, "mean_env_wait_ms": 0.49427326016470924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 2122.8272783730063, "episode_reward_min": 1187.4449219543376, "episode_reward_mean": 1480.5247361038791, "episode_len_mean": 185.5, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1343.5620438328413, 1544.6986108902338, 1389.3094666789534, 1243.0309155754248, 1323.8899122035198, 1476.6724140383617, 1322.907782165987, 1349.8360010067902, 1412.5538646081236, 1290.9068785898767, 1398.7819698620547, 1377.4832558347211, 1271.7541779461308, 1400.603181258636, 1187.4449219543376, 1450.7088900537015, 1420.5577574092888, 1457.6939907547373, 1710.3731024006734, 1402.6324401271777, 1461.441186920736, 1307.7842588356839, 1629.975707383159, 1698.88342519166, 1361.1440795218066, 1471.061923581007, 1640.205705494211, 1431.6916531777133, 1454.370800807884, 1354.7099761215, 1412.3351461617917, 1320.8919446997177, 1498.9053474221214, 1504.8928974497746, 1383.9739623597432, 1369.5324036282034, 1412.8498817675504, 1469.4167217167335, 1432.6108162003034, 1374.401204505289, 1567.594503774425, 1291.1795118512694, 1656.4914657689299, 1411.3123043987048, 1523.3342260658571, 1395.2529129696397, 1496.5214024912764, 1385.865035669736, 1416.4658422715595, 1381.441459297317, 1290.7666500777675, 1374.2590222001281, 1197.1686330433138, 1644.3544790141148, 1430.3867013934714, 1272.7728899449878, 1472.4282334919044, 1336.6928957463144, 1420.7524386884338, 1375.6994843404023, 1327.4916981571266, 1436.9442283161582, 1316.1785265139822, 1454.9510588161556, 1490.1580676518556, 1443.4678754099841, 1285.5627514146674, 1467.9671020964383, 1485.4643731564624, 1602.6755081653334, 1492.5422256938036, 1516.1071929793122, 1641.6589634508196, 1318.1113570548193, 1386.5386987851011, 1469.333881142497, 1697.9645759316306, 1550.6038664832704, 1498.1621947074389, 1404.9514170770008, 1431.2787181586355, 1526.6997966347653, 1931.6126192880686, 1460.5869012291423, 1427.799666760257, 1634.268370848231, 1464.3250544539233, 1573.5401211086817, 1506.0058046493034, 1683.2150422575921, 1552.0254905092206, 1667.7556372531333, 1962.825663262258, 1542.8891943312294, 1428.6950557808564, 2122.8272783730063, 1939.3356604698113, 1881.7131762453967, 1925.6575891778084, 1995.360493955038], "episode_lengths": [174, 206, 174, 142, 179, 184, 162, 165, 164, 149, 162, 180, 141, 176, 143, 167, 189, 172, 217, 174, 194, 152, 208, 225, 162, 196, 212, 181, 186, 130, 165, 162, 201, 172, 167, 154, 160, 171, 169, 149, 194, 154, 222, 158, 203, 175, 173, 175, 157, 200, 150, 170, 143, 253, 159, 159, 221, 163, 202, 165, 173, 166, 162, 184, 228, 165, 157, 203, 199, 211, 167, 199, 195, 183, 176, 196, 203, 182, 176, 179, 174, 178, 221, 167, 156, 189, 144, 184, 195, 216, 192, 228, 286, 208, 172, 286, 270, 288, 275, 285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2515009606212549, "mean_inference_ms": 0.976728381943352, "mean_action_processing_ms": 0.0869688765199728, "mean_env_wait_ms": 0.49427326016470924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 6941.69, "sample_time_ms": 670.955, "load_time_ms": 0.26, "load_throughput": 15356719.451, "learn_time_ms": 6257.233, "learn_throughput": 639.26, "synch_weights_time_ms": 12.537}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 944, "training_iteration": 47, "trial_id": "2db34_00000", "date": "2023-04-30_17-01-33", "timestamp": 1682848893, "time_this_iter_s": 6.806756019592285, "time_total_s": 328.2988998889923, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 328.2988998889923, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 8.02, "ram_util_percent": 67.72}}
{"custom_metrics": {"dps_mean": 12616.45928454503, "dps_min": 9976.40527536095, "dps_max": 17690.22731977506}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.349091281044867, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.863499647571194, "policy_loss": -0.029763386501700326, "vf_loss": 9.888348190758817, "vf_explained_var": 0.0047150060053794615, "kl": 0.010921862290934701, "entropy": 1.0680692335931203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 2122.8272783730063, "episode_reward_min": 1197.1686330433138, "episode_reward_mean": 1513.9751141454033, "episode_len_mean": 191.85, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12616.45928454503, "dps_min": 9976.40527536095, "dps_max": 17690.22731977506}, "hist_stats": {"episode_reward": [1307.7842588356839, 1629.975707383159, 1698.88342519166, 1361.1440795218066, 1471.061923581007, 1640.205705494211, 1431.6916531777133, 1454.370800807884, 1354.7099761215, 1412.3351461617917, 1320.8919446997177, 1498.9053474221214, 1504.8928974497746, 1383.9739623597432, 1369.5324036282034, 1412.8498817675504, 1469.4167217167335, 1432.6108162003034, 1374.401204505289, 1567.594503774425, 1291.1795118512694, 1656.4914657689299, 1411.3123043987048, 1523.3342260658571, 1395.2529129696397, 1496.5214024912764, 1385.865035669736, 1416.4658422715595, 1381.441459297317, 1290.7666500777675, 1374.2590222001281, 1197.1686330433138, 1644.3544790141148, 1430.3867013934714, 1272.7728899449878, 1472.4282334919044, 1336.6928957463144, 1420.7524386884338, 1375.6994843404023, 1327.4916981571266, 1436.9442283161582, 1316.1785265139822, 1454.9510588161556, 1490.1580676518556, 1443.4678754099841, 1285.5627514146674, 1467.9671020964383, 1485.4643731564624, 1602.6755081653334, 1492.5422256938036, 1516.1071929793122, 1641.6589634508196, 1318.1113570548193, 1386.5386987851011, 1469.333881142497, 1697.9645759316306, 1550.6038664832704, 1498.1621947074389, 1404.9514170770008, 1431.2787181586355, 1526.6997966347653, 1931.6126192880686, 1460.5869012291423, 1427.799666760257, 1634.268370848231, 1464.3250544539233, 1573.5401211086817, 1506.0058046493034, 1683.2150422575921, 1552.0254905092206, 1667.7556372531333, 1962.825663262258, 1542.8891943312294, 1428.6950557808564, 2122.8272783730063, 1939.3356604698113, 1881.7131762453967, 1925.6575891778084, 1995.360493955038, 1900.4903429126566, 1445.0848046272395, 1587.2122604634974, 1541.0435950945628, 1769.4788702771605, 1578.7075389710183, 1367.1863455484165, 1288.755063912992, 1636.1631841284577, 1542.6786037061795, 1281.3906833027697, 1298.8800847903624, 1716.6740884618764, 1961.1945179107204, 1250.3918419197664, 1637.7917469659492, 1471.2937030727132, 1693.9253082066466, 1628.2228332159123, 1525.0819674910506, 1460.2331832847935], "episode_lengths": [152, 208, 225, 162, 196, 212, 181, 186, 130, 165, 162, 201, 172, 167, 154, 160, 171, 169, 149, 194, 154, 222, 158, 203, 175, 173, 175, 157, 200, 150, 170, 143, 253, 159, 159, 221, 163, 202, 165, 173, 166, 162, 184, 228, 165, 157, 203, 199, 211, 167, 199, 195, 183, 176, 196, 203, 182, 176, 179, 174, 178, 221, 167, 156, 189, 144, 184, 195, 216, 192, 228, 286, 208, 172, 286, 270, 288, 275, 285, 277, 178, 206, 171, 229, 217, 185, 160, 201, 188, 159, 175, 261, 286, 171, 180, 196, 208, 218, 186, 197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2514864067728421, "mean_inference_ms": 0.9758935045124073, "mean_action_processing_ms": 0.08670168966066044, "mean_env_wait_ms": 0.49387176262629273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 2122.8272783730063, "episode_reward_min": 1197.1686330433138, "episode_reward_mean": 1513.9751141454033, "episode_len_mean": 191.85, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1307.7842588356839, 1629.975707383159, 1698.88342519166, 1361.1440795218066, 1471.061923581007, 1640.205705494211, 1431.6916531777133, 1454.370800807884, 1354.7099761215, 1412.3351461617917, 1320.8919446997177, 1498.9053474221214, 1504.8928974497746, 1383.9739623597432, 1369.5324036282034, 1412.8498817675504, 1469.4167217167335, 1432.6108162003034, 1374.401204505289, 1567.594503774425, 1291.1795118512694, 1656.4914657689299, 1411.3123043987048, 1523.3342260658571, 1395.2529129696397, 1496.5214024912764, 1385.865035669736, 1416.4658422715595, 1381.441459297317, 1290.7666500777675, 1374.2590222001281, 1197.1686330433138, 1644.3544790141148, 1430.3867013934714, 1272.7728899449878, 1472.4282334919044, 1336.6928957463144, 1420.7524386884338, 1375.6994843404023, 1327.4916981571266, 1436.9442283161582, 1316.1785265139822, 1454.9510588161556, 1490.1580676518556, 1443.4678754099841, 1285.5627514146674, 1467.9671020964383, 1485.4643731564624, 1602.6755081653334, 1492.5422256938036, 1516.1071929793122, 1641.6589634508196, 1318.1113570548193, 1386.5386987851011, 1469.333881142497, 1697.9645759316306, 1550.6038664832704, 1498.1621947074389, 1404.9514170770008, 1431.2787181586355, 1526.6997966347653, 1931.6126192880686, 1460.5869012291423, 1427.799666760257, 1634.268370848231, 1464.3250544539233, 1573.5401211086817, 1506.0058046493034, 1683.2150422575921, 1552.0254905092206, 1667.7556372531333, 1962.825663262258, 1542.8891943312294, 1428.6950557808564, 2122.8272783730063, 1939.3356604698113, 1881.7131762453967, 1925.6575891778084, 1995.360493955038, 1900.4903429126566, 1445.0848046272395, 1587.2122604634974, 1541.0435950945628, 1769.4788702771605, 1578.7075389710183, 1367.1863455484165, 1288.755063912992, 1636.1631841284577, 1542.6786037061795, 1281.3906833027697, 1298.8800847903624, 1716.6740884618764, 1961.1945179107204, 1250.3918419197664, 1637.7917469659492, 1471.2937030727132, 1693.9253082066466, 1628.2228332159123, 1525.0819674910506, 1460.2331832847935], "episode_lengths": [152, 208, 225, 162, 196, 212, 181, 186, 130, 165, 162, 201, 172, 167, 154, 160, 171, 169, 149, 194, 154, 222, 158, 203, 175, 173, 175, 157, 200, 150, 170, 143, 253, 159, 159, 221, 163, 202, 165, 173, 166, 162, 184, 228, 165, 157, 203, 199, 211, 167, 199, 195, 183, 176, 196, 203, 182, 176, 179, 174, 178, 221, 167, 156, 189, 144, 184, 195, 216, 192, 228, 286, 208, 172, 286, 270, 288, 275, 285, 277, 178, 206, 171, 229, 217, 185, 160, 201, 188, 159, 175, 261, 286, 171, 180, 196, 208, 218, 186, 197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2514864067728421, "mean_inference_ms": 0.9758935045124073, "mean_action_processing_ms": 0.08670168966066044, "mean_env_wait_ms": 0.49387176262629273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 6942.68, "sample_time_ms": 672.298, "load_time_ms": 0.309, "load_throughput": 12964389.151, "learn_time_ms": 6257.039, "learn_throughput": 639.28, "synch_weights_time_ms": 12.429}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 965, "training_iteration": 48, "trial_id": "2db34_00000", "date": "2023-04-30_17-01-40", "timestamp": 1682848900, "time_this_iter_s": 6.946271657943726, "time_total_s": 335.24517154693604, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 335.24517154693604, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 9.6, "ram_util_percent": 67.75555555555555}}
{"custom_metrics": {"dps_mean": 12530.325939171227, "dps_min": 9006.966369292246, "dps_max": 17690.22731977506}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.608591848002966, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.909447846361386, "policy_loss": -0.03379320377704277, "vf_loss": 9.937377054973314, "vf_explained_var": 0.012706782420476277, "kl": 0.013031084325835092, "entropy": 1.0291501500914173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 2122.8272783730063, "episode_reward_min": 1080.83596431507, "episode_reward_mean": 1503.639112700548, "episode_len_mean": 191.92, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12530.325939171227, "dps_min": 9006.966369292246, "dps_max": 17690.22731977506}, "hist_stats": {"episode_reward": [1411.3123043987048, 1523.3342260658571, 1395.2529129696397, 1496.5214024912764, 1385.865035669736, 1416.4658422715595, 1381.441459297317, 1290.7666500777675, 1374.2590222001281, 1197.1686330433138, 1644.3544790141148, 1430.3867013934714, 1272.7728899449878, 1472.4282334919044, 1336.6928957463144, 1420.7524386884338, 1375.6994843404023, 1327.4916981571266, 1436.9442283161582, 1316.1785265139822, 1454.9510588161556, 1490.1580676518556, 1443.4678754099841, 1285.5627514146674, 1467.9671020964383, 1485.4643731564624, 1602.6755081653334, 1492.5422256938036, 1516.1071929793122, 1641.6589634508196, 1318.1113570548193, 1386.5386987851011, 1469.333881142497, 1697.9645759316306, 1550.6038664832704, 1498.1621947074389, 1404.9514170770008, 1431.2787181586355, 1526.6997966347653, 1931.6126192880686, 1460.5869012291423, 1427.799666760257, 1634.268370848231, 1464.3250544539233, 1573.5401211086817, 1506.0058046493034, 1683.2150422575921, 1552.0254905092206, 1667.7556372531333, 1962.825663262258, 1542.8891943312294, 1428.6950557808564, 2122.8272783730063, 1939.3356604698113, 1881.7131762453967, 1925.6575891778084, 1995.360493955038, 1900.4903429126566, 1445.0848046272395, 1587.2122604634974, 1541.0435950945628, 1769.4788702771605, 1578.7075389710183, 1367.1863455484165, 1288.755063912992, 1636.1631841284577, 1542.6786037061795, 1281.3906833027697, 1298.8800847903624, 1716.6740884618764, 1961.1945179107204, 1250.3918419197664, 1637.7917469659492, 1471.2937030727132, 1693.9253082066466, 1628.2228332159123, 1525.0819674910506, 1460.2331832847935, 1580.316181145281, 1665.918128105019, 1327.164386980403, 1371.8459123101095, 1329.8427402686418, 1364.008379284001, 1094.3643898626563, 1547.4534912851987, 1810.7792195409058, 1196.8137033546657, 1125.7672164499784, 1702.1388081266227, 1487.2262932705444, 1547.0547643909026, 1402.432697339912, 1201.013779858872, 1657.7371965121108, 1080.83596431507, 1586.766128152831, 1448.6252350046218, 1202.0599684428198, 1281.1386089337057], "episode_lengths": [158, 203, 175, 173, 175, 157, 200, 150, 170, 143, 253, 159, 159, 221, 163, 202, 165, 173, 166, 162, 184, 228, 165, 157, 203, 199, 211, 167, 199, 195, 183, 176, 196, 203, 182, 176, 179, 174, 178, 221, 167, 156, 189, 144, 184, 195, 216, 192, 228, 286, 208, 172, 286, 270, 288, 275, 285, 277, 178, 206, 171, 229, 217, 185, 160, 201, 188, 159, 175, 261, 286, 171, 180, 196, 208, 218, 186, 197, 219, 201, 184, 161, 176, 143, 139, 210, 219, 146, 142, 236, 176, 188, 168, 138, 196, 152, 220, 196, 127, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2513901006415164, "mean_inference_ms": 0.9762201104296622, "mean_action_processing_ms": 0.08664008403391196, "mean_env_wait_ms": 0.4939074881073918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 2122.8272783730063, "episode_reward_min": 1080.83596431507, "episode_reward_mean": 1503.639112700548, "episode_len_mean": 191.92, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1411.3123043987048, 1523.3342260658571, 1395.2529129696397, 1496.5214024912764, 1385.865035669736, 1416.4658422715595, 1381.441459297317, 1290.7666500777675, 1374.2590222001281, 1197.1686330433138, 1644.3544790141148, 1430.3867013934714, 1272.7728899449878, 1472.4282334919044, 1336.6928957463144, 1420.7524386884338, 1375.6994843404023, 1327.4916981571266, 1436.9442283161582, 1316.1785265139822, 1454.9510588161556, 1490.1580676518556, 1443.4678754099841, 1285.5627514146674, 1467.9671020964383, 1485.4643731564624, 1602.6755081653334, 1492.5422256938036, 1516.1071929793122, 1641.6589634508196, 1318.1113570548193, 1386.5386987851011, 1469.333881142497, 1697.9645759316306, 1550.6038664832704, 1498.1621947074389, 1404.9514170770008, 1431.2787181586355, 1526.6997966347653, 1931.6126192880686, 1460.5869012291423, 1427.799666760257, 1634.268370848231, 1464.3250544539233, 1573.5401211086817, 1506.0058046493034, 1683.2150422575921, 1552.0254905092206, 1667.7556372531333, 1962.825663262258, 1542.8891943312294, 1428.6950557808564, 2122.8272783730063, 1939.3356604698113, 1881.7131762453967, 1925.6575891778084, 1995.360493955038, 1900.4903429126566, 1445.0848046272395, 1587.2122604634974, 1541.0435950945628, 1769.4788702771605, 1578.7075389710183, 1367.1863455484165, 1288.755063912992, 1636.1631841284577, 1542.6786037061795, 1281.3906833027697, 1298.8800847903624, 1716.6740884618764, 1961.1945179107204, 1250.3918419197664, 1637.7917469659492, 1471.2937030727132, 1693.9253082066466, 1628.2228332159123, 1525.0819674910506, 1460.2331832847935, 1580.316181145281, 1665.918128105019, 1327.164386980403, 1371.8459123101095, 1329.8427402686418, 1364.008379284001, 1094.3643898626563, 1547.4534912851987, 1810.7792195409058, 1196.8137033546657, 1125.7672164499784, 1702.1388081266227, 1487.2262932705444, 1547.0547643909026, 1402.432697339912, 1201.013779858872, 1657.7371965121108, 1080.83596431507, 1586.766128152831, 1448.6252350046218, 1202.0599684428198, 1281.1386089337057], "episode_lengths": [158, 203, 175, 173, 175, 157, 200, 150, 170, 143, 253, 159, 159, 221, 163, 202, 165, 173, 166, 162, 184, 228, 165, 157, 203, 199, 211, 167, 199, 195, 183, 176, 196, 203, 182, 176, 179, 174, 178, 221, 167, 156, 189, 144, 184, 195, 216, 192, 228, 286, 208, 172, 286, 270, 288, 275, 285, 277, 178, 206, 171, 229, 217, 185, 160, 201, 188, 159, 175, 261, 286, 171, 180, 196, 208, 218, 186, 197, 219, 201, 184, 161, 176, 143, 139, 210, 219, 146, 142, 236, 176, 188, 168, 138, 196, 152, 220, 196, 127, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2513901006415164, "mean_inference_ms": 0.9762201104296622, "mean_action_processing_ms": 0.08664008403391196, "mean_env_wait_ms": 0.4939074881073918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 6949.088, "sample_time_ms": 681.024, "load_time_ms": 0.409, "load_throughput": 9791196.965, "learn_time_ms": 6254.768, "learn_throughput": 639.512, "synch_weights_time_ms": 12.283}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 987, "training_iteration": 49, "trial_id": "2db34_00000", "date": "2023-04-30_17-01-47", "timestamp": 1682848907, "time_this_iter_s": 7.1333770751953125, "time_total_s": 342.37854862213135, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 342.37854862213135, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 11.22, "ram_util_percent": 68.05}}
{"custom_metrics": {"dps_mean": 12580.554803285006, "dps_min": 8927.469895606255, "dps_max": 17690.22731977506}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.013192459075682, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.83505129250147, "policy_loss": -0.036288037979274344, "vf_loss": 9.864747363264843, "vf_explained_var": 0.018086974787455735, "kl": 0.014648952411276233, "entropy": 1.1403717424600355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 2122.8272783730063, "episode_reward_min": 1071.2963874727507, "episode_reward_mean": 1509.6665763942003, "episode_len_mean": 192.17, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12580.554803285006, "dps_min": 8927.469895606255, "dps_max": 17690.22731977506}, "hist_stats": {"episode_reward": [1443.4678754099841, 1285.5627514146674, 1467.9671020964383, 1485.4643731564624, 1602.6755081653334, 1492.5422256938036, 1516.1071929793122, 1641.6589634508196, 1318.1113570548193, 1386.5386987851011, 1469.333881142497, 1697.9645759316306, 1550.6038664832704, 1498.1621947074389, 1404.9514170770008, 1431.2787181586355, 1526.6997966347653, 1931.6126192880686, 1460.5869012291423, 1427.799666760257, 1634.268370848231, 1464.3250544539233, 1573.5401211086817, 1506.0058046493034, 1683.2150422575921, 1552.0254905092206, 1667.7556372531333, 1962.825663262258, 1542.8891943312294, 1428.6950557808564, 2122.8272783730063, 1939.3356604698113, 1881.7131762453967, 1925.6575891778084, 1995.360493955038, 1900.4903429126566, 1445.0848046272395, 1587.2122604634974, 1541.0435950945628, 1769.4788702771605, 1578.7075389710183, 1367.1863455484165, 1288.755063912992, 1636.1631841284577, 1542.6786037061795, 1281.3906833027697, 1298.8800847903624, 1716.6740884618764, 1961.1945179107204, 1250.3918419197664, 1637.7917469659492, 1471.2937030727132, 1693.9253082066466, 1628.2228332159123, 1525.0819674910506, 1460.2331832847935, 1580.316181145281, 1665.918128105019, 1327.164386980403, 1371.8459123101095, 1329.8427402686418, 1364.008379284001, 1094.3643898626563, 1547.4534912851987, 1810.7792195409058, 1196.8137033546657, 1125.7672164499784, 1702.1388081266227, 1487.2262932705444, 1547.0547643909026, 1402.432697339912, 1201.013779858872, 1657.7371965121108, 1080.83596431507, 1586.766128152831, 1448.6252350046218, 1202.0599684428198, 1281.1386089337057, 1071.2963874727507, 1643.6051416713985, 1174.8674521926155, 1714.8477963757127, 1193.4567900744119, 1590.81891219483, 1388.3455606221232, 1299.4596417253333, 1615.7743168830166, 1340.103670913082, 1329.3115684434674, 1302.570617817744, 1377.9536741927898, 1581.155684011054, 1244.564260346824, 1695.75921061692, 1292.6338752295103, 1610.1781014901865, 1336.7326775667977, 1624.8997646172802, 1595.603143535248, 1430.006311932393], "episode_lengths": [165, 157, 203, 199, 211, 167, 199, 195, 183, 176, 196, 203, 182, 176, 179, 174, 178, 221, 167, 156, 189, 144, 184, 195, 216, 192, 228, 286, 208, 172, 286, 270, 288, 275, 285, 277, 178, 206, 171, 229, 217, 185, 160, 201, 188, 159, 175, 261, 286, 171, 180, 196, 208, 218, 186, 197, 219, 201, 184, 161, 176, 143, 139, 210, 219, 146, 142, 236, 176, 188, 168, 138, 196, 152, 220, 196, 127, 162, 130, 199, 135, 236, 155, 209, 174, 154, 224, 152, 144, 146, 165, 203, 162, 231, 156, 229, 162, 200, 206, 192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2512910430776124, "mean_inference_ms": 0.9763783201016966, "mean_action_processing_ms": 0.0866927470843964, "mean_env_wait_ms": 0.4941460367263178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 2122.8272783730063, "episode_reward_min": 1071.2963874727507, "episode_reward_mean": 1509.6665763942003, "episode_len_mean": 192.17, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1443.4678754099841, 1285.5627514146674, 1467.9671020964383, 1485.4643731564624, 1602.6755081653334, 1492.5422256938036, 1516.1071929793122, 1641.6589634508196, 1318.1113570548193, 1386.5386987851011, 1469.333881142497, 1697.9645759316306, 1550.6038664832704, 1498.1621947074389, 1404.9514170770008, 1431.2787181586355, 1526.6997966347653, 1931.6126192880686, 1460.5869012291423, 1427.799666760257, 1634.268370848231, 1464.3250544539233, 1573.5401211086817, 1506.0058046493034, 1683.2150422575921, 1552.0254905092206, 1667.7556372531333, 1962.825663262258, 1542.8891943312294, 1428.6950557808564, 2122.8272783730063, 1939.3356604698113, 1881.7131762453967, 1925.6575891778084, 1995.360493955038, 1900.4903429126566, 1445.0848046272395, 1587.2122604634974, 1541.0435950945628, 1769.4788702771605, 1578.7075389710183, 1367.1863455484165, 1288.755063912992, 1636.1631841284577, 1542.6786037061795, 1281.3906833027697, 1298.8800847903624, 1716.6740884618764, 1961.1945179107204, 1250.3918419197664, 1637.7917469659492, 1471.2937030727132, 1693.9253082066466, 1628.2228332159123, 1525.0819674910506, 1460.2331832847935, 1580.316181145281, 1665.918128105019, 1327.164386980403, 1371.8459123101095, 1329.8427402686418, 1364.008379284001, 1094.3643898626563, 1547.4534912851987, 1810.7792195409058, 1196.8137033546657, 1125.7672164499784, 1702.1388081266227, 1487.2262932705444, 1547.0547643909026, 1402.432697339912, 1201.013779858872, 1657.7371965121108, 1080.83596431507, 1586.766128152831, 1448.6252350046218, 1202.0599684428198, 1281.1386089337057, 1071.2963874727507, 1643.6051416713985, 1174.8674521926155, 1714.8477963757127, 1193.4567900744119, 1590.81891219483, 1388.3455606221232, 1299.4596417253333, 1615.7743168830166, 1340.103670913082, 1329.3115684434674, 1302.570617817744, 1377.9536741927898, 1581.155684011054, 1244.564260346824, 1695.75921061692, 1292.6338752295103, 1610.1781014901865, 1336.7326775667977, 1624.8997646172802, 1595.603143535248, 1430.006311932393], "episode_lengths": [165, 157, 203, 199, 211, 167, 199, 195, 183, 176, 196, 203, 182, 176, 179, 174, 178, 221, 167, 156, 189, 144, 184, 195, 216, 192, 228, 286, 208, 172, 286, 270, 288, 275, 285, 277, 178, 206, 171, 229, 217, 185, 160, 201, 188, 159, 175, 261, 286, 171, 180, 196, 208, 218, 186, 197, 219, 201, 184, 161, 176, 143, 139, 210, 219, 146, 142, 236, 176, 188, 168, 138, 196, 152, 220, 196, 127, 162, 130, 199, 135, 236, 155, 209, 174, 154, 224, 152, 144, 146, 165, 203, 162, 231, 156, 229, 162, 200, 206, 192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2512910430776124, "mean_inference_ms": 0.9763783201016966, "mean_action_processing_ms": 0.0866927470843964, "mean_env_wait_ms": 0.4941460367263178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 6956.934, "sample_time_ms": 685.036, "load_time_ms": 0.354, "load_throughput": 11285628.952, "learn_time_ms": 6258.576, "learn_throughput": 639.123, "synch_weights_time_ms": 12.363}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "episodes_total": 1009, "training_iteration": 50, "trial_id": "2db34_00000", "date": "2023-04-30_17-01-54", "timestamp": 1682848914, "time_this_iter_s": 6.866044282913208, "time_total_s": 349.24459290504456, "pid": 21076, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002247E5B5CA0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 349.24459290504456, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 8.55, "ram_util_percent": 68.08000000000001}}
