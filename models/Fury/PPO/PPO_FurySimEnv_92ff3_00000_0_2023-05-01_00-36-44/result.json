{"custom_metrics": {"dps_mean": 9795.134445266092, "dps_min": 8588.51696599721, "dps_max": 10728.801967241714}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.846175364877588, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.963775827551402, "policy_loss": -0.01101075409190549, "vf_loss": 9.971478934954572, "vf_explained_var": 0.0016697923342386882, "kl": 0.016538167033909923, "entropy": 2.381449216924688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -941.7449594973275, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -1654.717951456352, "episode_len_mean": 291.54545454545456, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 9795.134445266092, "dps_min": 8588.51696599721, "dps_max": 10728.801967241714}, "hist_stats": {"episode_reward": [-1635.7155473063194, -1587.1853373459473, -1300.195725100827, -1804.0942808710201, -2126.573364238164, -1942.2652893162508, -1352.27922329159, -941.7449594973275, -1276.347789891507, -1995.621737806536, -2239.8742113543844], "episode_lengths": [295, 281, 265, 307, 338, 291, 252, 243, 257, 320, 358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23680162833084875, "mean_inference_ms": 0.980339889405776, "mean_action_processing_ms": 0.08878601454994164, "mean_env_wait_ms": 0.17619583858049231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": -941.7449594973275, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -1654.717951456352, "episode_len_mean": 291.54545454545456, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1635.7155473063194, -1587.1853373459473, -1300.195725100827, -1804.0942808710201, -2126.573364238164, -1942.2652893162508, -1352.27922329159, -941.7449594973275, -1276.347789891507, -1995.621737806536, -2239.8742113543844], "episode_lengths": [295, 281, 265, 307, 338, 291, 252, 243, 257, 320, 358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23680162833084875, "mean_inference_ms": 0.980339889405776, "mean_action_processing_ms": 0.08878601454994164, "mean_env_wait_ms": 0.17619583858049231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 7154.886, "sample_time_ms": 628.384, "load_time_ms": 0.999, "load_throughput": 4005064.693, "learn_time_ms": 6508.707, "learn_throughput": 614.561, "synch_weights_time_ms": 15.797}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 11, "training_iteration": 1, "trial_id": "92ff3_00000", "date": "2023-05-01_00-37-03", "timestamp": 1682876223, "time_this_iter_s": 7.159884691238403, "time_total_s": 7.159884691238403, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 7.159884691238403, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 8.263636363636364, "ram_util_percent": 58.3090909090909}}
{"custom_metrics": {"dps_mean": 9896.8592230597, "dps_min": 8588.51696599721, "dps_max": 11470.066744976506}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8531280896996939, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.961444633237777, "policy_loss": -0.019107508859647217, "vf_loss": 9.976678972346809, "vf_explained_var": 0.006797441359489195, "kl": 0.019365971992457317, "entropy": 2.350939823222417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -941.7449594973275, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -1588.2218779186303, "episode_len_mean": 288.95454545454544, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 9896.8592230597, "dps_min": 8588.51696599721, "dps_max": 11470.066744976506}, "hist_stats": {"episode_reward": [-1635.7155473063194, -1587.1853373459473, -1300.195725100827, -1804.0942808710201, -2126.573364238164, -1942.2652893162508, -1352.27922329159, -941.7449594973275, -1276.347789891507, -1995.621737806536, -2239.8742113543844, -1402.5538516050258, -1659.6864855477181, -1793.5667442612714, -1485.1549737499759, -1563.4887472918795, -1274.210524041853, -1577.409207394943, -1855.1038812421853, -1270.4758234666012, -1569.7251248484847, -1287.6084847400598], "episode_lengths": [295, 281, 265, 307, 338, 291, 252, 243, 257, 320, 358, 277, 295, 309, 285, 282, 260, 290, 325, 252, 311, 264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23694806064351281, "mean_inference_ms": 0.9720990510223232, "mean_action_processing_ms": 0.08745667123416015, "mean_env_wait_ms": 0.1711370552472181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": -941.7449594973275, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -1588.2218779186303, "episode_len_mean": 288.95454545454544, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1635.7155473063194, -1587.1853373459473, -1300.195725100827, -1804.0942808710201, -2126.573364238164, -1942.2652893162508, -1352.27922329159, -941.7449594973275, -1276.347789891507, -1995.621737806536, -2239.8742113543844, -1402.5538516050258, -1659.6864855477181, -1793.5667442612714, -1485.1549737499759, -1563.4887472918795, -1274.210524041853, -1577.409207394943, -1855.1038812421853, -1270.4758234666012, -1569.7251248484847, -1287.6084847400598], "episode_lengths": [295, 281, 265, 307, 338, 291, 252, 243, 257, 320, 358, 277, 295, 309, 285, 282, 260, 290, 325, 252, 311, 264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23694806064351281, "mean_inference_ms": 0.9720990510223232, "mean_action_processing_ms": 0.08745667123416015, "mean_env_wait_ms": 0.1711370552472181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 7037.502, "sample_time_ms": 609.108, "load_time_ms": 1.002, "load_throughput": 3992673.965, "learn_time_ms": 6413.238, "learn_throughput": 623.71, "synch_weights_time_ms": 12.902}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 22, "training_iteration": 2, "trial_id": "92ff3_00000", "date": "2023-05-01_00-37-10", "timestamp": 1682876230, "time_this_iter_s": 6.92619252204895, "time_total_s": 14.086077213287354, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 14.086077213287354, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 57.5}}
{"custom_metrics": {"dps_mean": 9698.697078277983, "dps_min": 8175.307611500161, "dps_max": 11470.066744976506}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9288752648458686, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.922425337760679, "policy_loss": -0.013860723928558409, "vf_loss": 9.932612526801325, "vf_explained_var": 0.0029228273258414318, "kl": 0.018367691912824818, "entropy": 2.3062778975373956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -701.3276736997647, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -1412.381232509507, "episode_len_mean": 276.8918918918919, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 9698.697078277983, "dps_min": 8175.307611500161, "dps_max": 11470.066744976506}, "hist_stats": {"episode_reward": [-1635.7155473063194, -1587.1853373459473, -1300.195725100827, -1804.0942808710201, -2126.573364238164, -1942.2652893162508, -1352.27922329159, -941.7449594973275, -1276.347789891507, -1995.621737806536, -2239.8742113543844, -1402.5538516050258, -1659.6864855477181, -1793.5667442612714, -1485.1549737499759, -1563.4887472918795, -1274.210524041853, -1577.409207394943, -1855.1038812421853, -1270.4758234666012, -1569.7251248484847, -1287.6084847400598, -1242.8543037322336, -1200.1907138292722, -998.4854987219708, -1167.8764927632462, -1137.021968677464, -1150.5644236477492, -1451.177097260348, -1168.3284291760579, -1403.80243124295, -1043.559381495615, -701.3276736997647, -1608.2553776977188, -956.2838902235003, -1131.2533145640925, -956.2432919099049], "episode_lengths": [295, 281, 265, 307, 338, 291, 252, 243, 257, 320, 358, 277, 295, 309, 285, 282, 260, 290, 325, 252, 311, 264, 268, 279, 252, 236, 257, 258, 261, 258, 289, 258, 221, 291, 256, 270, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2371721001852804, "mean_inference_ms": 0.9784365373819294, "mean_action_processing_ms": 0.08650454425032623, "mean_env_wait_ms": 0.1717912432143849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": -701.3276736997647, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -1412.381232509507, "episode_len_mean": 276.8918918918919, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1635.7155473063194, -1587.1853373459473, -1300.195725100827, -1804.0942808710201, -2126.573364238164, -1942.2652893162508, -1352.27922329159, -941.7449594973275, -1276.347789891507, -1995.621737806536, -2239.8742113543844, -1402.5538516050258, -1659.6864855477181, -1793.5667442612714, -1485.1549737499759, -1563.4887472918795, -1274.210524041853, -1577.409207394943, -1855.1038812421853, -1270.4758234666012, -1569.7251248484847, -1287.6084847400598, -1242.8543037322336, -1200.1907138292722, -998.4854987219708, -1167.8764927632462, -1137.021968677464, -1150.5644236477492, -1451.177097260348, -1168.3284291760579, -1403.80243124295, -1043.559381495615, -701.3276736997647, -1608.2553776977188, -956.2838902235003, -1131.2533145640925, -956.2432919099049], "episode_lengths": [295, 281, 265, 307, 338, 291, 252, 243, 257, 320, 358, 277, 295, 309, 285, 282, 260, 290, 325, 252, 311, 264, 268, 279, 252, 236, 257, 258, 261, 258, 289, 258, 221, 291, 256, 270, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2371721001852804, "mean_inference_ms": 0.9784365373819294, "mean_action_processing_ms": 0.08650454425032623, "mean_env_wait_ms": 0.1717912432143849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 7000.539, "sample_time_ms": 630.965, "load_time_ms": 1.001, "load_throughput": 3996478.323, "learn_time_ms": 6354.833, "learn_throughput": 629.442, "synch_weights_time_ms": 12.24}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 37, "training_iteration": 3, "trial_id": "92ff3_00000", "date": "2023-05-01_00-37-17", "timestamp": 1682876237, "time_this_iter_s": 6.932619333267212, "time_total_s": 21.018696546554565, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 21.018696546554565, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 6.5699999999999985, "ram_util_percent": 57.510000000000005}}
{"custom_metrics": {"dps_mean": 9967.352189660322, "dps_min": 8175.307611500161, "dps_max": 12201.163379812868}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9526010243162032, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.931783897646012, "policy_loss": -0.01648467013672475, "vf_loss": 9.944716541741483, "vf_explained_var": 0.0009513528757197883, "kl": 0.01776001767333373, "entropy": 2.25461786331669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -701.3276736997647, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -1302.0702003879426, "episode_len_mean": 275.85185185185185, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 9967.352189660322, "dps_min": 8175.307611500161, "dps_max": 12201.163379812868}, "hist_stats": {"episode_reward": [-1635.7155473063194, -1587.1853373459473, -1300.195725100827, -1804.0942808710201, -2126.573364238164, -1942.2652893162508, -1352.27922329159, -941.7449594973275, -1276.347789891507, -1995.621737806536, -2239.8742113543844, -1402.5538516050258, -1659.6864855477181, -1793.5667442612714, -1485.1549737499759, -1563.4887472918795, -1274.210524041853, -1577.409207394943, -1855.1038812421853, -1270.4758234666012, -1569.7251248484847, -1287.6084847400598, -1242.8543037322336, -1200.1907138292722, -998.4854987219708, -1167.8764927632462, -1137.021968677464, -1150.5644236477492, -1451.177097260348, -1168.3284291760579, -1403.80243124295, -1043.559381495615, -701.3276736997647, -1608.2553776977188, -956.2838902235003, -1131.2533145640925, -956.2432919099049, -1054.9673333636858, -915.6649524595692, -833.2757063828085, -1309.4045515305127, -802.2521172311132, -1430.9932293005747, -1123.5463049624814, -1107.380688372665, -1073.4597490714445, -1459.8578397038643, -797.9149234249606, -1015.4832567587839, -718.5636500587478, -1102.6444528056095, -973.9147247699801, -1159.5243660007316, -1174.837371899611], "episode_lengths": [295, 281, 265, 307, 338, 291, 252, 243, 257, 320, 358, 277, 295, 309, 285, 282, 260, 290, 325, 252, 311, 264, 268, 279, 252, 236, 257, 258, 261, 258, 289, 258, 221, 291, 256, 270, 234, 264, 260, 250, 322, 259, 284, 302, 296, 282, 302, 262, 269, 236, 292, 241, 254, 276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23752213542072673, "mean_inference_ms": 0.9767434136372506, "mean_action_processing_ms": 0.08542898441117298, "mean_env_wait_ms": 0.17082754037260356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": -701.3276736997647, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -1302.0702003879426, "episode_len_mean": 275.85185185185185, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1635.7155473063194, -1587.1853373459473, -1300.195725100827, -1804.0942808710201, -2126.573364238164, -1942.2652893162508, -1352.27922329159, -941.7449594973275, -1276.347789891507, -1995.621737806536, -2239.8742113543844, -1402.5538516050258, -1659.6864855477181, -1793.5667442612714, -1485.1549737499759, -1563.4887472918795, -1274.210524041853, -1577.409207394943, -1855.1038812421853, -1270.4758234666012, -1569.7251248484847, -1287.6084847400598, -1242.8543037322336, -1200.1907138292722, -998.4854987219708, -1167.8764927632462, -1137.021968677464, -1150.5644236477492, -1451.177097260348, -1168.3284291760579, -1403.80243124295, -1043.559381495615, -701.3276736997647, -1608.2553776977188, -956.2838902235003, -1131.2533145640925, -956.2432919099049, -1054.9673333636858, -915.6649524595692, -833.2757063828085, -1309.4045515305127, -802.2521172311132, -1430.9932293005747, -1123.5463049624814, -1107.380688372665, -1073.4597490714445, -1459.8578397038643, -797.9149234249606, -1015.4832567587839, -718.5636500587478, -1102.6444528056095, -973.9147247699801, -1159.5243660007316, -1174.837371899611], "episode_lengths": [295, 281, 265, 307, 338, 291, 252, 243, 257, 320, 358, 277, 295, 309, 285, 282, 260, 290, 325, 252, 311, 264, 268, 279, 252, 236, 257, 258, 261, 258, 289, 258, 221, 291, 256, 270, 234, 264, 260, 250, 322, 259, 284, 302, 296, 282, 302, 262, 269, 236, 292, 241, 254, 276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23752213542072673, "mean_inference_ms": 0.9767434136372506, "mean_action_processing_ms": 0.08542898441117298, "mean_env_wait_ms": 0.17082754037260356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 7015.958, "sample_time_ms": 625.26, "load_time_ms": 1.251, "load_throughput": 3198554.12, "learn_time_ms": 6376.387, "learn_throughput": 627.314, "synch_weights_time_ms": 11.81}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 54, "training_iteration": 4, "trial_id": "92ff3_00000", "date": "2023-05-01_00-37-24", "timestamp": 1682876244, "time_this_iter_s": 7.06722092628479, "time_total_s": 28.085917472839355, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 28.085917472839355, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 6.07, "ram_util_percent": 57.620000000000005}}
{"custom_metrics": {"dps_mean": 10031.238408324347, "dps_min": 8175.307611500161, "dps_max": 12435.435613630458}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.079776031163431, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.84930289586385, "policy_loss": -0.03133297099791948, "vf_loss": 9.875651933813607, "vf_explained_var": -0.004512829549850956, "kl": 0.02491965828337269, "entropy": 2.1617022140051727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -284.1147935970073, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -1176.36416607979, "episode_len_mean": 269.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10031.238408324347, "dps_min": 8175.307611500161, "dps_max": 12435.435613630458}, "hist_stats": {"episode_reward": [-1635.7155473063194, -1587.1853373459473, -1300.195725100827, -1804.0942808710201, -2126.573364238164, -1942.2652893162508, -1352.27922329159, -941.7449594973275, -1276.347789891507, -1995.621737806536, -2239.8742113543844, -1402.5538516050258, -1659.6864855477181, -1793.5667442612714, -1485.1549737499759, -1563.4887472918795, -1274.210524041853, -1577.409207394943, -1855.1038812421853, -1270.4758234666012, -1569.7251248484847, -1287.6084847400598, -1242.8543037322336, -1200.1907138292722, -998.4854987219708, -1167.8764927632462, -1137.021968677464, -1150.5644236477492, -1451.177097260348, -1168.3284291760579, -1403.80243124295, -1043.559381495615, -701.3276736997647, -1608.2553776977188, -956.2838902235003, -1131.2533145640925, -956.2432919099049, -1054.9673333636858, -915.6649524595692, -833.2757063828085, -1309.4045515305127, -802.2521172311132, -1430.9932293005747, -1123.5463049624814, -1107.380688372665, -1073.4597490714445, -1459.8578397038643, -797.9149234249606, -1015.4832567587839, -718.5636500587478, -1102.6444528056095, -973.9147247699801, -1159.5243660007316, -1174.837371899611, -1029.3903739160842, -432.6709704508833, -834.8064690760227, -575.4972927219264, -440.10414750076177, -667.2165131796548, -1119.105622278377, -284.1147935970073, -709.0391388549752, -357.7390342944007, -754.8975959234613, -1578.4316211339294, -299.99420078053083, -597.964698768798], "episode_lengths": [295, 281, 265, 307, 338, 291, 252, 243, 257, 320, 358, 277, 295, 309, 285, 282, 260, 290, 325, 252, 311, 264, 268, 279, 252, 236, 257, 258, 261, 258, 289, 258, 221, 291, 256, 270, 234, 264, 260, 250, 322, 259, 284, 302, 296, 282, 302, 262, 269, 236, 292, 241, 254, 276, 270, 201, 272, 239, 217, 221, 255, 194, 229, 217, 258, 351, 222, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23799218559475518, "mean_inference_ms": 0.977848791017784, "mean_action_processing_ms": 0.08513274223837532, "mean_env_wait_ms": 0.17134524811812055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": -284.1147935970073, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -1176.36416607979, "episode_len_mean": 269.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1635.7155473063194, -1587.1853373459473, -1300.195725100827, -1804.0942808710201, -2126.573364238164, -1942.2652893162508, -1352.27922329159, -941.7449594973275, -1276.347789891507, -1995.621737806536, -2239.8742113543844, -1402.5538516050258, -1659.6864855477181, -1793.5667442612714, -1485.1549737499759, -1563.4887472918795, -1274.210524041853, -1577.409207394943, -1855.1038812421853, -1270.4758234666012, -1569.7251248484847, -1287.6084847400598, -1242.8543037322336, -1200.1907138292722, -998.4854987219708, -1167.8764927632462, -1137.021968677464, -1150.5644236477492, -1451.177097260348, -1168.3284291760579, -1403.80243124295, -1043.559381495615, -701.3276736997647, -1608.2553776977188, -956.2838902235003, -1131.2533145640925, -956.2432919099049, -1054.9673333636858, -915.6649524595692, -833.2757063828085, -1309.4045515305127, -802.2521172311132, -1430.9932293005747, -1123.5463049624814, -1107.380688372665, -1073.4597490714445, -1459.8578397038643, -797.9149234249606, -1015.4832567587839, -718.5636500587478, -1102.6444528056095, -973.9147247699801, -1159.5243660007316, -1174.837371899611, -1029.3903739160842, -432.6709704508833, -834.8064690760227, -575.4972927219264, -440.10414750076177, -667.2165131796548, -1119.105622278377, -284.1147935970073, -709.0391388549752, -357.7390342944007, -754.8975959234613, -1578.4316211339294, -299.99420078053083, -597.964698768798], "episode_lengths": [295, 281, 265, 307, 338, 291, 252, 243, 257, 320, 358, 277, 295, 309, 285, 282, 260, 290, 325, 252, 311, 264, 268, 279, 252, 236, 257, 258, 261, 258, 289, 258, 221, 291, 256, 270, 234, 264, 260, 250, 322, 259, 284, 302, 296, 282, 302, 262, 269, 236, 292, 241, 254, 276, 270, 201, 272, 239, 217, 221, 255, 194, 229, 217, 258, 351, 222, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23799218559475518, "mean_inference_ms": 0.977848791017784, "mean_action_processing_ms": 0.08513274223837532, "mean_env_wait_ms": 0.17134524811812055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 6999.896, "sample_time_ms": 621.052, "load_time_ms": 1.4, "load_throughput": 2856766.108, "learn_time_ms": 6364.676, "learn_throughput": 628.469, "synch_weights_time_ms": 11.768}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 68, "training_iteration": 5, "trial_id": "92ff3_00000", "date": "2023-05-01_00-37-31", "timestamp": 1682876251, "time_this_iter_s": 6.942163944244385, "time_total_s": 35.02808141708374, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 35.02808141708374, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 5.83, "ram_util_percent": 57.779999999999994}}
{"custom_metrics": {"dps_mean": 10123.119165706838, "dps_min": 7847.8097684988015, "dps_max": 12435.435613630458}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2829460156861172, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.683504332265546, "policy_loss": -0.034043829168082886, "vf_loss": 9.70999523183351, "vf_explained_var": -0.003630666963515743, "kl": 0.02517645770296042, "entropy": 2.0444124978075746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 4.530787411356515, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -994.5510016287225, "episode_len_mean": 259.438202247191, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10123.119165706838, "dps_min": 7847.8097684988015, "dps_max": 12435.435613630458}, "hist_stats": {"episode_reward": [-1635.7155473063194, -1587.1853373459473, -1300.195725100827, -1804.0942808710201, -2126.573364238164, -1942.2652893162508, -1352.27922329159, -941.7449594973275, -1276.347789891507, -1995.621737806536, -2239.8742113543844, -1402.5538516050258, -1659.6864855477181, -1793.5667442612714, -1485.1549737499759, -1563.4887472918795, -1274.210524041853, -1577.409207394943, -1855.1038812421853, -1270.4758234666012, -1569.7251248484847, -1287.6084847400598, -1242.8543037322336, -1200.1907138292722, -998.4854987219708, -1167.8764927632462, -1137.021968677464, -1150.5644236477492, -1451.177097260348, -1168.3284291760579, -1403.80243124295, -1043.559381495615, -701.3276736997647, -1608.2553776977188, -956.2838902235003, -1131.2533145640925, -956.2432919099049, -1054.9673333636858, -915.6649524595692, -833.2757063828085, -1309.4045515305127, -802.2521172311132, -1430.9932293005747, -1123.5463049624814, -1107.380688372665, -1073.4597490714445, -1459.8578397038643, -797.9149234249606, -1015.4832567587839, -718.5636500587478, -1102.6444528056095, -973.9147247699801, -1159.5243660007316, -1174.837371899611, -1029.3903739160842, -432.6709704508833, -834.8064690760227, -575.4972927219264, -440.10414750076177, -667.2165131796548, -1119.105622278377, -284.1147935970073, -709.0391388549752, -357.7390342944007, -754.8975959234613, -1578.4316211339294, -299.99420078053083, -597.964698768798, -545.8665803648283, -229.36108110128797, -748.7394961882303, -83.898199701217, -817.7833538707937, -127.14898732520264, -335.510422022976, -186.3352941715576, -602.7671490073348, -313.4637878539732, -437.4738900134838, -861.9749583621895, -340.2031121137878, -273.111839342221, 4.530787411356515, -473.6769288980959, -898.2636076826285, -74.09650032231247, -198.3083258582599, -612.6652305803216, -366.15789416123783], "episode_lengths": [295, 281, 265, 307, 338, 291, 252, 243, 257, 320, 358, 277, 295, 309, 285, 282, 260, 290, 325, 252, 311, 264, 268, 279, 252, 236, 257, 258, 261, 258, 289, 258, 221, 291, 256, 270, 234, 264, 260, 250, 322, 259, 284, 302, 296, 282, 302, 262, 269, 236, 292, 241, 254, 276, 270, 201, 272, 239, 217, 221, 255, 194, 229, 217, 258, 351, 222, 250, 251, 205, 257, 213, 241, 220, 214, 227, 227, 208, 236, 270, 252, 246, 192, 225, 300, 155, 227, 227, 205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23840896931782232, "mean_inference_ms": 0.9776510973130559, "mean_action_processing_ms": 0.08505697344120433, "mean_env_wait_ms": 0.17127378008335564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 4.530787411356515, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -994.5510016287225, "episode_len_mean": 259.438202247191, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1635.7155473063194, -1587.1853373459473, -1300.195725100827, -1804.0942808710201, -2126.573364238164, -1942.2652893162508, -1352.27922329159, -941.7449594973275, -1276.347789891507, -1995.621737806536, -2239.8742113543844, -1402.5538516050258, -1659.6864855477181, -1793.5667442612714, -1485.1549737499759, -1563.4887472918795, -1274.210524041853, -1577.409207394943, -1855.1038812421853, -1270.4758234666012, -1569.7251248484847, -1287.6084847400598, -1242.8543037322336, -1200.1907138292722, -998.4854987219708, -1167.8764927632462, -1137.021968677464, -1150.5644236477492, -1451.177097260348, -1168.3284291760579, -1403.80243124295, -1043.559381495615, -701.3276736997647, -1608.2553776977188, -956.2838902235003, -1131.2533145640925, -956.2432919099049, -1054.9673333636858, -915.6649524595692, -833.2757063828085, -1309.4045515305127, -802.2521172311132, -1430.9932293005747, -1123.5463049624814, -1107.380688372665, -1073.4597490714445, -1459.8578397038643, -797.9149234249606, -1015.4832567587839, -718.5636500587478, -1102.6444528056095, -973.9147247699801, -1159.5243660007316, -1174.837371899611, -1029.3903739160842, -432.6709704508833, -834.8064690760227, -575.4972927219264, -440.10414750076177, -667.2165131796548, -1119.105622278377, -284.1147935970073, -709.0391388549752, -357.7390342944007, -754.8975959234613, -1578.4316211339294, -299.99420078053083, -597.964698768798, -545.8665803648283, -229.36108110128797, -748.7394961882303, -83.898199701217, -817.7833538707937, -127.14898732520264, -335.510422022976, -186.3352941715576, -602.7671490073348, -313.4637878539732, -437.4738900134838, -861.9749583621895, -340.2031121137878, -273.111839342221, 4.530787411356515, -473.6769288980959, -898.2636076826285, -74.09650032231247, -198.3083258582599, -612.6652305803216, -366.15789416123783], "episode_lengths": [295, 281, 265, 307, 338, 291, 252, 243, 257, 320, 358, 277, 295, 309, 285, 282, 260, 290, 325, 252, 311, 264, 268, 279, 252, 236, 257, 258, 261, 258, 289, 258, 221, 291, 256, 270, 234, 264, 260, 250, 322, 259, 284, 302, 296, 282, 302, 262, 269, 236, 292, 241, 254, 276, 270, 201, 272, 239, 217, 221, 255, 194, 229, 217, 258, 351, 222, 250, 251, 205, 257, 213, 241, 220, 214, 227, 227, 208, 236, 270, 252, 246, 192, 225, 300, 155, 227, 227, 205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23840896931782232, "mean_inference_ms": 0.9776510973130559, "mean_action_processing_ms": 0.08505697344120433, "mean_env_wait_ms": 0.17127378008335564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 6984.903, "sample_time_ms": 619.176, "load_time_ms": 1.334, "load_throughput": 2999412.89, "learn_time_ms": 6351.623, "learn_throughput": 629.76, "synch_weights_time_ms": 11.602}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 89, "training_iteration": 6, "trial_id": "92ff3_00000", "date": "2023-05-01_00-37-38", "timestamp": 1682876258, "time_this_iter_s": 6.915935516357422, "time_total_s": 41.94401693344116, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 41.94401693344116, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 6.255555555555556, "ram_util_percent": 57.79999999999999}}
{"custom_metrics": {"dps_mean": 10186.540365145851, "dps_min": 7847.8097684988015, "dps_max": 13426.443304662367}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.365382218809538, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.721295236772107, "policy_loss": -0.03308361577651193, "vf_loss": 9.74677476472752, "vf_explained_var": -0.003463555407780473, "kl": 0.0168979295080284, "entropy": 1.9421828601949958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 268.02343343259696, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -751.2624028757577, "episode_len_mean": 245.07, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10186.540365145851, "dps_min": 7847.8097684988015, "dps_max": 13426.443304662367}, "hist_stats": {"episode_reward": [-1276.347789891507, -1995.621737806536, -2239.8742113543844, -1402.5538516050258, -1659.6864855477181, -1793.5667442612714, -1485.1549737499759, -1563.4887472918795, -1274.210524041853, -1577.409207394943, -1855.1038812421853, -1270.4758234666012, -1569.7251248484847, -1287.6084847400598, -1242.8543037322336, -1200.1907138292722, -998.4854987219708, -1167.8764927632462, -1137.021968677464, -1150.5644236477492, -1451.177097260348, -1168.3284291760579, -1403.80243124295, -1043.559381495615, -701.3276736997647, -1608.2553776977188, -956.2838902235003, -1131.2533145640925, -956.2432919099049, -1054.9673333636858, -915.6649524595692, -833.2757063828085, -1309.4045515305127, -802.2521172311132, -1430.9932293005747, -1123.5463049624814, -1107.380688372665, -1073.4597490714445, -1459.8578397038643, -797.9149234249606, -1015.4832567587839, -718.5636500587478, -1102.6444528056095, -973.9147247699801, -1159.5243660007316, -1174.837371899611, -1029.3903739160842, -432.6709704508833, -834.8064690760227, -575.4972927219264, -440.10414750076177, -667.2165131796548, -1119.105622278377, -284.1147935970073, -709.0391388549752, -357.7390342944007, -754.8975959234613, -1578.4316211339294, -299.99420078053083, -597.964698768798, -545.8665803648283, -229.36108110128797, -748.7394961882303, -83.898199701217, -817.7833538707937, -127.14898732520264, -335.510422022976, -186.3352941715576, -602.7671490073348, -313.4637878539732, -437.4738900134838, -861.9749583621895, -340.2031121137878, -273.111839342221, 4.530787411356515, -473.6769288980959, -898.2636076826285, -74.09650032231247, -198.3083258582599, -612.6652305803216, -366.15789416123783, 2.7519626654606935, 172.56595848005944, 268.02343343259696, 130.2172502604695, -12.188142187489621, 114.45272471165124, -41.382429466728446, -132.07060614545983, 21.99845940209309, 80.51768240950616, 62.308304039948624, -223.43838586432196, -298.3967315135619, 5.2563576493596464, 186.40853449708067, 224.9334442125378, -220.28320812886494, 135.31408715781672, 221.7564348009261], "episode_lengths": [257, 320, 358, 277, 295, 309, 285, 282, 260, 290, 325, 252, 311, 264, 268, 279, 252, 236, 257, 258, 261, 258, 289, 258, 221, 291, 256, 270, 234, 264, 260, 250, 322, 259, 284, 302, 296, 282, 302, 262, 269, 236, 292, 241, 254, 276, 270, 201, 272, 239, 217, 221, 255, 194, 229, 217, 258, 351, 222, 250, 251, 205, 257, 213, 241, 220, 214, 227, 227, 208, 236, 270, 252, 246, 192, 225, 300, 155, 227, 227, 205, 165, 176, 182, 222, 190, 162, 197, 201, 164, 170, 212, 196, 213, 210, 158, 213, 268, 184, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23823964825377175, "mean_inference_ms": 0.9767832520300899, "mean_action_processing_ms": 0.08465257985385419, "mean_env_wait_ms": 0.17128117661786044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 268.02343343259696, "episode_reward_min": -2239.8742113543844, "episode_reward_mean": -751.2624028757577, "episode_len_mean": 245.07, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1276.347789891507, -1995.621737806536, -2239.8742113543844, -1402.5538516050258, -1659.6864855477181, -1793.5667442612714, -1485.1549737499759, -1563.4887472918795, -1274.210524041853, -1577.409207394943, -1855.1038812421853, -1270.4758234666012, -1569.7251248484847, -1287.6084847400598, -1242.8543037322336, -1200.1907138292722, -998.4854987219708, -1167.8764927632462, -1137.021968677464, -1150.5644236477492, -1451.177097260348, -1168.3284291760579, -1403.80243124295, -1043.559381495615, -701.3276736997647, -1608.2553776977188, -956.2838902235003, -1131.2533145640925, -956.2432919099049, -1054.9673333636858, -915.6649524595692, -833.2757063828085, -1309.4045515305127, -802.2521172311132, -1430.9932293005747, -1123.5463049624814, -1107.380688372665, -1073.4597490714445, -1459.8578397038643, -797.9149234249606, -1015.4832567587839, -718.5636500587478, -1102.6444528056095, -973.9147247699801, -1159.5243660007316, -1174.837371899611, -1029.3903739160842, -432.6709704508833, -834.8064690760227, -575.4972927219264, -440.10414750076177, -667.2165131796548, -1119.105622278377, -284.1147935970073, -709.0391388549752, -357.7390342944007, -754.8975959234613, -1578.4316211339294, -299.99420078053083, -597.964698768798, -545.8665803648283, -229.36108110128797, -748.7394961882303, -83.898199701217, -817.7833538707937, -127.14898732520264, -335.510422022976, -186.3352941715576, -602.7671490073348, -313.4637878539732, -437.4738900134838, -861.9749583621895, -340.2031121137878, -273.111839342221, 4.530787411356515, -473.6769288980959, -898.2636076826285, -74.09650032231247, -198.3083258582599, -612.6652305803216, -366.15789416123783, 2.7519626654606935, 172.56595848005944, 268.02343343259696, 130.2172502604695, -12.188142187489621, 114.45272471165124, -41.382429466728446, -132.07060614545983, 21.99845940209309, 80.51768240950616, 62.308304039948624, -223.43838586432196, -298.3967315135619, 5.2563576493596464, 186.40853449708067, 224.9334442125378, -220.28320812886494, 135.31408715781672, 221.7564348009261], "episode_lengths": [257, 320, 358, 277, 295, 309, 285, 282, 260, 290, 325, 252, 311, 264, 268, 279, 252, 236, 257, 258, 261, 258, 289, 258, 221, 291, 256, 270, 234, 264, 260, 250, 322, 259, 284, 302, 296, 282, 302, 262, 269, 236, 292, 241, 254, 276, 270, 201, 272, 239, 217, 221, 255, 194, 229, 217, 258, 351, 222, 250, 251, 205, 257, 213, 241, 220, 214, 227, 227, 208, 236, 270, 252, 246, 192, 225, 300, 155, 227, 227, 205, 165, 176, 182, 222, 190, 162, 197, 201, 164, 170, 212, 196, 213, 210, 158, 213, 268, 184, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23823964825377175, "mean_inference_ms": 0.9767832520300899, "mean_action_processing_ms": 0.08465257985385419, "mean_env_wait_ms": 0.17128117661786044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 6989.434, "sample_time_ms": 620.981, "load_time_ms": 1.286, "load_throughput": 3110594.941, "learn_time_ms": 6354.577, "learn_throughput": 629.468, "synch_weights_time_ms": 11.447}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 108, "training_iteration": 7, "trial_id": "92ff3_00000", "date": "2023-05-01_00-37-45", "timestamp": 1682876265, "time_this_iter_s": 7.021657705307007, "time_total_s": 48.96567463874817, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 48.96567463874817, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 6.2299999999999995, "ram_util_percent": 57.83}}
{"custom_metrics": {"dps_mean": 10306.840119106584, "dps_min": 7847.8097684988015, "dps_max": 13514.730122444858}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3678169836600622, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.74675382798718, "policy_loss": -0.0254706355192328, "vf_loss": 9.766258521746563, "vf_explained_var": -0.00769232024428665, "kl": 0.013257708458034657, "entropy": 1.8601660778445581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 472.9244331522637, "episode_reward_min": -1608.2553776977188, "episode_reward_mean": -414.25097632806865, "episode_len_mean": 227.46, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10306.840119106584, "dps_min": 7847.8097684988015, "dps_max": 13514.730122444858}, "hist_stats": {"episode_reward": [-1451.177097260348, -1168.3284291760579, -1403.80243124295, -1043.559381495615, -701.3276736997647, -1608.2553776977188, -956.2838902235003, -1131.2533145640925, -956.2432919099049, -1054.9673333636858, -915.6649524595692, -833.2757063828085, -1309.4045515305127, -802.2521172311132, -1430.9932293005747, -1123.5463049624814, -1107.380688372665, -1073.4597490714445, -1459.8578397038643, -797.9149234249606, -1015.4832567587839, -718.5636500587478, -1102.6444528056095, -973.9147247699801, -1159.5243660007316, -1174.837371899611, -1029.3903739160842, -432.6709704508833, -834.8064690760227, -575.4972927219264, -440.10414750076177, -667.2165131796548, -1119.105622278377, -284.1147935970073, -709.0391388549752, -357.7390342944007, -754.8975959234613, -1578.4316211339294, -299.99420078053083, -597.964698768798, -545.8665803648283, -229.36108110128797, -748.7394961882303, -83.898199701217, -817.7833538707937, -127.14898732520264, -335.510422022976, -186.3352941715576, -602.7671490073348, -313.4637878539732, -437.4738900134838, -861.9749583621895, -340.2031121137878, -273.111839342221, 4.530787411356515, -473.6769288980959, -898.2636076826285, -74.09650032231247, -198.3083258582599, -612.6652305803216, -366.15789416123783, 2.7519626654606935, 172.56595848005944, 268.02343343259696, 130.2172502604695, -12.188142187489621, 114.45272471165124, -41.382429466728446, -132.07060614545983, 21.99845940209309, 80.51768240950616, 62.308304039948624, -223.43838586432196, -298.3967315135619, 5.2563576493596464, 186.40853449708067, 224.9334442125378, -220.28320812886494, 135.31408715781672, 221.7564348009261, 320.009991992514, 434.14688887665665, 263.27224325430745, 211.5503769698256, 225.28796470652898, 337.3830371668956, 230.7673070083428, 360.9252249115312, -144.3470213759232, -203.2208873001247, 155.0939254678459, 22.561059212284285, 183.8608535289059, 189.57692779758483, 308.154969186166, 439.6182842572124, 156.37282625825105, 472.9244331522637, 186.25127073614277, 403.1319903473339], "episode_lengths": [261, 258, 289, 258, 221, 291, 256, 270, 234, 264, 260, 250, 322, 259, 284, 302, 296, 282, 302, 262, 269, 236, 292, 241, 254, 276, 270, 201, 272, 239, 217, 221, 255, 194, 229, 217, 258, 351, 222, 250, 251, 205, 257, 213, 241, 220, 214, 227, 227, 208, 236, 270, 252, 246, 192, 225, 300, 155, 227, 227, 205, 165, 176, 182, 222, 190, 162, 197, 201, 164, 170, 212, 196, 213, 210, 158, 213, 268, 184, 206, 170, 209, 172, 183, 259, 178, 205, 187, 225, 252, 182, 202, 173, 180, 190, 178, 213, 175, 160, 181]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24015539621429874, "mean_inference_ms": 0.9740857864053183, "mean_action_processing_ms": 0.08412539337674697, "mean_env_wait_ms": 0.17105935166330188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 472.9244331522637, "episode_reward_min": -1608.2553776977188, "episode_reward_mean": -414.25097632806865, "episode_len_mean": 227.46, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1451.177097260348, -1168.3284291760579, -1403.80243124295, -1043.559381495615, -701.3276736997647, -1608.2553776977188, -956.2838902235003, -1131.2533145640925, -956.2432919099049, -1054.9673333636858, -915.6649524595692, -833.2757063828085, -1309.4045515305127, -802.2521172311132, -1430.9932293005747, -1123.5463049624814, -1107.380688372665, -1073.4597490714445, -1459.8578397038643, -797.9149234249606, -1015.4832567587839, -718.5636500587478, -1102.6444528056095, -973.9147247699801, -1159.5243660007316, -1174.837371899611, -1029.3903739160842, -432.6709704508833, -834.8064690760227, -575.4972927219264, -440.10414750076177, -667.2165131796548, -1119.105622278377, -284.1147935970073, -709.0391388549752, -357.7390342944007, -754.8975959234613, -1578.4316211339294, -299.99420078053083, -597.964698768798, -545.8665803648283, -229.36108110128797, -748.7394961882303, -83.898199701217, -817.7833538707937, -127.14898732520264, -335.510422022976, -186.3352941715576, -602.7671490073348, -313.4637878539732, -437.4738900134838, -861.9749583621895, -340.2031121137878, -273.111839342221, 4.530787411356515, -473.6769288980959, -898.2636076826285, -74.09650032231247, -198.3083258582599, -612.6652305803216, -366.15789416123783, 2.7519626654606935, 172.56595848005944, 268.02343343259696, 130.2172502604695, -12.188142187489621, 114.45272471165124, -41.382429466728446, -132.07060614545983, 21.99845940209309, 80.51768240950616, 62.308304039948624, -223.43838586432196, -298.3967315135619, 5.2563576493596464, 186.40853449708067, 224.9334442125378, -220.28320812886494, 135.31408715781672, 221.7564348009261, 320.009991992514, 434.14688887665665, 263.27224325430745, 211.5503769698256, 225.28796470652898, 337.3830371668956, 230.7673070083428, 360.9252249115312, -144.3470213759232, -203.2208873001247, 155.0939254678459, 22.561059212284285, 183.8608535289059, 189.57692779758483, 308.154969186166, 439.6182842572124, 156.37282625825105, 472.9244331522637, 186.25127073614277, 403.1319903473339], "episode_lengths": [261, 258, 289, 258, 221, 291, 256, 270, 234, 264, 260, 250, 322, 259, 284, 302, 296, 282, 302, 262, 269, 236, 292, 241, 254, 276, 270, 201, 272, 239, 217, 221, 255, 194, 229, 217, 258, 351, 222, 250, 251, 205, 257, 213, 241, 220, 214, 227, 227, 208, 236, 270, 252, 246, 192, 225, 300, 155, 227, 227, 205, 165, 176, 182, 222, 190, 162, 197, 201, 164, 170, 212, 196, 213, 210, 158, 213, 268, 184, 206, 170, 209, 172, 183, 259, 178, 205, 187, 225, 252, 182, 202, 173, 180, 190, 178, 213, 175, 160, 181]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24015539621429874, "mean_inference_ms": 0.9740857864053183, "mean_action_processing_ms": 0.08412539337674697, "mean_env_wait_ms": 0.17105935166330188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 6984.075, "sample_time_ms": 619.203, "load_time_ms": 1.376, "load_throughput": 2907726.077, "learn_time_ms": 6350.909, "learn_throughput": 629.831, "synch_weights_time_ms": 11.399}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 128, "training_iteration": 8, "trial_id": "92ff3_00000", "date": "2023-05-01_00-37-52", "timestamp": 1682876272, "time_this_iter_s": 6.952566385269165, "time_total_s": 55.918241024017334, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 55.918241024017334, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 5.83, "ram_util_percent": 57.9}}
{"custom_metrics": {"dps_mean": 10334.729423221623, "dps_min": 7847.8097684988015, "dps_max": 13899.58888662302}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2590740162839171, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.84632118594262, "policy_loss": -0.03131118400362871, "vf_loss": 9.872670853522516, "vf_explained_var": -0.012154058230820523, "kl": 0.011025474288894149, "entropy": 1.7604025394685807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 679.6732952422082, "episode_reward_min": -1578.4316211339294, "episode_reward_mean": -82.42829240374526, "episode_len_mean": 208.1, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10334.729423221623, "dps_min": 7847.8097684988015, "dps_max": 13899.58888662302}, "hist_stats": {"episode_reward": [-973.9147247699801, -1159.5243660007316, -1174.837371899611, -1029.3903739160842, -432.6709704508833, -834.8064690760227, -575.4972927219264, -440.10414750076177, -667.2165131796548, -1119.105622278377, -284.1147935970073, -709.0391388549752, -357.7390342944007, -754.8975959234613, -1578.4316211339294, -299.99420078053083, -597.964698768798, -545.8665803648283, -229.36108110128797, -748.7394961882303, -83.898199701217, -817.7833538707937, -127.14898732520264, -335.510422022976, -186.3352941715576, -602.7671490073348, -313.4637878539732, -437.4738900134838, -861.9749583621895, -340.2031121137878, -273.111839342221, 4.530787411356515, -473.6769288980959, -898.2636076826285, -74.09650032231247, -198.3083258582599, -612.6652305803216, -366.15789416123783, 2.7519626654606935, 172.56595848005944, 268.02343343259696, 130.2172502604695, -12.188142187489621, 114.45272471165124, -41.382429466728446, -132.07060614545983, 21.99845940209309, 80.51768240950616, 62.308304039948624, -223.43838586432196, -298.3967315135619, 5.2563576493596464, 186.40853449708067, 224.9334442125378, -220.28320812886494, 135.31408715781672, 221.7564348009261, 320.009991992514, 434.14688887665665, 263.27224325430745, 211.5503769698256, 225.28796470652898, 337.3830371668956, 230.7673070083428, 360.9252249115312, -144.3470213759232, -203.2208873001247, 155.0939254678459, 22.561059212284285, 183.8608535289059, 189.57692779758483, 308.154969186166, 439.6182842572124, 156.37282625825105, 472.9244331522637, 186.25127073614277, 403.1319903473339, 498.3459861951659, 399.2952944724406, 160.8994872109285, 235.4686449570044, 260.4049912117634, 484.78186650726707, 13.535126514330955, 679.6732952422082, 193.6664222863534, 548.2848831794662, 121.86264476940204, 529.5924234379656, 581.4427376649097, 439.073558099273, 451.6394329244356, 132.45865000436513, 102.42937391549034, -26.297399035758716, 271.62532830640004, 437.9819975782434, 499.7106737846595, 532.3242004734653, 468.42913003579076], "episode_lengths": [241, 254, 276, 270, 201, 272, 239, 217, 221, 255, 194, 229, 217, 258, 351, 222, 250, 251, 205, 257, 213, 241, 220, 214, 227, 227, 208, 236, 270, 252, 246, 192, 225, 300, 155, 227, 227, 205, 165, 176, 182, 222, 190, 162, 197, 201, 164, 170, 212, 196, 213, 210, 158, 213, 268, 184, 206, 170, 209, 172, 183, 259, 178, 205, 187, 225, 252, 182, 202, 173, 180, 190, 178, 213, 175, 160, 181, 202, 187, 275, 179, 185, 156, 188, 163, 186, 163, 181, 186, 154, 164, 203, 193, 208, 228, 194, 164, 185, 156, 182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24153829022345605, "mean_inference_ms": 0.9747616739998919, "mean_action_processing_ms": 0.08490585963456418, "mean_env_wait_ms": 0.17191472697499427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 679.6732952422082, "episode_reward_min": -1578.4316211339294, "episode_reward_mean": -82.42829240374526, "episode_len_mean": 208.1, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-973.9147247699801, -1159.5243660007316, -1174.837371899611, -1029.3903739160842, -432.6709704508833, -834.8064690760227, -575.4972927219264, -440.10414750076177, -667.2165131796548, -1119.105622278377, -284.1147935970073, -709.0391388549752, -357.7390342944007, -754.8975959234613, -1578.4316211339294, -299.99420078053083, -597.964698768798, -545.8665803648283, -229.36108110128797, -748.7394961882303, -83.898199701217, -817.7833538707937, -127.14898732520264, -335.510422022976, -186.3352941715576, -602.7671490073348, -313.4637878539732, -437.4738900134838, -861.9749583621895, -340.2031121137878, -273.111839342221, 4.530787411356515, -473.6769288980959, -898.2636076826285, -74.09650032231247, -198.3083258582599, -612.6652305803216, -366.15789416123783, 2.7519626654606935, 172.56595848005944, 268.02343343259696, 130.2172502604695, -12.188142187489621, 114.45272471165124, -41.382429466728446, -132.07060614545983, 21.99845940209309, 80.51768240950616, 62.308304039948624, -223.43838586432196, -298.3967315135619, 5.2563576493596464, 186.40853449708067, 224.9334442125378, -220.28320812886494, 135.31408715781672, 221.7564348009261, 320.009991992514, 434.14688887665665, 263.27224325430745, 211.5503769698256, 225.28796470652898, 337.3830371668956, 230.7673070083428, 360.9252249115312, -144.3470213759232, -203.2208873001247, 155.0939254678459, 22.561059212284285, 183.8608535289059, 189.57692779758483, 308.154969186166, 439.6182842572124, 156.37282625825105, 472.9244331522637, 186.25127073614277, 403.1319903473339, 498.3459861951659, 399.2952944724406, 160.8994872109285, 235.4686449570044, 260.4049912117634, 484.78186650726707, 13.535126514330955, 679.6732952422082, 193.6664222863534, 548.2848831794662, 121.86264476940204, 529.5924234379656, 581.4427376649097, 439.073558099273, 451.6394329244356, 132.45865000436513, 102.42937391549034, -26.297399035758716, 271.62532830640004, 437.9819975782434, 499.7106737846595, 532.3242004734653, 468.42913003579076], "episode_lengths": [241, 254, 276, 270, 201, 272, 239, 217, 221, 255, 194, 229, 217, 258, 351, 222, 250, 251, 205, 257, 213, 241, 220, 214, 227, 227, 208, 236, 270, 252, 246, 192, 225, 300, 155, 227, 227, 205, 165, 176, 182, 222, 190, 162, 197, 201, 164, 170, 212, 196, 213, 210, 158, 213, 268, 184, 206, 170, 209, 172, 183, 259, 178, 205, 187, 225, 252, 182, 202, 173, 180, 190, 178, 213, 175, 160, 181, 202, 187, 275, 179, 185, 156, 188, 163, 186, 163, 181, 186, 154, 164, 203, 193, 208, 228, 194, 164, 185, 156, 182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24153829022345605, "mean_inference_ms": 0.9747616739998919, "mean_action_processing_ms": 0.08490585963456418, "mean_env_wait_ms": 0.17191472697499427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 7003.377, "sample_time_ms": 618.885, "load_time_ms": 1.334, "load_throughput": 2998906.534, "learn_time_ms": 6370.522, "learn_throughput": 627.892, "synch_weights_time_ms": 11.468}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 151, "training_iteration": 9, "trial_id": "92ff3_00000", "date": "2023-05-01_00-37-59", "timestamp": 1682876279, "time_this_iter_s": 7.16431450843811, "time_total_s": 63.082555532455444, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 63.082555532455444, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 6.09, "ram_util_percent": 57.95}}
{"custom_metrics": {"dps_mean": 10550.744125424591, "dps_min": 7847.8097684988015, "dps_max": 13899.58888662302}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.210112553065823, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.829776883894397, "policy_loss": -0.03835206310995804, "vf_loss": 9.862959009601225, "vf_explained_var": -0.009984854088034682, "kl": 0.011488734340932753, "entropy": 1.7173297856443672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 815.3846737529504, "episode_reward_min": -898.2636076826285, "episode_reward_mean": 191.79132455936994, "episode_len_mean": 195.65, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10550.744125424591, "dps_min": 7847.8097684988015, "dps_max": 13899.58888662302}, "hist_stats": {"episode_reward": [-127.14898732520264, -335.510422022976, -186.3352941715576, -602.7671490073348, -313.4637878539732, -437.4738900134838, -861.9749583621895, -340.2031121137878, -273.111839342221, 4.530787411356515, -473.6769288980959, -898.2636076826285, -74.09650032231247, -198.3083258582599, -612.6652305803216, -366.15789416123783, 2.7519626654606935, 172.56595848005944, 268.02343343259696, 130.2172502604695, -12.188142187489621, 114.45272471165124, -41.382429466728446, -132.07060614545983, 21.99845940209309, 80.51768240950616, 62.308304039948624, -223.43838586432196, -298.3967315135619, 5.2563576493596464, 186.40853449708067, 224.9334442125378, -220.28320812886494, 135.31408715781672, 221.7564348009261, 320.009991992514, 434.14688887665665, 263.27224325430745, 211.5503769698256, 225.28796470652898, 337.3830371668956, 230.7673070083428, 360.9252249115312, -144.3470213759232, -203.2208873001247, 155.0939254678459, 22.561059212284285, 183.8608535289059, 189.57692779758483, 308.154969186166, 439.6182842572124, 156.37282625825105, 472.9244331522637, 186.25127073614277, 403.1319903473339, 498.3459861951659, 399.2952944724406, 160.8994872109285, 235.4686449570044, 260.4049912117634, 484.78186650726707, 13.535126514330955, 679.6732952422082, 193.6664222863534, 548.2848831794662, 121.86264476940204, 529.5924234379656, 581.4427376649097, 439.073558099273, 451.6394329244356, 132.45865000436513, 102.42937391549034, -26.297399035758716, 271.62532830640004, 437.9819975782434, 499.7106737846595, 532.3242004734653, 468.42913003579076, 434.00940452026185, 570.6914260432984, 609.3399233830204, 339.35965601477864, 491.45189799101234, 743.3228712924486, 708.3783671205937, 628.1969822823689, 535.2222063647812, 286.27377808952474, 623.9722668323747, 381.0044619011486, 555.9204341879697, 413.7558482896597, 557.7986181544034, 495.34570101583137, 553.9888148645928, 815.3846737529504, 689.2157659427464, 392.14061933037146, 599.6530340003346, 582.6372985635551], "episode_lengths": [220, 214, 227, 227, 208, 236, 270, 252, 246, 192, 225, 300, 155, 227, 227, 205, 165, 176, 182, 222, 190, 162, 197, 201, 164, 170, 212, 196, 213, 210, 158, 213, 268, 184, 206, 170, 209, 172, 183, 259, 178, 205, 187, 225, 252, 182, 202, 173, 180, 190, 178, 213, 175, 160, 181, 202, 187, 275, 179, 185, 156, 188, 163, 186, 163, 181, 186, 154, 164, 203, 193, 208, 228, 194, 164, 185, 156, 182, 154, 200, 169, 229, 158, 186, 174, 173, 210, 177, 184, 198, 227, 180, 191, 185, 162, 179, 178, 167, 183, 225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24327991366091098, "mean_inference_ms": 0.9682004012956276, "mean_action_processing_ms": 0.08482409885055489, "mean_env_wait_ms": 0.17087043666128493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 815.3846737529504, "episode_reward_min": -898.2636076826285, "episode_reward_mean": 191.79132455936994, "episode_len_mean": 195.65, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-127.14898732520264, -335.510422022976, -186.3352941715576, -602.7671490073348, -313.4637878539732, -437.4738900134838, -861.9749583621895, -340.2031121137878, -273.111839342221, 4.530787411356515, -473.6769288980959, -898.2636076826285, -74.09650032231247, -198.3083258582599, -612.6652305803216, -366.15789416123783, 2.7519626654606935, 172.56595848005944, 268.02343343259696, 130.2172502604695, -12.188142187489621, 114.45272471165124, -41.382429466728446, -132.07060614545983, 21.99845940209309, 80.51768240950616, 62.308304039948624, -223.43838586432196, -298.3967315135619, 5.2563576493596464, 186.40853449708067, 224.9334442125378, -220.28320812886494, 135.31408715781672, 221.7564348009261, 320.009991992514, 434.14688887665665, 263.27224325430745, 211.5503769698256, 225.28796470652898, 337.3830371668956, 230.7673070083428, 360.9252249115312, -144.3470213759232, -203.2208873001247, 155.0939254678459, 22.561059212284285, 183.8608535289059, 189.57692779758483, 308.154969186166, 439.6182842572124, 156.37282625825105, 472.9244331522637, 186.25127073614277, 403.1319903473339, 498.3459861951659, 399.2952944724406, 160.8994872109285, 235.4686449570044, 260.4049912117634, 484.78186650726707, 13.535126514330955, 679.6732952422082, 193.6664222863534, 548.2848831794662, 121.86264476940204, 529.5924234379656, 581.4427376649097, 439.073558099273, 451.6394329244356, 132.45865000436513, 102.42937391549034, -26.297399035758716, 271.62532830640004, 437.9819975782434, 499.7106737846595, 532.3242004734653, 468.42913003579076, 434.00940452026185, 570.6914260432984, 609.3399233830204, 339.35965601477864, 491.45189799101234, 743.3228712924486, 708.3783671205937, 628.1969822823689, 535.2222063647812, 286.27377808952474, 623.9722668323747, 381.0044619011486, 555.9204341879697, 413.7558482896597, 557.7986181544034, 495.34570101583137, 553.9888148645928, 815.3846737529504, 689.2157659427464, 392.14061933037146, 599.6530340003346, 582.6372985635551], "episode_lengths": [220, 214, 227, 227, 208, 236, 270, 252, 246, 192, 225, 300, 155, 227, 227, 205, 165, 176, 182, 222, 190, 162, 197, 201, 164, 170, 212, 196, 213, 210, 158, 213, 268, 184, 206, 170, 209, 172, 183, 259, 178, 205, 187, 225, 252, 182, 202, 173, 180, 190, 178, 213, 175, 160, 181, 202, 187, 275, 179, 185, 156, 188, 163, 186, 163, 181, 186, 154, 164, 203, 193, 208, 228, 194, 164, 185, 156, 182, 154, 200, 169, 229, 158, 186, 174, 173, 210, 177, 184, 198, 227, 180, 191, 185, 162, 179, 178, 167, 183, 225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24327991366091098, "mean_inference_ms": 0.9682004012956276, "mean_action_processing_ms": 0.08482409885055489, "mean_env_wait_ms": 0.17087043666128493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 7050.664, "sample_time_ms": 622.153, "load_time_ms": 1.4, "load_throughput": 2856328.379, "learn_time_ms": 6414.47, "learn_throughput": 623.59, "synch_weights_time_ms": 11.59}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 173, "training_iteration": 10, "trial_id": "92ff3_00000", "date": "2023-05-01_00-38-07", "timestamp": 1682876287, "time_this_iter_s": 7.481255292892456, "time_total_s": 70.5638108253479, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 70.5638108253479, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 7.1090909090909085, "ram_util_percent": 58.32727272727273}}
{"custom_metrics": {"dps_mean": 10911.415796702237, "dps_min": 8691.614316050283, "dps_max": 15908.480552587085}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5788686738219313, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.822316428153746, "policy_loss": -0.04746802994000014, "vf_loss": 9.86344953967679, "vf_explained_var": -0.003582640168487385, "kl": 0.014077576265418834, "entropy": 1.6162689780676236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 870.9357199661622, "episode_reward_min": -298.3967315135619, "episode_reward_mean": 358.163485388822, "episode_len_mean": 194.33, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 10911.415796702237, "dps_min": 8691.614316050283, "dps_max": 15908.480552587085}, "hist_stats": {"episode_reward": [130.2172502604695, -12.188142187489621, 114.45272471165124, -41.382429466728446, -132.07060614545983, 21.99845940209309, 80.51768240950616, 62.308304039948624, -223.43838586432196, -298.3967315135619, 5.2563576493596464, 186.40853449708067, 224.9334442125378, -220.28320812886494, 135.31408715781672, 221.7564348009261, 320.009991992514, 434.14688887665665, 263.27224325430745, 211.5503769698256, 225.28796470652898, 337.3830371668956, 230.7673070083428, 360.9252249115312, -144.3470213759232, -203.2208873001247, 155.0939254678459, 22.561059212284285, 183.8608535289059, 189.57692779758483, 308.154969186166, 439.6182842572124, 156.37282625825105, 472.9244331522637, 186.25127073614277, 403.1319903473339, 498.3459861951659, 399.2952944724406, 160.8994872109285, 235.4686449570044, 260.4049912117634, 484.78186650726707, 13.535126514330955, 679.6732952422082, 193.6664222863534, 548.2848831794662, 121.86264476940204, 529.5924234379656, 581.4427376649097, 439.073558099273, 451.6394329244356, 132.45865000436513, 102.42937391549034, -26.297399035758716, 271.62532830640004, 437.9819975782434, 499.7106737846595, 532.3242004734653, 468.42913003579076, 434.00940452026185, 570.6914260432984, 609.3399233830204, 339.35965601477864, 491.45189799101234, 743.3228712924486, 708.3783671205937, 628.1969822823689, 535.2222063647812, 286.27377808952474, 623.9722668323747, 381.0044619011486, 555.9204341879697, 413.7558482896597, 557.7986181544034, 495.34570101583137, 553.9888148645928, 815.3846737529504, 689.2157659427464, 392.14061933037146, 599.6530340003346, 582.6372985635551, 493.3727207320041, 551.0668933295317, 374.3445283090133, 485.9934025623742, 673.9629081999399, 623.3804410024175, 81.68825837204282, 409.12358351721076, 432.1245040694417, 391.4729563666159, 842.8866156106827, 418.80676390140815, 505.4930069915446, 870.9357199661622, 776.1695201169081, 737.4438320963794, 799.2368488684906, 691.2563171502779, 825.1714760566508], "episode_lengths": [222, 190, 162, 197, 201, 164, 170, 212, 196, 213, 210, 158, 213, 268, 184, 206, 170, 209, 172, 183, 259, 178, 205, 187, 225, 252, 182, 202, 173, 180, 190, 178, 213, 175, 160, 181, 202, 187, 275, 179, 185, 156, 188, 163, 186, 163, 181, 186, 154, 164, 203, 193, 208, 228, 194, 164, 185, 156, 182, 154, 200, 169, 229, 158, 186, 174, 173, 210, 177, 184, 198, 227, 180, 191, 185, 162, 179, 178, 167, 183, 225, 248, 203, 237, 196, 170, 274, 271, 194, 193, 210, 206, 167, 185, 199, 184, 273, 210, 207, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2451437795780344, "mean_inference_ms": 0.9724411888694465, "mean_action_processing_ms": 0.0855971799965031, "mean_env_wait_ms": 0.1717945823508581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 870.9357199661622, "episode_reward_min": -298.3967315135619, "episode_reward_mean": 358.163485388822, "episode_len_mean": 194.33, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [130.2172502604695, -12.188142187489621, 114.45272471165124, -41.382429466728446, -132.07060614545983, 21.99845940209309, 80.51768240950616, 62.308304039948624, -223.43838586432196, -298.3967315135619, 5.2563576493596464, 186.40853449708067, 224.9334442125378, -220.28320812886494, 135.31408715781672, 221.7564348009261, 320.009991992514, 434.14688887665665, 263.27224325430745, 211.5503769698256, 225.28796470652898, 337.3830371668956, 230.7673070083428, 360.9252249115312, -144.3470213759232, -203.2208873001247, 155.0939254678459, 22.561059212284285, 183.8608535289059, 189.57692779758483, 308.154969186166, 439.6182842572124, 156.37282625825105, 472.9244331522637, 186.25127073614277, 403.1319903473339, 498.3459861951659, 399.2952944724406, 160.8994872109285, 235.4686449570044, 260.4049912117634, 484.78186650726707, 13.535126514330955, 679.6732952422082, 193.6664222863534, 548.2848831794662, 121.86264476940204, 529.5924234379656, 581.4427376649097, 439.073558099273, 451.6394329244356, 132.45865000436513, 102.42937391549034, -26.297399035758716, 271.62532830640004, 437.9819975782434, 499.7106737846595, 532.3242004734653, 468.42913003579076, 434.00940452026185, 570.6914260432984, 609.3399233830204, 339.35965601477864, 491.45189799101234, 743.3228712924486, 708.3783671205937, 628.1969822823689, 535.2222063647812, 286.27377808952474, 623.9722668323747, 381.0044619011486, 555.9204341879697, 413.7558482896597, 557.7986181544034, 495.34570101583137, 553.9888148645928, 815.3846737529504, 689.2157659427464, 392.14061933037146, 599.6530340003346, 582.6372985635551, 493.3727207320041, 551.0668933295317, 374.3445283090133, 485.9934025623742, 673.9629081999399, 623.3804410024175, 81.68825837204282, 409.12358351721076, 432.1245040694417, 391.4729563666159, 842.8866156106827, 418.80676390140815, 505.4930069915446, 870.9357199661622, 776.1695201169081, 737.4438320963794, 799.2368488684906, 691.2563171502779, 825.1714760566508], "episode_lengths": [222, 190, 162, 197, 201, 164, 170, 212, 196, 213, 210, 158, 213, 268, 184, 206, 170, 209, 172, 183, 259, 178, 205, 187, 225, 252, 182, 202, 173, 180, 190, 178, 213, 175, 160, 181, 202, 187, 275, 179, 185, 156, 188, 163, 186, 163, 181, 186, 154, 164, 203, 193, 208, 228, 194, 164, 185, 156, 182, 154, 200, 169, 229, 158, 186, 174, 173, 210, 177, 184, 198, 227, 180, 191, 185, 162, 179, 178, 167, 183, 225, 248, 203, 237, 196, 170, 274, 271, 194, 193, 210, 206, 167, 185, 199, 184, 273, 210, 207, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2451437795780344, "mean_inference_ms": 0.9724411888694465, "mean_action_processing_ms": 0.0855971799965031, "mean_env_wait_ms": 0.1717945823508581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 7060.637, "sample_time_ms": 624.452, "load_time_ms": 1.401, "load_throughput": 2855064.581, "learn_time_ms": 6422.649, "learn_throughput": 622.796, "synch_weights_time_ms": 11.134}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 192, "training_iteration": 11, "trial_id": "92ff3_00000", "date": "2023-05-01_00-38-14", "timestamp": 1682876294, "time_this_iter_s": 7.259613752365112, "time_total_s": 77.82342457771301, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 77.82342457771301, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 6.130000000000001, "ram_util_percent": 58.65000000000001}}
{"custom_metrics": {"dps_mean": 11199.26270544238, "dps_min": 8784.470303021622, "dps_max": 15908.480552587085}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2826415742597272, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.868422530799783, "policy_loss": -0.045926338267983285, "vf_loss": 9.909101297522104, "vf_explained_var": -0.00382138644495318, "kl": 0.011661199132995776, "entropy": 1.6054212348435515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 974.5458268586249, "episode_reward_min": -203.2208873001247, "episode_reward_mean": 461.31707246054765, "episode_len_mean": 196.68, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 11199.26270544238, "dps_min": 8784.470303021622, "dps_max": 15908.480552587085}, "hist_stats": {"episode_reward": [263.27224325430745, 211.5503769698256, 225.28796470652898, 337.3830371668956, 230.7673070083428, 360.9252249115312, -144.3470213759232, -203.2208873001247, 155.0939254678459, 22.561059212284285, 183.8608535289059, 189.57692779758483, 308.154969186166, 439.6182842572124, 156.37282625825105, 472.9244331522637, 186.25127073614277, 403.1319903473339, 498.3459861951659, 399.2952944724406, 160.8994872109285, 235.4686449570044, 260.4049912117634, 484.78186650726707, 13.535126514330955, 679.6732952422082, 193.6664222863534, 548.2848831794662, 121.86264476940204, 529.5924234379656, 581.4427376649097, 439.073558099273, 451.6394329244356, 132.45865000436513, 102.42937391549034, -26.297399035758716, 271.62532830640004, 437.9819975782434, 499.7106737846595, 532.3242004734653, 468.42913003579076, 434.00940452026185, 570.6914260432984, 609.3399233830204, 339.35965601477864, 491.45189799101234, 743.3228712924486, 708.3783671205937, 628.1969822823689, 535.2222063647812, 286.27377808952474, 623.9722668323747, 381.0044619011486, 555.9204341879697, 413.7558482896597, 557.7986181544034, 495.34570101583137, 553.9888148645928, 815.3846737529504, 689.2157659427464, 392.14061933037146, 599.6530340003346, 582.6372985635551, 493.3727207320041, 551.0668933295317, 374.3445283090133, 485.9934025623742, 673.9629081999399, 623.3804410024175, 81.68825837204282, 409.12358351721076, 432.1245040694417, 391.4729563666159, 842.8866156106827, 418.80676390140815, 505.4930069915446, 870.9357199661622, 776.1695201169081, 737.4438320963794, 799.2368488684906, 691.2563171502779, 825.1714760566508, 617.1222130239021, 621.603390558734, 554.8995935897752, 666.7169974256092, 505.19528459768026, 963.6339446944443, 537.1161603660258, 581.6205239648574, 605.700477913467, 387.6288618185811, 608.545311049809, 636.1768066713272, 974.5458268586249, 471.64918049559515, 501.397544658362, 473.6255639359525, 816.8648304830159, 800.8768517709343], "episode_lengths": [172, 183, 259, 178, 205, 187, 225, 252, 182, 202, 173, 180, 190, 178, 213, 175, 160, 181, 202, 187, 275, 179, 185, 156, 188, 163, 186, 163, 181, 186, 154, 164, 203, 193, 208, 228, 194, 164, 185, 156, 182, 154, 200, 169, 229, 158, 186, 174, 173, 210, 177, 184, 198, 227, 180, 191, 185, 162, 179, 178, 167, 183, 225, 248, 203, 237, 196, 170, 274, 271, 194, 193, 210, 206, 167, 185, 199, 184, 273, 210, 207, 195, 179, 197, 203, 219, 242, 212, 162, 200, 224, 226, 197, 189, 255, 184, 227, 201, 212, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24685843303205154, "mean_inference_ms": 0.9770201478304992, "mean_action_processing_ms": 0.08637080705591474, "mean_env_wait_ms": 0.173335799110499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 974.5458268586249, "episode_reward_min": -203.2208873001247, "episode_reward_mean": 461.31707246054765, "episode_len_mean": 196.68, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [263.27224325430745, 211.5503769698256, 225.28796470652898, 337.3830371668956, 230.7673070083428, 360.9252249115312, -144.3470213759232, -203.2208873001247, 155.0939254678459, 22.561059212284285, 183.8608535289059, 189.57692779758483, 308.154969186166, 439.6182842572124, 156.37282625825105, 472.9244331522637, 186.25127073614277, 403.1319903473339, 498.3459861951659, 399.2952944724406, 160.8994872109285, 235.4686449570044, 260.4049912117634, 484.78186650726707, 13.535126514330955, 679.6732952422082, 193.6664222863534, 548.2848831794662, 121.86264476940204, 529.5924234379656, 581.4427376649097, 439.073558099273, 451.6394329244356, 132.45865000436513, 102.42937391549034, -26.297399035758716, 271.62532830640004, 437.9819975782434, 499.7106737846595, 532.3242004734653, 468.42913003579076, 434.00940452026185, 570.6914260432984, 609.3399233830204, 339.35965601477864, 491.45189799101234, 743.3228712924486, 708.3783671205937, 628.1969822823689, 535.2222063647812, 286.27377808952474, 623.9722668323747, 381.0044619011486, 555.9204341879697, 413.7558482896597, 557.7986181544034, 495.34570101583137, 553.9888148645928, 815.3846737529504, 689.2157659427464, 392.14061933037146, 599.6530340003346, 582.6372985635551, 493.3727207320041, 551.0668933295317, 374.3445283090133, 485.9934025623742, 673.9629081999399, 623.3804410024175, 81.68825837204282, 409.12358351721076, 432.1245040694417, 391.4729563666159, 842.8866156106827, 418.80676390140815, 505.4930069915446, 870.9357199661622, 776.1695201169081, 737.4438320963794, 799.2368488684906, 691.2563171502779, 825.1714760566508, 617.1222130239021, 621.603390558734, 554.8995935897752, 666.7169974256092, 505.19528459768026, 963.6339446944443, 537.1161603660258, 581.6205239648574, 605.700477913467, 387.6288618185811, 608.545311049809, 636.1768066713272, 974.5458268586249, 471.64918049559515, 501.397544658362, 473.6255639359525, 816.8648304830159, 800.8768517709343], "episode_lengths": [172, 183, 259, 178, 205, 187, 225, 252, 182, 202, 173, 180, 190, 178, 213, 175, 160, 181, 202, 187, 275, 179, 185, 156, 188, 163, 186, 163, 181, 186, 154, 164, 203, 193, 208, 228, 194, 164, 185, 156, 182, 154, 200, 169, 229, 158, 186, 174, 173, 210, 177, 184, 198, 227, 180, 191, 185, 162, 179, 178, 167, 183, 225, 248, 203, 237, 196, 170, 274, 271, 194, 193, 210, 206, 167, 185, 199, 184, 273, 210, 207, 195, 179, 197, 203, 219, 242, 212, 162, 200, 224, 226, 197, 189, 255, 184, 227, 201, 212, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24685843303205154, "mean_inference_ms": 0.9770201478304992, "mean_action_processing_ms": 0.08637080705591474, "mean_env_wait_ms": 0.173335799110499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 7101.903, "sample_time_ms": 646.112, "load_time_ms": 1.4, "load_throughput": 2856425.641, "learn_time_ms": 6442.254, "learn_throughput": 620.901, "synch_weights_time_ms": 11.285}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 210, "training_iteration": 12, "trial_id": "92ff3_00000", "date": "2023-05-01_00-38-21", "timestamp": 1682876301, "time_this_iter_s": 7.337770938873291, "time_total_s": 85.1611955165863, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 85.1611955165863, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 8.5, "ram_util_percent": 58.56}}
{"custom_metrics": {"dps_mean": 11712.843545203015, "dps_min": 9020.238539775864, "dps_max": 15908.480552587085}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3799794252200792, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.884076965496105, "policy_loss": -0.03908077923240521, "vf_loss": 9.918694953508275, "vf_explained_var": 0.003906400165250224, "kl": 0.009917343590662214, "entropy": 1.5240633215955508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 1028.8459979254874, "episode_reward_min": -26.297399035758716, "episode_reward_mean": 565.9584709435135, "episode_len_mean": 200.23, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 11712.843545203015, "dps_min": 9020.238539775864, "dps_max": 15908.480552587085}, "hist_stats": {"episode_reward": [498.3459861951659, 399.2952944724406, 160.8994872109285, 235.4686449570044, 260.4049912117634, 484.78186650726707, 13.535126514330955, 679.6732952422082, 193.6664222863534, 548.2848831794662, 121.86264476940204, 529.5924234379656, 581.4427376649097, 439.073558099273, 451.6394329244356, 132.45865000436513, 102.42937391549034, -26.297399035758716, 271.62532830640004, 437.9819975782434, 499.7106737846595, 532.3242004734653, 468.42913003579076, 434.00940452026185, 570.6914260432984, 609.3399233830204, 339.35965601477864, 491.45189799101234, 743.3228712924486, 708.3783671205937, 628.1969822823689, 535.2222063647812, 286.27377808952474, 623.9722668323747, 381.0044619011486, 555.9204341879697, 413.7558482896597, 557.7986181544034, 495.34570101583137, 553.9888148645928, 815.3846737529504, 689.2157659427464, 392.14061933037146, 599.6530340003346, 582.6372985635551, 493.3727207320041, 551.0668933295317, 374.3445283090133, 485.9934025623742, 673.9629081999399, 623.3804410024175, 81.68825837204282, 409.12358351721076, 432.1245040694417, 391.4729563666159, 842.8866156106827, 418.80676390140815, 505.4930069915446, 870.9357199661622, 776.1695201169081, 737.4438320963794, 799.2368488684906, 691.2563171502779, 825.1714760566508, 617.1222130239021, 621.603390558734, 554.8995935897752, 666.7169974256092, 505.19528459768026, 963.6339446944443, 537.1161603660258, 581.6205239648574, 605.700477913467, 387.6288618185811, 608.545311049809, 636.1768066713272, 974.5458268586249, 471.64918049559515, 501.397544658362, 473.6255639359525, 816.8648304830159, 800.8768517709343, 708.9902973099922, 911.7800029187657, 509.78892430370945, 603.6905568722755, 923.915580579018, 797.8146695500701, 968.4466381012, 777.9629848045462, 880.2975987863631, 901.0939542542187, 836.497724723148, 501.1219477264764, 1028.8459979254874, 810.2865938196252, 1017.9159691480411, 503.4702434393747, 801.5189985628509, 779.8659507567874], "episode_lengths": [202, 187, 275, 179, 185, 156, 188, 163, 186, 163, 181, 186, 154, 164, 203, 193, 208, 228, 194, 164, 185, 156, 182, 154, 200, 169, 229, 158, 186, 174, 173, 210, 177, 184, 198, 227, 180, 191, 185, 162, 179, 178, 167, 183, 225, 248, 203, 237, 196, 170, 274, 271, 194, 193, 210, 206, 167, 185, 199, 184, 273, 210, 207, 195, 179, 197, 203, 219, 242, 212, 162, 200, 224, 226, 197, 189, 255, 184, 227, 201, 212, 251, 224, 181, 263, 187, 220, 248, 199, 259, 216, 232, 177, 214, 222, 192, 186, 226, 194, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24867770674006434, "mean_inference_ms": 0.9782429169190792, "mean_action_processing_ms": 0.08654748693873654, "mean_env_wait_ms": 0.1737034786734395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1028.8459979254874, "episode_reward_min": -26.297399035758716, "episode_reward_mean": 565.9584709435135, "episode_len_mean": 200.23, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [498.3459861951659, 399.2952944724406, 160.8994872109285, 235.4686449570044, 260.4049912117634, 484.78186650726707, 13.535126514330955, 679.6732952422082, 193.6664222863534, 548.2848831794662, 121.86264476940204, 529.5924234379656, 581.4427376649097, 439.073558099273, 451.6394329244356, 132.45865000436513, 102.42937391549034, -26.297399035758716, 271.62532830640004, 437.9819975782434, 499.7106737846595, 532.3242004734653, 468.42913003579076, 434.00940452026185, 570.6914260432984, 609.3399233830204, 339.35965601477864, 491.45189799101234, 743.3228712924486, 708.3783671205937, 628.1969822823689, 535.2222063647812, 286.27377808952474, 623.9722668323747, 381.0044619011486, 555.9204341879697, 413.7558482896597, 557.7986181544034, 495.34570101583137, 553.9888148645928, 815.3846737529504, 689.2157659427464, 392.14061933037146, 599.6530340003346, 582.6372985635551, 493.3727207320041, 551.0668933295317, 374.3445283090133, 485.9934025623742, 673.9629081999399, 623.3804410024175, 81.68825837204282, 409.12358351721076, 432.1245040694417, 391.4729563666159, 842.8866156106827, 418.80676390140815, 505.4930069915446, 870.9357199661622, 776.1695201169081, 737.4438320963794, 799.2368488684906, 691.2563171502779, 825.1714760566508, 617.1222130239021, 621.603390558734, 554.8995935897752, 666.7169974256092, 505.19528459768026, 963.6339446944443, 537.1161603660258, 581.6205239648574, 605.700477913467, 387.6288618185811, 608.545311049809, 636.1768066713272, 974.5458268586249, 471.64918049559515, 501.397544658362, 473.6255639359525, 816.8648304830159, 800.8768517709343, 708.9902973099922, 911.7800029187657, 509.78892430370945, 603.6905568722755, 923.915580579018, 797.8146695500701, 968.4466381012, 777.9629848045462, 880.2975987863631, 901.0939542542187, 836.497724723148, 501.1219477264764, 1028.8459979254874, 810.2865938196252, 1017.9159691480411, 503.4702434393747, 801.5189985628509, 779.8659507567874], "episode_lengths": [202, 187, 275, 179, 185, 156, 188, 163, 186, 163, 181, 186, 154, 164, 203, 193, 208, 228, 194, 164, 185, 156, 182, 154, 200, 169, 229, 158, 186, 174, 173, 210, 177, 184, 198, 227, 180, 191, 185, 162, 179, 178, 167, 183, 225, 248, 203, 237, 196, 170, 274, 271, 194, 193, 210, 206, 167, 185, 199, 184, 273, 210, 207, 195, 179, 197, 203, 219, 242, 212, 162, 200, 224, 226, 197, 189, 255, 184, 227, 201, 212, 251, 224, 181, 263, 187, 220, 248, 199, 259, 216, 232, 177, 214, 222, 192, 186, 226, 194, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24867770674006434, "mean_inference_ms": 0.9782429169190792, "mean_action_processing_ms": 0.08654748693873654, "mean_env_wait_ms": 0.1737034786734395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 7130.365, "sample_time_ms": 650.529, "load_time_ms": 1.351, "load_throughput": 2960354.313, "learn_time_ms": 6466.366, "learn_throughput": 618.585, "synch_weights_time_ms": 11.245}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 228, "training_iteration": 13, "trial_id": "92ff3_00000", "date": "2023-05-01_00-38-28", "timestamp": 1682876308, "time_this_iter_s": 7.217238426208496, "time_total_s": 92.3784339427948, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 92.3784339427948, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 6.319999999999999, "ram_util_percent": 58.48}}
{"custom_metrics": {"dps_mean": 12307.193264071306, "dps_min": 9182.931332017539, "dps_max": 15908.480552587085}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3769370345338698, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.858754181605514, "policy_loss": -0.0373584242642767, "vf_loss": 9.891957235849032, "vf_explained_var": -0.0011656220241259502, "kl": 0.009234113406703678, "entropy": 1.5237611946239267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 1107.8053986750283, "episode_reward_min": 81.68825837204282, "episode_reward_mean": 681.5915955709861, "episode_len_mean": 204.07, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12307.193264071306, "dps_min": 9182.931332017539, "dps_max": 15908.480552587085}, "hist_stats": {"episode_reward": [532.3242004734653, 468.42913003579076, 434.00940452026185, 570.6914260432984, 609.3399233830204, 339.35965601477864, 491.45189799101234, 743.3228712924486, 708.3783671205937, 628.1969822823689, 535.2222063647812, 286.27377808952474, 623.9722668323747, 381.0044619011486, 555.9204341879697, 413.7558482896597, 557.7986181544034, 495.34570101583137, 553.9888148645928, 815.3846737529504, 689.2157659427464, 392.14061933037146, 599.6530340003346, 582.6372985635551, 493.3727207320041, 551.0668933295317, 374.3445283090133, 485.9934025623742, 673.9629081999399, 623.3804410024175, 81.68825837204282, 409.12358351721076, 432.1245040694417, 391.4729563666159, 842.8866156106827, 418.80676390140815, 505.4930069915446, 870.9357199661622, 776.1695201169081, 737.4438320963794, 799.2368488684906, 691.2563171502779, 825.1714760566508, 617.1222130239021, 621.603390558734, 554.8995935897752, 666.7169974256092, 505.19528459768026, 963.6339446944443, 537.1161603660258, 581.6205239648574, 605.700477913467, 387.6288618185811, 608.545311049809, 636.1768066713272, 974.5458268586249, 471.64918049559515, 501.397544658362, 473.6255639359525, 816.8648304830159, 800.8768517709343, 708.9902973099922, 911.7800029187657, 509.78892430370945, 603.6905568722755, 923.915580579018, 797.8146695500701, 968.4466381012, 777.9629848045462, 880.2975987863631, 901.0939542542187, 836.497724723148, 501.1219477264764, 1028.8459979254874, 810.2865938196252, 1017.9159691480411, 503.4702434393747, 801.5189985628509, 779.8659507567874, 1094.6788019753153, 1014.4486519091877, 770.9088636422597, 1107.8053986750283, 926.018031437761, 622.9145656765237, 1037.9396568889254, 904.2849283083793, 783.93987215594, 841.1776609322469, 614.8081073700744, 945.0265203228846, 760.4090232215292, 396.8495693578744, 908.3411552793261, 1010.6022805148469, 1074.4683638921613, 886.8212677750695, 1037.2477992016397, 1105.3692817183053, 735.1280817183195], "episode_lengths": [156, 182, 154, 200, 169, 229, 158, 186, 174, 173, 210, 177, 184, 198, 227, 180, 191, 185, 162, 179, 178, 167, 183, 225, 248, 203, 237, 196, 170, 274, 271, 194, 193, 210, 206, 167, 185, 199, 184, 273, 210, 207, 195, 179, 197, 203, 219, 242, 212, 162, 200, 224, 226, 197, 189, 255, 184, 227, 201, 212, 251, 224, 181, 263, 187, 220, 248, 199, 259, 216, 232, 177, 214, 222, 192, 186, 226, 194, 210, 226, 214, 262, 179, 193, 239, 214, 253, 213, 189, 186, 213, 176, 217, 192, 180, 165, 187, 209, 203, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25066058122800183, "mean_inference_ms": 0.9870839694306313, "mean_action_processing_ms": 0.08725876527177213, "mean_env_wait_ms": 0.17597968715945547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1107.8053986750283, "episode_reward_min": 81.68825837204282, "episode_reward_mean": 681.5915955709861, "episode_len_mean": 204.07, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [532.3242004734653, 468.42913003579076, 434.00940452026185, 570.6914260432984, 609.3399233830204, 339.35965601477864, 491.45189799101234, 743.3228712924486, 708.3783671205937, 628.1969822823689, 535.2222063647812, 286.27377808952474, 623.9722668323747, 381.0044619011486, 555.9204341879697, 413.7558482896597, 557.7986181544034, 495.34570101583137, 553.9888148645928, 815.3846737529504, 689.2157659427464, 392.14061933037146, 599.6530340003346, 582.6372985635551, 493.3727207320041, 551.0668933295317, 374.3445283090133, 485.9934025623742, 673.9629081999399, 623.3804410024175, 81.68825837204282, 409.12358351721076, 432.1245040694417, 391.4729563666159, 842.8866156106827, 418.80676390140815, 505.4930069915446, 870.9357199661622, 776.1695201169081, 737.4438320963794, 799.2368488684906, 691.2563171502779, 825.1714760566508, 617.1222130239021, 621.603390558734, 554.8995935897752, 666.7169974256092, 505.19528459768026, 963.6339446944443, 537.1161603660258, 581.6205239648574, 605.700477913467, 387.6288618185811, 608.545311049809, 636.1768066713272, 974.5458268586249, 471.64918049559515, 501.397544658362, 473.6255639359525, 816.8648304830159, 800.8768517709343, 708.9902973099922, 911.7800029187657, 509.78892430370945, 603.6905568722755, 923.915580579018, 797.8146695500701, 968.4466381012, 777.9629848045462, 880.2975987863631, 901.0939542542187, 836.497724723148, 501.1219477264764, 1028.8459979254874, 810.2865938196252, 1017.9159691480411, 503.4702434393747, 801.5189985628509, 779.8659507567874, 1094.6788019753153, 1014.4486519091877, 770.9088636422597, 1107.8053986750283, 926.018031437761, 622.9145656765237, 1037.9396568889254, 904.2849283083793, 783.93987215594, 841.1776609322469, 614.8081073700744, 945.0265203228846, 760.4090232215292, 396.8495693578744, 908.3411552793261, 1010.6022805148469, 1074.4683638921613, 886.8212677750695, 1037.2477992016397, 1105.3692817183053, 735.1280817183195], "episode_lengths": [156, 182, 154, 200, 169, 229, 158, 186, 174, 173, 210, 177, 184, 198, 227, 180, 191, 185, 162, 179, 178, 167, 183, 225, 248, 203, 237, 196, 170, 274, 271, 194, 193, 210, 206, 167, 185, 199, 184, 273, 210, 207, 195, 179, 197, 203, 219, 242, 212, 162, 200, 224, 226, 197, 189, 255, 184, 227, 201, 212, 251, 224, 181, 263, 187, 220, 248, 199, 259, 216, 232, 177, 214, 222, 192, 186, 226, 194, 210, 226, 214, 262, 179, 193, 239, 214, 253, 213, 189, 186, 213, 176, 217, 192, 180, 165, 187, 209, 203, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25066058122800183, "mean_inference_ms": 0.9870839694306313, "mean_action_processing_ms": 0.08725876527177213, "mean_env_wait_ms": 0.17597968715945547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 7114.615, "sample_time_ms": 651.147, "load_time_ms": 1.251, "load_throughput": 3197731.102, "learn_time_ms": 6449.95, "learn_throughput": 620.16, "synch_weights_time_ms": 11.245}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 249, "training_iteration": 14, "trial_id": "92ff3_00000", "date": "2023-05-01_00-38-35", "timestamp": 1682876315, "time_this_iter_s": 6.910223484039307, "time_total_s": 99.2886574268341, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 99.2886574268341, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 6.4, "ram_util_percent": 58.48}}
{"custom_metrics": {"dps_mean": 12727.932343884107, "dps_min": 9665.246419819096, "dps_max": 16337.015151486501}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3000024949350664, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.887747925584033, "policy_loss": -0.0368626114727068, "vf_loss": 9.91983213322137, "vf_explained_var": 0.00692156111040423, "kl": 0.010618678962815892, "entropy": 1.4430471649733922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 1273.9438309438797, "episode_reward_min": 81.68825837204282, "episode_reward_mean": 734.7369009349703, "episode_len_mean": 208.99, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 12727.932343884107, "dps_min": 9665.246419819096, "dps_max": 16337.015151486501}, "hist_stats": {"episode_reward": [413.7558482896597, 557.7986181544034, 495.34570101583137, 553.9888148645928, 815.3846737529504, 689.2157659427464, 392.14061933037146, 599.6530340003346, 582.6372985635551, 493.3727207320041, 551.0668933295317, 374.3445283090133, 485.9934025623742, 673.9629081999399, 623.3804410024175, 81.68825837204282, 409.12358351721076, 432.1245040694417, 391.4729563666159, 842.8866156106827, 418.80676390140815, 505.4930069915446, 870.9357199661622, 776.1695201169081, 737.4438320963794, 799.2368488684906, 691.2563171502779, 825.1714760566508, 617.1222130239021, 621.603390558734, 554.8995935897752, 666.7169974256092, 505.19528459768026, 963.6339446944443, 537.1161603660258, 581.6205239648574, 605.700477913467, 387.6288618185811, 608.545311049809, 636.1768066713272, 974.5458268586249, 471.64918049559515, 501.397544658362, 473.6255639359525, 816.8648304830159, 800.8768517709343, 708.9902973099922, 911.7800029187657, 509.78892430370945, 603.6905568722755, 923.915580579018, 797.8146695500701, 968.4466381012, 777.9629848045462, 880.2975987863631, 901.0939542542187, 836.497724723148, 501.1219477264764, 1028.8459979254874, 810.2865938196252, 1017.9159691480411, 503.4702434393747, 801.5189985628509, 779.8659507567874, 1094.6788019753153, 1014.4486519091877, 770.9088636422597, 1107.8053986750283, 926.018031437761, 622.9145656765237, 1037.9396568889254, 904.2849283083793, 783.93987215594, 841.1776609322469, 614.8081073700744, 945.0265203228846, 760.4090232215292, 396.8495693578744, 908.3411552793261, 1010.6022805148469, 1074.4683638921613, 886.8212677750695, 1037.2477992016397, 1105.3692817183053, 735.1280817183195, 942.9262372889524, 945.0818546611442, 944.6292226815302, 825.2327861547807, 870.7724603798208, 772.5277777585934, 771.7195717003656, 663.4689176304499, 997.5148623219318, 1253.6233254049764, 1273.9438309438797, 715.2912810868285, 701.6790007144971, 512.3226998370283, 1031.6937143664693], "episode_lengths": [180, 191, 185, 162, 179, 178, 167, 183, 225, 248, 203, 237, 196, 170, 274, 271, 194, 193, 210, 206, 167, 185, 199, 184, 273, 210, 207, 195, 179, 197, 203, 219, 242, 212, 162, 200, 224, 226, 197, 189, 255, 184, 227, 201, 212, 251, 224, 181, 263, 187, 220, 248, 199, 259, 216, 232, 177, 214, 222, 192, 186, 226, 194, 210, 226, 214, 262, 179, 193, 239, 214, 253, 213, 189, 186, 213, 176, 217, 192, 180, 165, 187, 209, 203, 218, 170, 209, 207, 212, 209, 258, 212, 237, 179, 260, 228, 239, 204, 238, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25144425288744293, "mean_inference_ms": 0.9883357719122747, "mean_action_processing_ms": 0.08710429875220306, "mean_env_wait_ms": 0.17669460845410573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1273.9438309438797, "episode_reward_min": 81.68825837204282, "episode_reward_mean": 734.7369009349703, "episode_len_mean": 208.99, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [413.7558482896597, 557.7986181544034, 495.34570101583137, 553.9888148645928, 815.3846737529504, 689.2157659427464, 392.14061933037146, 599.6530340003346, 582.6372985635551, 493.3727207320041, 551.0668933295317, 374.3445283090133, 485.9934025623742, 673.9629081999399, 623.3804410024175, 81.68825837204282, 409.12358351721076, 432.1245040694417, 391.4729563666159, 842.8866156106827, 418.80676390140815, 505.4930069915446, 870.9357199661622, 776.1695201169081, 737.4438320963794, 799.2368488684906, 691.2563171502779, 825.1714760566508, 617.1222130239021, 621.603390558734, 554.8995935897752, 666.7169974256092, 505.19528459768026, 963.6339446944443, 537.1161603660258, 581.6205239648574, 605.700477913467, 387.6288618185811, 608.545311049809, 636.1768066713272, 974.5458268586249, 471.64918049559515, 501.397544658362, 473.6255639359525, 816.8648304830159, 800.8768517709343, 708.9902973099922, 911.7800029187657, 509.78892430370945, 603.6905568722755, 923.915580579018, 797.8146695500701, 968.4466381012, 777.9629848045462, 880.2975987863631, 901.0939542542187, 836.497724723148, 501.1219477264764, 1028.8459979254874, 810.2865938196252, 1017.9159691480411, 503.4702434393747, 801.5189985628509, 779.8659507567874, 1094.6788019753153, 1014.4486519091877, 770.9088636422597, 1107.8053986750283, 926.018031437761, 622.9145656765237, 1037.9396568889254, 904.2849283083793, 783.93987215594, 841.1776609322469, 614.8081073700744, 945.0265203228846, 760.4090232215292, 396.8495693578744, 908.3411552793261, 1010.6022805148469, 1074.4683638921613, 886.8212677750695, 1037.2477992016397, 1105.3692817183053, 735.1280817183195, 942.9262372889524, 945.0818546611442, 944.6292226815302, 825.2327861547807, 870.7724603798208, 772.5277777585934, 771.7195717003656, 663.4689176304499, 997.5148623219318, 1253.6233254049764, 1273.9438309438797, 715.2912810868285, 701.6790007144971, 512.3226998370283, 1031.6937143664693], "episode_lengths": [180, 191, 185, 162, 179, 178, 167, 183, 225, 248, 203, 237, 196, 170, 274, 271, 194, 193, 210, 206, 167, 185, 199, 184, 273, 210, 207, 195, 179, 197, 203, 219, 242, 212, 162, 200, 224, 226, 197, 189, 255, 184, 227, 201, 212, 251, 224, 181, 263, 187, 220, 248, 199, 259, 216, 232, 177, 214, 222, 192, 186, 226, 194, 210, 226, 214, 262, 179, 193, 239, 214, 253, 213, 189, 186, 213, 176, 217, 192, 180, 165, 187, 209, 203, 218, 170, 209, 207, 212, 209, 258, 212, 237, 179, 260, 228, 239, 204, 238, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25144425288744293, "mean_inference_ms": 0.9883357719122747, "mean_action_processing_ms": 0.08710429875220306, "mean_env_wait_ms": 0.17669460845410573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 7109.696, "sample_time_ms": 652.794, "load_time_ms": 1.151, "load_throughput": 3475918.536, "learn_time_ms": 6443.431, "learn_throughput": 620.787, "synch_weights_time_ms": 11.193}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 264, "training_iteration": 15, "trial_id": "92ff3_00000", "date": "2023-05-01_00-38-42", "timestamp": 1682876322, "time_this_iter_s": 6.891454458236694, "time_total_s": 106.1801118850708, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 106.1801118850708, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 7.040000000000001, "ram_util_percent": 58.489999999999995}}
{"custom_metrics": {"dps_mean": 13164.321127828334, "dps_min": 9665.246419819096, "dps_max": 16627.4872072132}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.783963813448465, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.848723549996652, "policy_loss": -0.03862158452230756, "vf_loss": 9.883476101454868, "vf_explained_var": 0.0007846768184374737, "kl": 0.008597881588404601, "entropy": 1.4502634618871955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 1273.9438309438797, "episode_reward_min": 387.6288618185811, "episode_reward_mean": 811.1035024230994, "episode_len_mean": 213.93, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 13164.321127828334, "dps_min": 9665.246419819096, "dps_max": 16627.4872072132}, "hist_stats": {"episode_reward": [391.4729563666159, 842.8866156106827, 418.80676390140815, 505.4930069915446, 870.9357199661622, 776.1695201169081, 737.4438320963794, 799.2368488684906, 691.2563171502779, 825.1714760566508, 617.1222130239021, 621.603390558734, 554.8995935897752, 666.7169974256092, 505.19528459768026, 963.6339446944443, 537.1161603660258, 581.6205239648574, 605.700477913467, 387.6288618185811, 608.545311049809, 636.1768066713272, 974.5458268586249, 471.64918049559515, 501.397544658362, 473.6255639359525, 816.8648304830159, 800.8768517709343, 708.9902973099922, 911.7800029187657, 509.78892430370945, 603.6905568722755, 923.915580579018, 797.8146695500701, 968.4466381012, 777.9629848045462, 880.2975987863631, 901.0939542542187, 836.497724723148, 501.1219477264764, 1028.8459979254874, 810.2865938196252, 1017.9159691480411, 503.4702434393747, 801.5189985628509, 779.8659507567874, 1094.6788019753153, 1014.4486519091877, 770.9088636422597, 1107.8053986750283, 926.018031437761, 622.9145656765237, 1037.9396568889254, 904.2849283083793, 783.93987215594, 841.1776609322469, 614.8081073700744, 945.0265203228846, 760.4090232215292, 396.8495693578744, 908.3411552793261, 1010.6022805148469, 1074.4683638921613, 886.8212677750695, 1037.2477992016397, 1105.3692817183053, 735.1280817183195, 942.9262372889524, 945.0818546611442, 944.6292226815302, 825.2327861547807, 870.7724603798208, 772.5277777585934, 771.7195717003656, 663.4689176304499, 997.5148623219318, 1253.6233254049764, 1273.9438309438797, 715.2912810868285, 701.6790007144971, 512.3226998370283, 1031.6937143664693, 727.7543900399338, 516.3298363318863, 1118.731893581061, 1086.9397388836876, 1149.6100064833606, 918.0279539138181, 941.6585638757172, 929.6850234585804, 1019.7555328814385, 1112.5542076720124, 920.6095903187011, 985.5676470751255, 983.3266286547126, 846.0115099959108, 901.7359451557578, 1140.8513216183098, 897.4566543933684, 665.0313184879657], "episode_lengths": [210, 206, 167, 185, 199, 184, 273, 210, 207, 195, 179, 197, 203, 219, 242, 212, 162, 200, 224, 226, 197, 189, 255, 184, 227, 201, 212, 251, 224, 181, 263, 187, 220, 248, 199, 259, 216, 232, 177, 214, 222, 192, 186, 226, 194, 210, 226, 214, 262, 179, 193, 239, 214, 253, 213, 189, 186, 213, 176, 217, 192, 180, 165, 187, 209, 203, 218, 170, 209, 207, 212, 209, 258, 212, 237, 179, 260, 228, 239, 204, 238, 207, 230, 273, 201, 214, 242, 215, 195, 213, 206, 248, 224, 251, 243, 231, 268, 228, 224, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25245310889805284, "mean_inference_ms": 0.991172515604615, "mean_action_processing_ms": 0.08734061840091714, "mean_env_wait_ms": 0.17689560308095373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1273.9438309438797, "episode_reward_min": 387.6288618185811, "episode_reward_mean": 811.1035024230994, "episode_len_mean": 213.93, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [391.4729563666159, 842.8866156106827, 418.80676390140815, 505.4930069915446, 870.9357199661622, 776.1695201169081, 737.4438320963794, 799.2368488684906, 691.2563171502779, 825.1714760566508, 617.1222130239021, 621.603390558734, 554.8995935897752, 666.7169974256092, 505.19528459768026, 963.6339446944443, 537.1161603660258, 581.6205239648574, 605.700477913467, 387.6288618185811, 608.545311049809, 636.1768066713272, 974.5458268586249, 471.64918049559515, 501.397544658362, 473.6255639359525, 816.8648304830159, 800.8768517709343, 708.9902973099922, 911.7800029187657, 509.78892430370945, 603.6905568722755, 923.915580579018, 797.8146695500701, 968.4466381012, 777.9629848045462, 880.2975987863631, 901.0939542542187, 836.497724723148, 501.1219477264764, 1028.8459979254874, 810.2865938196252, 1017.9159691480411, 503.4702434393747, 801.5189985628509, 779.8659507567874, 1094.6788019753153, 1014.4486519091877, 770.9088636422597, 1107.8053986750283, 926.018031437761, 622.9145656765237, 1037.9396568889254, 904.2849283083793, 783.93987215594, 841.1776609322469, 614.8081073700744, 945.0265203228846, 760.4090232215292, 396.8495693578744, 908.3411552793261, 1010.6022805148469, 1074.4683638921613, 886.8212677750695, 1037.2477992016397, 1105.3692817183053, 735.1280817183195, 942.9262372889524, 945.0818546611442, 944.6292226815302, 825.2327861547807, 870.7724603798208, 772.5277777585934, 771.7195717003656, 663.4689176304499, 997.5148623219318, 1253.6233254049764, 1273.9438309438797, 715.2912810868285, 701.6790007144971, 512.3226998370283, 1031.6937143664693, 727.7543900399338, 516.3298363318863, 1118.731893581061, 1086.9397388836876, 1149.6100064833606, 918.0279539138181, 941.6585638757172, 929.6850234585804, 1019.7555328814385, 1112.5542076720124, 920.6095903187011, 985.5676470751255, 983.3266286547126, 846.0115099959108, 901.7359451557578, 1140.8513216183098, 897.4566543933684, 665.0313184879657], "episode_lengths": [210, 206, 167, 185, 199, 184, 273, 210, 207, 195, 179, 197, 203, 219, 242, 212, 162, 200, 224, 226, 197, 189, 255, 184, 227, 201, 212, 251, 224, 181, 263, 187, 220, 248, 199, 259, 216, 232, 177, 214, 222, 192, 186, 226, 194, 210, 226, 214, 262, 179, 193, 239, 214, 253, 213, 189, 186, 213, 176, 217, 192, 180, 165, 187, 209, 203, 218, 170, 209, 207, 212, 209, 258, 212, 237, 179, 260, 228, 239, 204, 238, 207, 230, 273, 201, 214, 242, 215, 195, 213, 206, 248, 224, 251, 243, 231, 268, 228, 224, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25245310889805284, "mean_inference_ms": 0.991172515604615, "mean_action_processing_ms": 0.08734061840091714, "mean_env_wait_ms": 0.17689560308095373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 7124.07, "sample_time_ms": 650.982, "load_time_ms": 1.151, "load_throughput": 3475990.552, "learn_time_ms": 6459.642, "learn_throughput": 619.229, "synch_weights_time_ms": 11.267}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 282, "training_iteration": 16, "trial_id": "92ff3_00000", "date": "2023-05-01_00-38-49", "timestamp": 1682876329, "time_this_iter_s": 7.059753656387329, "time_total_s": 113.23986554145813, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 113.23986554145813, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 5.94, "ram_util_percent": 58.57000000000001}}
{"custom_metrics": {"dps_mean": 13576.807536882749, "dps_min": 9916.560109280117, "dps_max": 16953.369715000656}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8612888936073548, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.858488071605723, "policy_loss": -0.040036580428200706, "vf_loss": 9.89364453592608, "vf_explained_var": -0.00610373193217862, "kl": 0.010844710366830268, "entropy": 1.470678658767413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 1273.9438309438797, "episode_reward_min": 396.8495693578744, "episode_reward_mean": 872.0875623361, "episode_len_mean": 217.72, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 13576.807536882749, "dps_min": 9916.560109280117, "dps_max": 16953.369715000656}, "hist_stats": {"episode_reward": [636.1768066713272, 974.5458268586249, 471.64918049559515, 501.397544658362, 473.6255639359525, 816.8648304830159, 800.8768517709343, 708.9902973099922, 911.7800029187657, 509.78892430370945, 603.6905568722755, 923.915580579018, 797.8146695500701, 968.4466381012, 777.9629848045462, 880.2975987863631, 901.0939542542187, 836.497724723148, 501.1219477264764, 1028.8459979254874, 810.2865938196252, 1017.9159691480411, 503.4702434393747, 801.5189985628509, 779.8659507567874, 1094.6788019753153, 1014.4486519091877, 770.9088636422597, 1107.8053986750283, 926.018031437761, 622.9145656765237, 1037.9396568889254, 904.2849283083793, 783.93987215594, 841.1776609322469, 614.8081073700744, 945.0265203228846, 760.4090232215292, 396.8495693578744, 908.3411552793261, 1010.6022805148469, 1074.4683638921613, 886.8212677750695, 1037.2477992016397, 1105.3692817183053, 735.1280817183195, 942.9262372889524, 945.0818546611442, 944.6292226815302, 825.2327861547807, 870.7724603798208, 772.5277777585934, 771.7195717003656, 663.4689176304499, 997.5148623219318, 1253.6233254049764, 1273.9438309438797, 715.2912810868285, 701.6790007144971, 512.3226998370283, 1031.6937143664693, 727.7543900399338, 516.3298363318863, 1118.731893581061, 1086.9397388836876, 1149.6100064833606, 918.0279539138181, 941.6585638757172, 929.6850234585804, 1019.7555328814385, 1112.5542076720124, 920.6095903187011, 985.5676470751255, 983.3266286547126, 846.0115099959108, 901.7359451557578, 1140.8513216183098, 897.4566543933684, 665.0313184879657, 779.5053762797907, 1026.7266948024158, 801.0603606620009, 907.8898697312662, 768.0443008726858, 1147.5213762267836, 740.7041412061124, 769.0793379645045, 862.073063304318, 1050.8996555610265, 1094.3667712750553, 1031.814501064065, 746.771091937841, 755.2610131463853, 936.9149515450974, 1207.2472365095532, 985.436553708329, 954.2133941011302, 956.1232448047557, 1170.293722786765, 915.115149938145], "episode_lengths": [189, 255, 184, 227, 201, 212, 251, 224, 181, 263, 187, 220, 248, 199, 259, 216, 232, 177, 214, 222, 192, 186, 226, 194, 210, 226, 214, 262, 179, 193, 239, 214, 253, 213, 189, 186, 213, 176, 217, 192, 180, 165, 187, 209, 203, 218, 170, 209, 207, 212, 209, 258, 212, 237, 179, 260, 228, 239, 204, 238, 207, 230, 273, 201, 214, 242, 215, 195, 213, 206, 248, 224, 251, 243, 231, 268, 228, 224, 224, 253, 164, 208, 223, 236, 212, 207, 227, 250, 247, 210, 230, 273, 230, 189, 262, 210, 230, 182, 234, 199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2540303935493781, "mean_inference_ms": 0.9986699659000459, "mean_action_processing_ms": 0.08776281631302986, "mean_env_wait_ms": 0.17963882513658752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1273.9438309438797, "episode_reward_min": 396.8495693578744, "episode_reward_mean": 872.0875623361, "episode_len_mean": 217.72, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [636.1768066713272, 974.5458268586249, 471.64918049559515, 501.397544658362, 473.6255639359525, 816.8648304830159, 800.8768517709343, 708.9902973099922, 911.7800029187657, 509.78892430370945, 603.6905568722755, 923.915580579018, 797.8146695500701, 968.4466381012, 777.9629848045462, 880.2975987863631, 901.0939542542187, 836.497724723148, 501.1219477264764, 1028.8459979254874, 810.2865938196252, 1017.9159691480411, 503.4702434393747, 801.5189985628509, 779.8659507567874, 1094.6788019753153, 1014.4486519091877, 770.9088636422597, 1107.8053986750283, 926.018031437761, 622.9145656765237, 1037.9396568889254, 904.2849283083793, 783.93987215594, 841.1776609322469, 614.8081073700744, 945.0265203228846, 760.4090232215292, 396.8495693578744, 908.3411552793261, 1010.6022805148469, 1074.4683638921613, 886.8212677750695, 1037.2477992016397, 1105.3692817183053, 735.1280817183195, 942.9262372889524, 945.0818546611442, 944.6292226815302, 825.2327861547807, 870.7724603798208, 772.5277777585934, 771.7195717003656, 663.4689176304499, 997.5148623219318, 1253.6233254049764, 1273.9438309438797, 715.2912810868285, 701.6790007144971, 512.3226998370283, 1031.6937143664693, 727.7543900399338, 516.3298363318863, 1118.731893581061, 1086.9397388836876, 1149.6100064833606, 918.0279539138181, 941.6585638757172, 929.6850234585804, 1019.7555328814385, 1112.5542076720124, 920.6095903187011, 985.5676470751255, 983.3266286547126, 846.0115099959108, 901.7359451557578, 1140.8513216183098, 897.4566543933684, 665.0313184879657, 779.5053762797907, 1026.7266948024158, 801.0603606620009, 907.8898697312662, 768.0443008726858, 1147.5213762267836, 740.7041412061124, 769.0793379645045, 862.073063304318, 1050.8996555610265, 1094.3667712750553, 1031.814501064065, 746.771091937841, 755.2610131463853, 936.9149515450974, 1207.2472365095532, 985.436553708329, 954.2133941011302, 956.1232448047557, 1170.293722786765, 915.115149938145], "episode_lengths": [189, 255, 184, 227, 201, 212, 251, 224, 181, 263, 187, 220, 248, 199, 259, 216, 232, 177, 214, 222, 192, 186, 226, 194, 210, 226, 214, 262, 179, 193, 239, 214, 253, 213, 189, 186, 213, 176, 217, 192, 180, 165, 187, 209, 203, 218, 170, 209, 207, 212, 209, 258, 212, 237, 179, 260, 228, 239, 204, 238, 207, 230, 273, 201, 214, 242, 215, 195, 213, 206, 248, 224, 251, 243, 231, 268, 228, 224, 224, 253, 164, 208, 223, 236, 212, 207, 227, 250, 247, 210, 230, 273, 230, 189, 262, 210, 230, 182, 234, 199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2540303935493781, "mean_inference_ms": 0.9986699659000459, "mean_action_processing_ms": 0.08776281631302986, "mean_env_wait_ms": 0.17963882513658752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 7150.055, "sample_time_ms": 677.042, "load_time_ms": 1.157, "load_throughput": 3458364.116, "learn_time_ms": 6459.561, "learn_throughput": 619.237, "synch_weights_time_ms": 11.367}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 303, "training_iteration": 17, "trial_id": "92ff3_00000", "date": "2023-05-01_00-38-57", "timestamp": 1682876337, "time_this_iter_s": 7.281469345092773, "time_total_s": 120.5213348865509, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 120.5213348865509, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 9.270000000000001, "ram_util_percent": 58.61}}
{"custom_metrics": {"dps_mean": 13775.565103853678, "dps_min": 11141.034494272339, "dps_max": 17217.14432315342}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6388287010692781, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.887851813531691, "policy_loss": -0.043606106893369745, "vf_loss": 9.92591491412091, "vf_explained_var": -0.006315445707690331, "kl": 0.01231781554179393, "entropy": 1.4356183367390787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 1440.2428618414187, "episode_reward_min": 396.8495693578744, "episode_reward_mean": 922.3343529808865, "episode_len_mean": 218.37, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 13775.565103853678, "dps_min": 11141.034494272339, "dps_max": 17217.14432315342}, "hist_stats": {"episode_reward": [901.0939542542187, 836.497724723148, 501.1219477264764, 1028.8459979254874, 810.2865938196252, 1017.9159691480411, 503.4702434393747, 801.5189985628509, 779.8659507567874, 1094.6788019753153, 1014.4486519091877, 770.9088636422597, 1107.8053986750283, 926.018031437761, 622.9145656765237, 1037.9396568889254, 904.2849283083793, 783.93987215594, 841.1776609322469, 614.8081073700744, 945.0265203228846, 760.4090232215292, 396.8495693578744, 908.3411552793261, 1010.6022805148469, 1074.4683638921613, 886.8212677750695, 1037.2477992016397, 1105.3692817183053, 735.1280817183195, 942.9262372889524, 945.0818546611442, 944.6292226815302, 825.2327861547807, 870.7724603798208, 772.5277777585934, 771.7195717003656, 663.4689176304499, 997.5148623219318, 1253.6233254049764, 1273.9438309438797, 715.2912810868285, 701.6790007144971, 512.3226998370283, 1031.6937143664693, 727.7543900399338, 516.3298363318863, 1118.731893581061, 1086.9397388836876, 1149.6100064833606, 918.0279539138181, 941.6585638757172, 929.6850234585804, 1019.7555328814385, 1112.5542076720124, 920.6095903187011, 985.5676470751255, 983.3266286547126, 846.0115099959108, 901.7359451557578, 1140.8513216183098, 897.4566543933684, 665.0313184879657, 779.5053762797907, 1026.7266948024158, 801.0603606620009, 907.8898697312662, 768.0443008726858, 1147.5213762267836, 740.7041412061124, 769.0793379645045, 862.073063304318, 1050.8996555610265, 1094.3667712750553, 1031.814501064065, 746.771091937841, 755.2610131463853, 936.9149515450974, 1207.2472365095532, 985.436553708329, 954.2133941011302, 956.1232448047557, 1170.293722786765, 915.115149938145, 966.0577633235047, 961.6553858555773, 1100.015099686533, 868.4465230399575, 775.6613292475869, 878.5971972433387, 827.398895479363, 1255.5669545366964, 1366.7288415890807, 996.9802271844209, 1183.6284438370994, 1440.2428618414187, 850.3302862453663, 1241.4004268340477, 877.1701384715759, 1192.6225481628449], "episode_lengths": [232, 177, 214, 222, 192, 186, 226, 194, 210, 226, 214, 262, 179, 193, 239, 214, 253, 213, 189, 186, 213, 176, 217, 192, 180, 165, 187, 209, 203, 218, 170, 209, 207, 212, 209, 258, 212, 237, 179, 260, 228, 239, 204, 238, 207, 230, 273, 201, 214, 242, 215, 195, 213, 206, 248, 224, 251, 243, 231, 268, 228, 224, 224, 253, 164, 208, 223, 236, 212, 207, 227, 250, 247, 210, 230, 273, 230, 189, 262, 210, 230, 182, 234, 199, 240, 253, 240, 219, 185, 234, 249, 236, 184, 196, 218, 255, 215, 238, 195, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25374496256260226, "mean_inference_ms": 0.9963133833122741, "mean_action_processing_ms": 0.08725479870746984, "mean_env_wait_ms": 0.17933988925657268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1440.2428618414187, "episode_reward_min": 396.8495693578744, "episode_reward_mean": 922.3343529808865, "episode_len_mean": 218.37, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [901.0939542542187, 836.497724723148, 501.1219477264764, 1028.8459979254874, 810.2865938196252, 1017.9159691480411, 503.4702434393747, 801.5189985628509, 779.8659507567874, 1094.6788019753153, 1014.4486519091877, 770.9088636422597, 1107.8053986750283, 926.018031437761, 622.9145656765237, 1037.9396568889254, 904.2849283083793, 783.93987215594, 841.1776609322469, 614.8081073700744, 945.0265203228846, 760.4090232215292, 396.8495693578744, 908.3411552793261, 1010.6022805148469, 1074.4683638921613, 886.8212677750695, 1037.2477992016397, 1105.3692817183053, 735.1280817183195, 942.9262372889524, 945.0818546611442, 944.6292226815302, 825.2327861547807, 870.7724603798208, 772.5277777585934, 771.7195717003656, 663.4689176304499, 997.5148623219318, 1253.6233254049764, 1273.9438309438797, 715.2912810868285, 701.6790007144971, 512.3226998370283, 1031.6937143664693, 727.7543900399338, 516.3298363318863, 1118.731893581061, 1086.9397388836876, 1149.6100064833606, 918.0279539138181, 941.6585638757172, 929.6850234585804, 1019.7555328814385, 1112.5542076720124, 920.6095903187011, 985.5676470751255, 983.3266286547126, 846.0115099959108, 901.7359451557578, 1140.8513216183098, 897.4566543933684, 665.0313184879657, 779.5053762797907, 1026.7266948024158, 801.0603606620009, 907.8898697312662, 768.0443008726858, 1147.5213762267836, 740.7041412061124, 769.0793379645045, 862.073063304318, 1050.8996555610265, 1094.3667712750553, 1031.814501064065, 746.771091937841, 755.2610131463853, 936.9149515450974, 1207.2472365095532, 985.436553708329, 954.2133941011302, 956.1232448047557, 1170.293722786765, 915.115149938145, 966.0577633235047, 961.6553858555773, 1100.015099686533, 868.4465230399575, 775.6613292475869, 878.5971972433387, 827.398895479363, 1255.5669545366964, 1366.7288415890807, 996.9802271844209, 1183.6284438370994, 1440.2428618414187, 850.3302862453663, 1241.4004268340477, 877.1701384715759, 1192.6225481628449], "episode_lengths": [232, 177, 214, 222, 192, 186, 226, 194, 210, 226, 214, 262, 179, 193, 239, 214, 253, 213, 189, 186, 213, 176, 217, 192, 180, 165, 187, 209, 203, 218, 170, 209, 207, 212, 209, 258, 212, 237, 179, 260, 228, 239, 204, 238, 207, 230, 273, 201, 214, 242, 215, 195, 213, 206, 248, 224, 251, 243, 231, 268, 228, 224, 224, 253, 164, 208, 223, 236, 212, 207, 227, 250, 247, 210, 230, 273, 230, 189, 262, 210, 230, 182, 234, 199, 240, 253, 240, 219, 185, 234, 249, 236, 184, 196, 218, 255, 215, 238, 195, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25374496256260226, "mean_inference_ms": 0.9963133833122741, "mean_action_processing_ms": 0.08725479870746984, "mean_env_wait_ms": 0.17933988925657268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 7148.057, "sample_time_ms": 678.378, "load_time_ms": 1.057, "load_throughput": 3784362.89, "learn_time_ms": 6456.476, "learn_throughput": 619.533, "synch_weights_time_ms": 11.367}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 319, "training_iteration": 18, "trial_id": "92ff3_00000", "date": "2023-05-01_00-39-04", "timestamp": 1682876344, "time_this_iter_s": 6.932090520858765, "time_total_s": 127.45342540740967, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 127.45342540740967, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 6.2299999999999995, "ram_util_percent": 58.59000000000001}}
{"custom_metrics": {"dps_mean": 13982.570875312775, "dps_min": 11141.034494272339, "dps_max": 17858.717087831097}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7083767334620157, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.87033749447074, "policy_loss": -0.047995980469489934, "vf_loss": 9.910692822035923, "vf_explained_var": -0.02052305039539132, "kl": 0.016979239982720933, "entropy": 1.4492948164222061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 1555.281946354877, "episode_reward_min": 396.8495693578744, "episode_reward_mean": 964.5201157183222, "episode_len_mean": 220.55, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"dps_mean": 13982.570875312775, "dps_min": 11141.034494272339, "dps_max": 17858.717087831097}, "hist_stats": {"episode_reward": [614.8081073700744, 945.0265203228846, 760.4090232215292, 396.8495693578744, 908.3411552793261, 1010.6022805148469, 1074.4683638921613, 886.8212677750695, 1037.2477992016397, 1105.3692817183053, 735.1280817183195, 942.9262372889524, 945.0818546611442, 944.6292226815302, 825.2327861547807, 870.7724603798208, 772.5277777585934, 771.7195717003656, 663.4689176304499, 997.5148623219318, 1253.6233254049764, 1273.9438309438797, 715.2912810868285, 701.6790007144971, 512.3226998370283, 1031.6937143664693, 727.7543900399338, 516.3298363318863, 1118.731893581061, 1086.9397388836876, 1149.6100064833606, 918.0279539138181, 941.6585638757172, 929.6850234585804, 1019.7555328814385, 1112.5542076720124, 920.6095903187011, 985.5676470751255, 983.3266286547126, 846.0115099959108, 901.7359451557578, 1140.8513216183098, 897.4566543933684, 665.0313184879657, 779.5053762797907, 1026.7266948024158, 801.0603606620009, 907.8898697312662, 768.0443008726858, 1147.5213762267836, 740.7041412061124, 769.0793379645045, 862.073063304318, 1050.8996555610265, 1094.3667712750553, 1031.814501064065, 746.771091937841, 755.2610131463853, 936.9149515450974, 1207.2472365095532, 985.436553708329, 954.2133941011302, 956.1232448047557, 1170.293722786765, 915.115149938145, 966.0577633235047, 961.6553858555773, 1100.015099686533, 868.4465230399575, 775.6613292475869, 878.5971972433387, 827.398895479363, 1255.5669545366964, 1366.7288415890807, 996.9802271844209, 1183.6284438370994, 1440.2428618414187, 850.3302862453663, 1241.4004268340477, 877.1701384715759, 1192.6225481628449, 737.4060490327262, 781.8205291946662, 1157.5471368206256, 941.513824336917, 1187.2739330339264, 1025.9270312201481, 1043.5328307572668, 1176.0212527990025, 815.7726403511598, 1084.661679980259, 1254.8778370128666, 1368.7201974993427, 1211.0147573348881, 1235.608096693496, 1210.1981163968014, 1555.281946354877, 1008.8799705523045, 890.1200893020105, 817.132167027877], "episode_lengths": [186, 213, 176, 217, 192, 180, 165, 187, 209, 203, 218, 170, 209, 207, 212, 209, 258, 212, 237, 179, 260, 228, 239, 204, 238, 207, 230, 273, 201, 214, 242, 215, 195, 213, 206, 248, 224, 251, 243, 231, 268, 228, 224, 224, 253, 164, 208, 223, 236, 212, 207, 227, 250, 247, 210, 230, 273, 230, 189, 262, 210, 230, 182, 234, 199, 240, 253, 240, 219, 185, 234, 249, 236, 184, 196, 218, 255, 215, 238, 195, 224, 267, 207, 252, 190, 204, 236, 216, 234, 222, 173, 228, 218, 225, 259, 252, 239, 213, 227, 191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25392561878305747, "mean_inference_ms": 0.9991070587556448, "mean_action_processing_ms": 0.08734463566740809, "mean_env_wait_ms": 0.18084905057927958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 1555.281946354877, "episode_reward_min": 396.8495693578744, "episode_reward_mean": 964.5201157183222, "episode_len_mean": 220.55, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [614.8081073700744, 945.0265203228846, 760.4090232215292, 396.8495693578744, 908.3411552793261, 1010.6022805148469, 1074.4683638921613, 886.8212677750695, 1037.2477992016397, 1105.3692817183053, 735.1280817183195, 942.9262372889524, 945.0818546611442, 944.6292226815302, 825.2327861547807, 870.7724603798208, 772.5277777585934, 771.7195717003656, 663.4689176304499, 997.5148623219318, 1253.6233254049764, 1273.9438309438797, 715.2912810868285, 701.6790007144971, 512.3226998370283, 1031.6937143664693, 727.7543900399338, 516.3298363318863, 1118.731893581061, 1086.9397388836876, 1149.6100064833606, 918.0279539138181, 941.6585638757172, 929.6850234585804, 1019.7555328814385, 1112.5542076720124, 920.6095903187011, 985.5676470751255, 983.3266286547126, 846.0115099959108, 901.7359451557578, 1140.8513216183098, 897.4566543933684, 665.0313184879657, 779.5053762797907, 1026.7266948024158, 801.0603606620009, 907.8898697312662, 768.0443008726858, 1147.5213762267836, 740.7041412061124, 769.0793379645045, 862.073063304318, 1050.8996555610265, 1094.3667712750553, 1031.814501064065, 746.771091937841, 755.2610131463853, 936.9149515450974, 1207.2472365095532, 985.436553708329, 954.2133941011302, 956.1232448047557, 1170.293722786765, 915.115149938145, 966.0577633235047, 961.6553858555773, 1100.015099686533, 868.4465230399575, 775.6613292475869, 878.5971972433387, 827.398895479363, 1255.5669545366964, 1366.7288415890807, 996.9802271844209, 1183.6284438370994, 1440.2428618414187, 850.3302862453663, 1241.4004268340477, 877.1701384715759, 1192.6225481628449, 737.4060490327262, 781.8205291946662, 1157.5471368206256, 941.513824336917, 1187.2739330339264, 1025.9270312201481, 1043.5328307572668, 1176.0212527990025, 815.7726403511598, 1084.661679980259, 1254.8778370128666, 1368.7201974993427, 1211.0147573348881, 1235.608096693496, 1210.1981163968014, 1555.281946354877, 1008.8799705523045, 890.1200893020105, 817.132167027877], "episode_lengths": [186, 213, 176, 217, 192, 180, 165, 187, 209, 203, 218, 170, 209, 207, 212, 209, 258, 212, 237, 179, 260, 228, 239, 204, 238, 207, 230, 273, 201, 214, 242, 215, 195, 213, 206, 248, 224, 251, 243, 231, 268, 228, 224, 224, 253, 164, 208, 223, 236, 212, 207, 227, 250, 247, 210, 230, 273, 230, 189, 262, 210, 230, 182, 234, 199, 240, 253, 240, 219, 185, 234, 249, 236, 184, 196, 218, 255, 215, 238, 195, 224, 267, 207, 252, 190, 204, 236, 216, 234, 222, 173, 228, 218, 225, 259, 252, 239, 213, 227, 191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25392561878305747, "mean_inference_ms": 0.9991070587556448, "mean_action_processing_ms": 0.08734463566740809, "mean_env_wait_ms": 0.18084905057927958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 11, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 7131.088, "sample_time_ms": 675.921, "load_time_ms": 1.058, "load_throughput": 3782315.305, "learn_time_ms": 6441.65, "learn_throughput": 620.959, "synch_weights_time_ms": 11.782}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 338, "training_iteration": 19, "trial_id": "92ff3_00000", "date": "2023-05-01_00-39-11", "timestamp": 1682876351, "time_this_iter_s": 6.993616580963135, "time_total_s": 134.4470419883728, "pid": 8252, "hostname": "XorgWorkstation", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "FurySimEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021457CCBC10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 11}, "time_since_restore": 134.4470419883728, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 5.4799999999999995, "ram_util_percent": 58.30999999999999}}
